function th(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in e)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var nh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Su={exports:{}},Hr={},wu={exports:{}},F={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ji=Symbol.for("react.element"),ih=Symbol.for("react.portal"),rh=Symbol.for("react.fragment"),sh=Symbol.for("react.strict_mode"),oh=Symbol.for("react.profiler"),ah=Symbol.for("react.provider"),lh=Symbol.for("react.context"),uh=Symbol.for("react.forward_ref"),ch=Symbol.for("react.suspense"),dh=Symbol.for("react.memo"),hh=Symbol.for("react.lazy"),Wa=Symbol.iterator;function fh(e){return e===null||typeof e!="object"?null:(e=Wa&&e[Wa]||e["@@iterator"],typeof e=="function"?e:null)}var xu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cu=Object.assign,ku={};function Gn(e,t,n){this.props=e,this.context=t,this.refs=ku,this.updater=n||xu}Gn.prototype.isReactComponent={};Gn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Gn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Eu(){}Eu.prototype=Gn.prototype;function Wo(e,t,n){this.props=e,this.context=t,this.refs=ku,this.updater=n||xu}var Ho=Wo.prototype=new Eu;Ho.constructor=Wo;Cu(Ho,Gn.prototype);Ho.isPureReactComponent=!0;var Ha=Array.isArray,Tu=Object.prototype.hasOwnProperty,Bo={current:null},Pu={key:!0,ref:!0,__self:!0,__source:!0};function bu(e,t,n){var i,r={},s=null,o=null;if(t!=null)for(i in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Tu.call(t,i)&&!Pu.hasOwnProperty(i)&&(r[i]=t[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(e&&e.defaultProps)for(i in a=e.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:ji,type:e,key:s,ref:o,props:r,_owner:Bo.current}}function ph(e,t){return{$$typeof:ji,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Go(e){return typeof e=="object"&&e!==null&&e.$$typeof===ji}function mh(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Ba=/\/+/g;function hs(e,t){return typeof e=="object"&&e!==null&&e.key!=null?mh(""+e.key):t.toString(36)}function sr(e,t,n,i,r){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ji:case ih:o=!0}}if(o)return o=e,r=r(o),e=i===""?"."+hs(o,0):i,Ha(r)?(n="",e!=null&&(n=e.replace(Ba,"$&/")+"/"),sr(r,t,n,"",function(u){return u})):r!=null&&(Go(r)&&(r=ph(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(Ba,"$&/")+"/")+e)),t.push(r)),1;if(o=0,i=i===""?".":i+":",Ha(e))for(var a=0;a<e.length;a++){s=e[a];var l=i+hs(s,a);o+=sr(s,t,n,l,r)}else if(l=fh(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=i+hs(s,a++),o+=sr(s,t,n,l,r);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Vi(e,t,n){if(e==null)return e;var i=[],r=0;return sr(e,i,"","",function(s){return t.call(n,s,r++)}),i}function gh(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ie={current:null},or={transition:null},vh={ReactCurrentDispatcher:Ie,ReactCurrentBatchConfig:or,ReactCurrentOwner:Bo};function Iu(){throw Error("act(...) is not supported in production builds of React.")}F.Children={map:Vi,forEach:function(e,t,n){Vi(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Vi(e,function(){t++}),t},toArray:function(e){return Vi(e,function(t){return t})||[]},only:function(e){if(!Go(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};F.Component=Gn;F.Fragment=rh;F.Profiler=oh;F.PureComponent=Wo;F.StrictMode=sh;F.Suspense=ch;F.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vh;F.act=Iu;F.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=Cu({},e.props),r=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Bo.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)Tu.call(t,l)&&!Pu.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:ji,type:e.type,key:r,ref:s,props:i,_owner:o}};F.createContext=function(e){return e={$$typeof:lh,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ah,_context:e},e.Consumer=e};F.createElement=bu;F.createFactory=function(e){var t=bu.bind(null,e);return t.type=e,t};F.createRef=function(){return{current:null}};F.forwardRef=function(e){return{$$typeof:uh,render:e}};F.isValidElement=Go;F.lazy=function(e){return{$$typeof:hh,_payload:{_status:-1,_result:e},_init:gh}};F.memo=function(e,t){return{$$typeof:dh,type:e,compare:t===void 0?null:t}};F.startTransition=function(e){var t=or.transition;or.transition={};try{e()}finally{or.transition=t}};F.unstable_act=Iu;F.useCallback=function(e,t){return Ie.current.useCallback(e,t)};F.useContext=function(e){return Ie.current.useContext(e)};F.useDebugValue=function(){};F.useDeferredValue=function(e){return Ie.current.useDeferredValue(e)};F.useEffect=function(e,t){return Ie.current.useEffect(e,t)};F.useId=function(){return Ie.current.useId()};F.useImperativeHandle=function(e,t,n){return Ie.current.useImperativeHandle(e,t,n)};F.useInsertionEffect=function(e,t){return Ie.current.useInsertionEffect(e,t)};F.useLayoutEffect=function(e,t){return Ie.current.useLayoutEffect(e,t)};F.useMemo=function(e,t){return Ie.current.useMemo(e,t)};F.useReducer=function(e,t,n){return Ie.current.useReducer(e,t,n)};F.useRef=function(e){return Ie.current.useRef(e)};F.useState=function(e){return Ie.current.useState(e)};F.useSyncExternalStore=function(e,t,n){return Ie.current.useSyncExternalStore(e,t,n)};F.useTransition=function(){return Ie.current.useTransition()};F.version="18.3.1";wu.exports=F;var j=wu.exports;const Ru=yu(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _h=j,yh=Symbol.for("react.element"),Sh=Symbol.for("react.fragment"),wh=Object.prototype.hasOwnProperty,xh=_h.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ch={key:!0,ref:!0,__self:!0,__source:!0};function Au(e,t,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(i in t)wh.call(t,i)&&!Ch.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:yh,type:e,key:s,ref:o,props:r,_owner:xh.current}}Hr.Fragment=Sh;Hr.jsx=Au;Hr.jsxs=Au;Su.exports=Hr;var p=Su.exports,Fs={},Nu={exports:{}},Ve={},Du={exports:{}},Lu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,M){var U=R.length;R.push(M);e:for(;0<U;){var se=U-1>>>1,fe=R[se];if(0<r(fe,M))R[se]=M,R[U]=fe,U=se;else break e}}function n(R){return R.length===0?null:R[0]}function i(R){if(R.length===0)return null;var M=R[0],U=R.pop();if(U!==M){R[0]=U;e:for(var se=0,fe=R.length,$i=fe>>>1;se<$i;){var qt=2*(se+1)-1,ds=R[qt],Yt=qt+1,zi=R[Yt];if(0>r(ds,U))Yt<fe&&0>r(zi,ds)?(R[se]=zi,R[Yt]=U,se=Yt):(R[se]=ds,R[qt]=U,se=qt);else if(Yt<fe&&0>r(zi,U))R[se]=zi,R[Yt]=U,se=Yt;else break e}}return M}function r(R,M){var U=R.sortIndex-M.sortIndex;return U!==0?U:R.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,d=null,h=3,v=!1,y=!1,_=!1,I=typeof setTimeout=="function"?setTimeout:null,f=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(R){for(var M=n(u);M!==null;){if(M.callback===null)i(u);else if(M.startTime<=R)i(u),M.sortIndex=M.expirationTime,t(l,M);else break;M=n(u)}}function S(R){if(_=!1,g(R),!y)if(n(l)!==null)y=!0,G(C);else{var M=n(u);M!==null&&vt(S,M.startTime-R)}}function C(R,M){y=!1,_&&(_=!1,f(w),w=-1),v=!0;var U=h;try{for(g(M),d=n(l);d!==null&&(!(d.expirationTime>M)||R&&!D());){var se=d.callback;if(typeof se=="function"){d.callback=null,h=d.priorityLevel;var fe=se(d.expirationTime<=M);M=e.unstable_now(),typeof fe=="function"?d.callback=fe:d===n(l)&&i(l),g(M)}else i(l);d=n(l)}if(d!==null)var $i=!0;else{var qt=n(u);qt!==null&&vt(S,qt.startTime-M),$i=!1}return $i}finally{d=null,h=U,v=!1}}var k=!1,E=null,w=-1,N=5,b=-1;function D(){return!(e.unstable_now()-b<N)}function $(){if(E!==null){var R=e.unstable_now();b=R;var M=!0;try{M=E(!0,R)}finally{M?he():(k=!1,E=null)}}else k=!1}var he;if(typeof m=="function")he=function(){m($)};else if(typeof MessageChannel<"u"){var ut=new MessageChannel,gt=ut.port2;ut.port1.onmessage=$,he=function(){gt.postMessage(null)}}else he=function(){I($,0)};function G(R){E=R,k||(k=!0,he())}function vt(R,M){w=I(function(){R(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,G(C))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(R){switch(h){case 1:case 2:case 3:var M=3;break;default:M=h}var U=h;h=M;try{return R()}finally{h=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,M){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var U=h;h=R;try{return M()}finally{h=U}},e.unstable_scheduleCallback=function(R,M,U){var se=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?se+U:se):U=se,R){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=U+fe,R={id:c++,callback:M,priorityLevel:R,startTime:U,expirationTime:fe,sortIndex:-1},U>se?(R.sortIndex=U,t(u,R),n(l)===null&&R===n(u)&&(_?(f(w),w=-1):_=!0,vt(S,U-se))):(R.sortIndex=fe,t(l,R),y||v||(y=!0,G(C))),R},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(R){var M=h;return function(){var U=h;h=M;try{return R.apply(this,arguments)}finally{h=U}}}})(Lu);Du.exports=Lu;var kh=Du.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eh=j,$e=kh;function x(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ju=new Set,vi={};function fn(e,t){Un(e,t),Un(e+"Capture",t)}function Un(e,t){for(vi[e]=t,e=0;e<t.length;e++)ju.add(t[e])}var kt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$s=Object.prototype.hasOwnProperty,Th=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ga={},Qa={};function Ph(e){return $s.call(Qa,e)?!0:$s.call(Ga,e)?!1:Th.test(e)?Qa[e]=!0:(Ga[e]=!0,!1)}function bh(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ih(e,t,n,i){if(t===null||typeof t>"u"||bh(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Re(e,t,n,i,r,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ye[e]=new Re(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ye[t]=new Re(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ye[e]=new Re(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ye[e]=new Re(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ye[e]=new Re(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ye[e]=new Re(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ye[e]=new Re(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ye[e]=new Re(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ye[e]=new Re(e,5,!1,e.toLowerCase(),null,!1,!1)});var Qo=/[\-:]([a-z])/g;function Jo(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Qo,Jo);ye[t]=new Re(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Qo,Jo);ye[t]=new Re(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Qo,Jo);ye[t]=new Re(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ye[e]=new Re(e,1,!1,e.toLowerCase(),null,!1,!1)});ye.xlinkHref=new Re("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ye[e]=new Re(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ko(e,t,n,i){var r=ye.hasOwnProperty(t)?ye[t]:null;(r!==null?r.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ih(t,n,r,i)&&(n=null),i||r===null?Ph(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=n===null?r.type===3?!1:"":n:(t=r.attributeName,i=r.attributeNamespace,n===null?e.removeAttribute(t):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var It=Eh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wi=Symbol.for("react.element"),_n=Symbol.for("react.portal"),yn=Symbol.for("react.fragment"),qo=Symbol.for("react.strict_mode"),zs=Symbol.for("react.profiler"),Mu=Symbol.for("react.provider"),Ou=Symbol.for("react.context"),Yo=Symbol.for("react.forward_ref"),Vs=Symbol.for("react.suspense"),Ws=Symbol.for("react.suspense_list"),Xo=Symbol.for("react.memo"),At=Symbol.for("react.lazy"),Uu=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Kn(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var ie=Object.assign,fs;function ii(e){if(fs===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);fs=t&&t[1]||""}return`
`+fs+e}var ps=!1;function ms(e,t){if(!e||ps)return"";ps=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var i=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){i=u}e.call(t.prototype)}else{try{throw Error()}catch(u){i=u}e()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{ps=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ii(e):""}function Rh(e){switch(e.tag){case 5:return ii(e.type);case 16:return ii("Lazy");case 13:return ii("Suspense");case 19:return ii("SuspenseList");case 0:case 2:case 15:return e=ms(e.type,!1),e;case 11:return e=ms(e.type.render,!1),e;case 1:return e=ms(e.type,!0),e;default:return""}}function Hs(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yn:return"Fragment";case _n:return"Portal";case zs:return"Profiler";case qo:return"StrictMode";case Vs:return"Suspense";case Ws:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ou:return(e.displayName||"Context")+".Consumer";case Mu:return(e._context.displayName||"Context")+".Provider";case Yo:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Xo:return t=e.displayName||null,t!==null?t:Hs(e.type)||"Memo";case At:t=e._payload,e=e._init;try{return Hs(e(t))}catch{}}return null}function Ah(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hs(t);case 8:return t===qo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Bt(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Fu(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Nh(e){var t=Fu(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hi(e){e._valueTracker||(e._valueTracker=Nh(e))}function $u(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Fu(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function yr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Bs(e,t){var n=t.checked;return ie({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Ka(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=Bt(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function zu(e,t){t=t.checked,t!=null&&Ko(e,"checked",t,!1)}function Gs(e,t){zu(e,t);var n=Bt(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Qs(e,t.type,n):t.hasOwnProperty("defaultValue")&&Qs(e,t.type,Bt(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function qa(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Qs(e,t,n){(t!=="number"||yr(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ri=Array.isArray;function Rn(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Bt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,i&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Js(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(x(91));return ie({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ya(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(x(92));if(ri(n)){if(1<n.length)throw Error(x(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Bt(n)}}function Vu(e,t){var n=Bt(t.value),i=Bt(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function Xa(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Wu(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ks(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Wu(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Bi,Hu=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,r){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Bi=Bi||document.createElement("div"),Bi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Bi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function _i(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ai={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dh=["Webkit","ms","Moz","O"];Object.keys(ai).forEach(function(e){Dh.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ai[t]=ai[e]})});function Bu(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ai.hasOwnProperty(e)&&ai[e]?(""+t).trim():t+"px"}function Gu(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=Bu(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}var Lh=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qs(e,t){if(t){if(Lh[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(x(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(x(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(x(61))}if(t.style!=null&&typeof t.style!="object")throw Error(x(62))}}function Ys(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xs=null;function Zo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Zs=null,An=null,Nn=null;function Za(e){if(e=Ui(e)){if(typeof Zs!="function")throw Error(x(280));var t=e.stateNode;t&&(t=Kr(t),Zs(e.stateNode,e.type,t))}}function Qu(e){An?Nn?Nn.push(e):Nn=[e]:An=e}function Ju(){if(An){var e=An,t=Nn;if(Nn=An=null,Za(e),t)for(e=0;e<t.length;e++)Za(t[e])}}function Ku(e,t){return e(t)}function qu(){}var gs=!1;function Yu(e,t,n){if(gs)return e(t,n);gs=!0;try{return Ku(e,t,n)}finally{gs=!1,(An!==null||Nn!==null)&&(qu(),Ju())}}function yi(e,t){var n=e.stateNode;if(n===null)return null;var i=Kr(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(x(231,t,typeof n));return n}var eo=!1;if(kt)try{var qn={};Object.defineProperty(qn,"passive",{get:function(){eo=!0}}),window.addEventListener("test",qn,qn),window.removeEventListener("test",qn,qn)}catch{eo=!1}function jh(e,t,n,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var li=!1,Sr=null,wr=!1,to=null,Mh={onError:function(e){li=!0,Sr=e}};function Oh(e,t,n,i,r,s,o,a,l){li=!1,Sr=null,jh.apply(Mh,arguments)}function Uh(e,t,n,i,r,s,o,a,l){if(Oh.apply(this,arguments),li){if(li){var u=Sr;li=!1,Sr=null}else throw Error(x(198));wr||(wr=!0,to=u)}}function pn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Xu(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function el(e){if(pn(e)!==e)throw Error(x(188))}function Fh(e){var t=e.alternate;if(!t){if(t=pn(e),t===null)throw Error(x(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return el(r),e;if(s===i)return el(r),t;s=s.sibling}throw Error(x(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(x(189))}}if(n.alternate!==i)throw Error(x(190))}if(n.tag!==3)throw Error(x(188));return n.stateNode.current===n?e:t}function Zu(e){return e=Fh(e),e!==null?ec(e):null}function ec(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ec(e);if(t!==null)return t;e=e.sibling}return null}var tc=$e.unstable_scheduleCallback,tl=$e.unstable_cancelCallback,$h=$e.unstable_shouldYield,zh=$e.unstable_requestPaint,oe=$e.unstable_now,Vh=$e.unstable_getCurrentPriorityLevel,ea=$e.unstable_ImmediatePriority,nc=$e.unstable_UserBlockingPriority,xr=$e.unstable_NormalPriority,Wh=$e.unstable_LowPriority,ic=$e.unstable_IdlePriority,Br=null,ft=null;function Hh(e){if(ft&&typeof ft.onCommitFiberRoot=="function")try{ft.onCommitFiberRoot(Br,e,void 0,(e.current.flags&128)===128)}catch{}}var st=Math.clz32?Math.clz32:Qh,Bh=Math.log,Gh=Math.LN2;function Qh(e){return e>>>=0,e===0?32:31-(Bh(e)/Gh|0)|0}var Gi=64,Qi=4194304;function si(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Cr(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=si(a):(s&=o,s!==0&&(i=si(s)))}else o=n&~r,o!==0?i=si(o):s!==0&&(i=si(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&r)&&(r=i&-i,s=t&-t,r>=s||r===16&&(s&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-st(t),r=1<<n,i|=e[n],t&=~r;return i}function Jh(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kh(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-st(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=Jh(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function no(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function rc(){var e=Gi;return Gi<<=1,!(Gi&4194240)&&(Gi=64),e}function vs(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Mi(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-st(t),e[t]=n}function qh(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-st(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}function ta(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-st(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var B=0;function sc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var oc,na,ac,lc,uc,io=!1,Ji=[],Ot=null,Ut=null,Ft=null,Si=new Map,wi=new Map,Dt=[],Yh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nl(e,t){switch(e){case"focusin":case"focusout":Ot=null;break;case"dragenter":case"dragleave":Ut=null;break;case"mouseover":case"mouseout":Ft=null;break;case"pointerover":case"pointerout":Si.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wi.delete(t.pointerId)}}function Yn(e,t,n,i,r,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},t!==null&&(t=Ui(t),t!==null&&na(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function Xh(e,t,n,i,r){switch(t){case"focusin":return Ot=Yn(Ot,e,t,n,i,r),!0;case"dragenter":return Ut=Yn(Ut,e,t,n,i,r),!0;case"mouseover":return Ft=Yn(Ft,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Si.set(s,Yn(Si.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,wi.set(s,Yn(wi.get(s)||null,e,t,n,i,r)),!0}return!1}function cc(e){var t=en(e.target);if(t!==null){var n=pn(t);if(n!==null){if(t=n.tag,t===13){if(t=Xu(n),t!==null){e.blockedOn=t,uc(e.priority,function(){ac(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ar(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ro(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Xs=i,n.target.dispatchEvent(i),Xs=null}else return t=Ui(n),t!==null&&na(t),e.blockedOn=n,!1;t.shift()}return!0}function il(e,t,n){ar(e)&&n.delete(t)}function Zh(){io=!1,Ot!==null&&ar(Ot)&&(Ot=null),Ut!==null&&ar(Ut)&&(Ut=null),Ft!==null&&ar(Ft)&&(Ft=null),Si.forEach(il),wi.forEach(il)}function Xn(e,t){e.blockedOn===t&&(e.blockedOn=null,io||(io=!0,$e.unstable_scheduleCallback($e.unstable_NormalPriority,Zh)))}function xi(e){function t(r){return Xn(r,e)}if(0<Ji.length){Xn(Ji[0],e);for(var n=1;n<Ji.length;n++){var i=Ji[n];i.blockedOn===e&&(i.blockedOn=null)}}for(Ot!==null&&Xn(Ot,e),Ut!==null&&Xn(Ut,e),Ft!==null&&Xn(Ft,e),Si.forEach(t),wi.forEach(t),n=0;n<Dt.length;n++)i=Dt[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<Dt.length&&(n=Dt[0],n.blockedOn===null);)cc(n),n.blockedOn===null&&Dt.shift()}var Dn=It.ReactCurrentBatchConfig,kr=!0;function ef(e,t,n,i){var r=B,s=Dn.transition;Dn.transition=null;try{B=1,ia(e,t,n,i)}finally{B=r,Dn.transition=s}}function tf(e,t,n,i){var r=B,s=Dn.transition;Dn.transition=null;try{B=4,ia(e,t,n,i)}finally{B=r,Dn.transition=s}}function ia(e,t,n,i){if(kr){var r=ro(e,t,n,i);if(r===null)Ps(e,t,i,Er,n),nl(e,i);else if(Xh(r,e,t,n,i))i.stopPropagation();else if(nl(e,i),t&4&&-1<Yh.indexOf(e)){for(;r!==null;){var s=Ui(r);if(s!==null&&oc(s),s=ro(e,t,n,i),s===null&&Ps(e,t,i,Er,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Ps(e,t,i,null,n)}}var Er=null;function ro(e,t,n,i){if(Er=null,e=Zo(i),e=en(e),e!==null)if(t=pn(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Xu(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Er=e,null}function dc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vh()){case ea:return 1;case nc:return 4;case xr:case Wh:return 16;case ic:return 536870912;default:return 16}default:return 16}}var jt=null,ra=null,lr=null;function hc(){if(lr)return lr;var e,t=ra,n=t.length,i,r="value"in jt?jt.value:jt.textContent,s=r.length;for(e=0;e<n&&t[e]===r[e];e++);var o=n-e;for(i=1;i<=o&&t[n-i]===r[s-i];i++);return lr=r.slice(e,1<i?1-i:void 0)}function ur(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ki(){return!0}function rl(){return!1}function We(e){function t(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ki:rl,this.isPropagationStopped=rl,this}return ie(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ki)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ki)},persist:function(){},isPersistent:Ki}),t}var Qn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sa=We(Qn),Oi=ie({},Qn,{view:0,detail:0}),nf=We(Oi),_s,ys,Zn,Gr=ie({},Oi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oa,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zn&&(Zn&&e.type==="mousemove"?(_s=e.screenX-Zn.screenX,ys=e.screenY-Zn.screenY):ys=_s=0,Zn=e),_s)},movementY:function(e){return"movementY"in e?e.movementY:ys}}),sl=We(Gr),rf=ie({},Gr,{dataTransfer:0}),sf=We(rf),of=ie({},Oi,{relatedTarget:0}),Ss=We(of),af=ie({},Qn,{animationName:0,elapsedTime:0,pseudoElement:0}),lf=We(af),uf=ie({},Qn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cf=We(uf),df=ie({},Qn,{data:0}),ol=We(df),hf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ff={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mf(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=pf[e])?!!t[e]:!1}function oa(){return mf}var gf=ie({},Oi,{key:function(e){if(e.key){var t=hf[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ur(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ff[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oa,charCode:function(e){return e.type==="keypress"?ur(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ur(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),vf=We(gf),_f=ie({},Gr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),al=We(_f),yf=ie({},Oi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oa}),Sf=We(yf),wf=ie({},Qn,{propertyName:0,elapsedTime:0,pseudoElement:0}),xf=We(wf),Cf=ie({},Gr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),kf=We(Cf),Ef=[9,13,27,32],aa=kt&&"CompositionEvent"in window,ui=null;kt&&"documentMode"in document&&(ui=document.documentMode);var Tf=kt&&"TextEvent"in window&&!ui,fc=kt&&(!aa||ui&&8<ui&&11>=ui),ll=" ",ul=!1;function pc(e,t){switch(e){case"keyup":return Ef.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mc(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Sn=!1;function Pf(e,t){switch(e){case"compositionend":return mc(t);case"keypress":return t.which!==32?null:(ul=!0,ll);case"textInput":return e=t.data,e===ll&&ul?null:e;default:return null}}function bf(e,t){if(Sn)return e==="compositionend"||!aa&&pc(e,t)?(e=hc(),lr=ra=jt=null,Sn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return fc&&t.locale!=="ko"?null:t.data;default:return null}}var If={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!If[e.type]:t==="textarea"}function gc(e,t,n,i){Qu(i),t=Tr(t,"onChange"),0<t.length&&(n=new sa("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var ci=null,Ci=null;function Rf(e){Pc(e,0)}function Qr(e){var t=Cn(e);if($u(t))return e}function Af(e,t){if(e==="change")return t}var vc=!1;if(kt){var ws;if(kt){var xs="oninput"in document;if(!xs){var dl=document.createElement("div");dl.setAttribute("oninput","return;"),xs=typeof dl.oninput=="function"}ws=xs}else ws=!1;vc=ws&&(!document.documentMode||9<document.documentMode)}function hl(){ci&&(ci.detachEvent("onpropertychange",_c),Ci=ci=null)}function _c(e){if(e.propertyName==="value"&&Qr(Ci)){var t=[];gc(t,Ci,e,Zo(e)),Yu(Rf,t)}}function Nf(e,t,n){e==="focusin"?(hl(),ci=t,Ci=n,ci.attachEvent("onpropertychange",_c)):e==="focusout"&&hl()}function Df(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Qr(Ci)}function Lf(e,t){if(e==="click")return Qr(t)}function jf(e,t){if(e==="input"||e==="change")return Qr(t)}function Mf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var lt=typeof Object.is=="function"?Object.is:Mf;function ki(e,t){if(lt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!$s.call(t,r)||!lt(e[r],t[r]))return!1}return!0}function fl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pl(e,t){var n=fl(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fl(n)}}function yc(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yc(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Sc(){for(var e=window,t=yr();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=yr(e.document)}return t}function la(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Of(e){var t=Sc(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&yc(n.ownerDocument.documentElement,n)){if(i!==null&&la(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=pl(n,s);var o=pl(n,i);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Uf=kt&&"documentMode"in document&&11>=document.documentMode,wn=null,so=null,di=null,oo=!1;function ml(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;oo||wn==null||wn!==yr(i)||(i=wn,"selectionStart"in i&&la(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),di&&ki(di,i)||(di=i,i=Tr(so,"onSelect"),0<i.length&&(t=new sa("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=wn)))}function qi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xn={animationend:qi("Animation","AnimationEnd"),animationiteration:qi("Animation","AnimationIteration"),animationstart:qi("Animation","AnimationStart"),transitionend:qi("Transition","TransitionEnd")},Cs={},wc={};kt&&(wc=document.createElement("div").style,"AnimationEvent"in window||(delete xn.animationend.animation,delete xn.animationiteration.animation,delete xn.animationstart.animation),"TransitionEvent"in window||delete xn.transitionend.transition);function Jr(e){if(Cs[e])return Cs[e];if(!xn[e])return e;var t=xn[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in wc)return Cs[e]=t[n];return e}var xc=Jr("animationend"),Cc=Jr("animationiteration"),kc=Jr("animationstart"),Ec=Jr("transitionend"),Tc=new Map,gl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qt(e,t){Tc.set(e,t),fn(t,[e])}for(var ks=0;ks<gl.length;ks++){var Es=gl[ks],Ff=Es.toLowerCase(),$f=Es[0].toUpperCase()+Es.slice(1);Qt(Ff,"on"+$f)}Qt(xc,"onAnimationEnd");Qt(Cc,"onAnimationIteration");Qt(kc,"onAnimationStart");Qt("dblclick","onDoubleClick");Qt("focusin","onFocus");Qt("focusout","onBlur");Qt(Ec,"onTransitionEnd");Un("onMouseEnter",["mouseout","mouseover"]);Un("onMouseLeave",["mouseout","mouseover"]);Un("onPointerEnter",["pointerout","pointerover"]);Un("onPointerLeave",["pointerout","pointerover"]);fn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fn("onBeforeInput",["compositionend","keypress","textInput","paste"]);fn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zf=new Set("cancel close invalid load scroll toggle".split(" ").concat(oi));function vl(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,Uh(i,t,void 0,e),e.currentTarget=null}function Pc(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;vl(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;vl(r,a,u),s=l}}}if(wr)throw e=to,wr=!1,to=null,e}function q(e,t){var n=t[ho];n===void 0&&(n=t[ho]=new Set);var i=e+"__bubble";n.has(i)||(bc(t,e,2,!1),n.add(i))}function Ts(e,t,n){var i=0;t&&(i|=4),bc(n,e,i,t)}var Yi="_reactListening"+Math.random().toString(36).slice(2);function Ei(e){if(!e[Yi]){e[Yi]=!0,ju.forEach(function(n){n!=="selectionchange"&&(zf.has(n)||Ts(n,!1,e),Ts(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Yi]||(t[Yi]=!0,Ts("selectionchange",!1,t))}}function bc(e,t,n,i){switch(dc(t)){case 1:var r=ef;break;case 4:r=tf;break;default:r=ia}n=r.bind(null,t,n,e),r=void 0,!eo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Ps(e,t,n,i,r){var s=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=en(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}Yu(function(){var u=s,c=Zo(n),d=[];e:{var h=Tc.get(e);if(h!==void 0){var v=sa,y=e;switch(e){case"keypress":if(ur(n)===0)break e;case"keydown":case"keyup":v=vf;break;case"focusin":y="focus",v=Ss;break;case"focusout":y="blur",v=Ss;break;case"beforeblur":case"afterblur":v=Ss;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=sl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=sf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Sf;break;case xc:case Cc:case kc:v=lf;break;case Ec:v=xf;break;case"scroll":v=nf;break;case"wheel":v=kf;break;case"copy":case"cut":case"paste":v=cf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=al}var _=(t&4)!==0,I=!_&&e==="scroll",f=_?h!==null?h+"Capture":null:h;_=[];for(var m=u,g;m!==null;){g=m;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,f!==null&&(S=yi(m,f),S!=null&&_.push(Ti(m,S,g)))),I)break;m=m.return}0<_.length&&(h=new v(h,y,null,n,c),d.push({event:h,listeners:_}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",h&&n!==Xs&&(y=n.relatedTarget||n.fromElement)&&(en(y)||y[Et]))break e;if((v||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,v?(y=n.relatedTarget||n.toElement,v=u,y=y?en(y):null,y!==null&&(I=pn(y),y!==I||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=u),v!==y)){if(_=sl,S="onMouseLeave",f="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(_=al,S="onPointerLeave",f="onPointerEnter",m="pointer"),I=v==null?h:Cn(v),g=y==null?h:Cn(y),h=new _(S,m+"leave",v,n,c),h.target=I,h.relatedTarget=g,S=null,en(c)===u&&(_=new _(f,m+"enter",y,n,c),_.target=g,_.relatedTarget=I,S=_),I=S,v&&y)t:{for(_=v,f=y,m=0,g=_;g;g=mn(g))m++;for(g=0,S=f;S;S=mn(S))g++;for(;0<m-g;)_=mn(_),m--;for(;0<g-m;)f=mn(f),g--;for(;m--;){if(_===f||f!==null&&_===f.alternate)break t;_=mn(_),f=mn(f)}_=null}else _=null;v!==null&&_l(d,h,v,_,!1),y!==null&&I!==null&&_l(d,I,y,_,!0)}}e:{if(h=u?Cn(u):window,v=h.nodeName&&h.nodeName.toLowerCase(),v==="select"||v==="input"&&h.type==="file")var C=Af;else if(cl(h))if(vc)C=jf;else{C=Df;var k=Nf}else(v=h.nodeName)&&v.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=Lf);if(C&&(C=C(e,u))){gc(d,C,n,c);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Qs(h,"number",h.value)}switch(k=u?Cn(u):window,e){case"focusin":(cl(k)||k.contentEditable==="true")&&(wn=k,so=u,di=null);break;case"focusout":di=so=wn=null;break;case"mousedown":oo=!0;break;case"contextmenu":case"mouseup":case"dragend":oo=!1,ml(d,n,c);break;case"selectionchange":if(Uf)break;case"keydown":case"keyup":ml(d,n,c)}var E;if(aa)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Sn?pc(e,n)&&(w="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(fc&&n.locale!=="ko"&&(Sn||w!=="onCompositionStart"?w==="onCompositionEnd"&&Sn&&(E=hc()):(jt=c,ra="value"in jt?jt.value:jt.textContent,Sn=!0)),k=Tr(u,w),0<k.length&&(w=new ol(w,e,null,n,c),d.push({event:w,listeners:k}),E?w.data=E:(E=mc(n),E!==null&&(w.data=E)))),(E=Tf?Pf(e,n):bf(e,n))&&(u=Tr(u,"onBeforeInput"),0<u.length&&(c=new ol("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=E))}Pc(d,t)})}function Ti(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Tr(e,t){for(var n=t+"Capture",i=[];e!==null;){var r=e,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=yi(e,n),s!=null&&i.unshift(Ti(e,s,r)),s=yi(e,t),s!=null&&i.push(Ti(e,s,r))),e=e.return}return i}function mn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _l(e,t,n,i,r){for(var s=t._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=yi(n,s),l!=null&&o.unshift(Ti(n,l,a))):r||(l=yi(n,s),l!=null&&o.push(Ti(n,l,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Vf=/\r\n?/g,Wf=/\u0000|\uFFFD/g;function yl(e){return(typeof e=="string"?e:""+e).replace(Vf,`
`).replace(Wf,"")}function Xi(e,t,n){if(t=yl(t),yl(e)!==t&&n)throw Error(x(425))}function Pr(){}var ao=null,lo=null;function uo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var co=typeof setTimeout=="function"?setTimeout:void 0,Hf=typeof clearTimeout=="function"?clearTimeout:void 0,Sl=typeof Promise=="function"?Promise:void 0,Bf=typeof queueMicrotask=="function"?queueMicrotask:typeof Sl<"u"?function(e){return Sl.resolve(null).then(e).catch(Gf)}:co;function Gf(e){setTimeout(function(){throw e})}function bs(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){e.removeChild(r),xi(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);xi(t)}function $t(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function wl(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Jn=Math.random().toString(36).slice(2),ht="__reactFiber$"+Jn,Pi="__reactProps$"+Jn,Et="__reactContainer$"+Jn,ho="__reactEvents$"+Jn,Qf="__reactListeners$"+Jn,Jf="__reactHandles$"+Jn;function en(e){var t=e[ht];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Et]||n[ht]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=wl(e);e!==null;){if(n=e[ht])return n;e=wl(e)}return t}e=n,n=e.parentNode}return null}function Ui(e){return e=e[ht]||e[Et],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Cn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(x(33))}function Kr(e){return e[Pi]||null}var fo=[],kn=-1;function Jt(e){return{current:e}}function Y(e){0>kn||(e.current=fo[kn],fo[kn]=null,kn--)}function J(e,t){kn++,fo[kn]=e.current,e.current=t}var Gt={},ke=Jt(Gt),De=Jt(!1),ln=Gt;function Fn(e,t){var n=e.type.contextTypes;if(!n)return Gt;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Le(e){return e=e.childContextTypes,e!=null}function br(){Y(De),Y(ke)}function xl(e,t,n){if(ke.current!==Gt)throw Error(x(168));J(ke,t),J(De,n)}function Ic(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in t))throw Error(x(108,Ah(e)||"Unknown",r));return ie({},n,i)}function Ir(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Gt,ln=ke.current,J(ke,e),J(De,De.current),!0}function Cl(e,t,n){var i=e.stateNode;if(!i)throw Error(x(169));n?(e=Ic(e,t,ln),i.__reactInternalMemoizedMergedChildContext=e,Y(De),Y(ke),J(ke,e)):Y(De),J(De,n)}var St=null,qr=!1,Is=!1;function Rc(e){St===null?St=[e]:St.push(e)}function Kf(e){qr=!0,Rc(e)}function Kt(){if(!Is&&St!==null){Is=!0;var e=0,t=B;try{var n=St;for(B=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}St=null,qr=!1}catch(r){throw St!==null&&(St=St.slice(e+1)),tc(ea,Kt),r}finally{B=t,Is=!1}}return null}var En=[],Tn=0,Rr=null,Ar=0,He=[],Be=0,un=null,wt=1,xt="";function Xt(e,t){En[Tn++]=Ar,En[Tn++]=Rr,Rr=e,Ar=t}function Ac(e,t,n){He[Be++]=wt,He[Be++]=xt,He[Be++]=un,un=e;var i=wt;e=xt;var r=32-st(i)-1;i&=~(1<<r),n+=1;var s=32-st(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,wt=1<<32-st(t)+r|n<<r|i,xt=s+e}else wt=1<<s|n<<r|i,xt=e}function ua(e){e.return!==null&&(Xt(e,1),Ac(e,1,0))}function ca(e){for(;e===Rr;)Rr=En[--Tn],En[Tn]=null,Ar=En[--Tn],En[Tn]=null;for(;e===un;)un=He[--Be],He[Be]=null,xt=He[--Be],He[Be]=null,wt=He[--Be],He[Be]=null}var Fe=null,Ue=null,Z=!1,it=null;function Nc(e,t){var n=Ge(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function kl(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Fe=e,Ue=$t(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Fe=e,Ue=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=un!==null?{id:wt,overflow:xt}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ge(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Fe=e,Ue=null,!0):!1;default:return!1}}function po(e){return(e.mode&1)!==0&&(e.flags&128)===0}function mo(e){if(Z){var t=Ue;if(t){var n=t;if(!kl(e,t)){if(po(e))throw Error(x(418));t=$t(n.nextSibling);var i=Fe;t&&kl(e,t)?Nc(i,n):(e.flags=e.flags&-4097|2,Z=!1,Fe=e)}}else{if(po(e))throw Error(x(418));e.flags=e.flags&-4097|2,Z=!1,Fe=e}}}function El(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Fe=e}function Zi(e){if(e!==Fe)return!1;if(!Z)return El(e),Z=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!uo(e.type,e.memoizedProps)),t&&(t=Ue)){if(po(e))throw Dc(),Error(x(418));for(;t;)Nc(e,t),t=$t(t.nextSibling)}if(El(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(x(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ue=$t(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ue=null}}else Ue=Fe?$t(e.stateNode.nextSibling):null;return!0}function Dc(){for(var e=Ue;e;)e=$t(e.nextSibling)}function $n(){Ue=Fe=null,Z=!1}function da(e){it===null?it=[e]:it.push(e)}var qf=It.ReactCurrentBatchConfig;function ei(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(x(309));var i=n.stateNode}if(!i)throw Error(x(147,e));var r=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(x(284));if(!n._owner)throw Error(x(290,e))}return e}function er(e,t){throw e=Object.prototype.toString.call(t),Error(x(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Tl(e){var t=e._init;return t(e._payload)}function Lc(e){function t(f,m){if(e){var g=f.deletions;g===null?(f.deletions=[m],f.flags|=16):g.push(m)}}function n(f,m){if(!e)return null;for(;m!==null;)t(f,m),m=m.sibling;return null}function i(f,m){for(f=new Map;m!==null;)m.key!==null?f.set(m.key,m):f.set(m.index,m),m=m.sibling;return f}function r(f,m){return f=Ht(f,m),f.index=0,f.sibling=null,f}function s(f,m,g){return f.index=g,e?(g=f.alternate,g!==null?(g=g.index,g<m?(f.flags|=2,m):g):(f.flags|=2,m)):(f.flags|=1048576,m)}function o(f){return e&&f.alternate===null&&(f.flags|=2),f}function a(f,m,g,S){return m===null||m.tag!==6?(m=Ms(g,f.mode,S),m.return=f,m):(m=r(m,g),m.return=f,m)}function l(f,m,g,S){var C=g.type;return C===yn?c(f,m,g.props.children,S,g.key):m!==null&&(m.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===At&&Tl(C)===m.type)?(S=r(m,g.props),S.ref=ei(f,m,g),S.return=f,S):(S=gr(g.type,g.key,g.props,null,f.mode,S),S.ref=ei(f,m,g),S.return=f,S)}function u(f,m,g,S){return m===null||m.tag!==4||m.stateNode.containerInfo!==g.containerInfo||m.stateNode.implementation!==g.implementation?(m=Os(g,f.mode,S),m.return=f,m):(m=r(m,g.children||[]),m.return=f,m)}function c(f,m,g,S,C){return m===null||m.tag!==7?(m=on(g,f.mode,S,C),m.return=f,m):(m=r(m,g),m.return=f,m)}function d(f,m,g){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Ms(""+m,f.mode,g),m.return=f,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Wi:return g=gr(m.type,m.key,m.props,null,f.mode,g),g.ref=ei(f,null,m),g.return=f,g;case _n:return m=Os(m,f.mode,g),m.return=f,m;case At:var S=m._init;return d(f,S(m._payload),g)}if(ri(m)||Kn(m))return m=on(m,f.mode,g,null),m.return=f,m;er(f,m)}return null}function h(f,m,g,S){var C=m!==null?m.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return C!==null?null:a(f,m,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Wi:return g.key===C?l(f,m,g,S):null;case _n:return g.key===C?u(f,m,g,S):null;case At:return C=g._init,h(f,m,C(g._payload),S)}if(ri(g)||Kn(g))return C!==null?null:c(f,m,g,S,null);er(f,g)}return null}function v(f,m,g,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return f=f.get(g)||null,a(m,f,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Wi:return f=f.get(S.key===null?g:S.key)||null,l(m,f,S,C);case _n:return f=f.get(S.key===null?g:S.key)||null,u(m,f,S,C);case At:var k=S._init;return v(f,m,g,k(S._payload),C)}if(ri(S)||Kn(S))return f=f.get(g)||null,c(m,f,S,C,null);er(m,S)}return null}function y(f,m,g,S){for(var C=null,k=null,E=m,w=m=0,N=null;E!==null&&w<g.length;w++){E.index>w?(N=E,E=null):N=E.sibling;var b=h(f,E,g[w],S);if(b===null){E===null&&(E=N);break}e&&E&&b.alternate===null&&t(f,E),m=s(b,m,w),k===null?C=b:k.sibling=b,k=b,E=N}if(w===g.length)return n(f,E),Z&&Xt(f,w),C;if(E===null){for(;w<g.length;w++)E=d(f,g[w],S),E!==null&&(m=s(E,m,w),k===null?C=E:k.sibling=E,k=E);return Z&&Xt(f,w),C}for(E=i(f,E);w<g.length;w++)N=v(E,f,w,g[w],S),N!==null&&(e&&N.alternate!==null&&E.delete(N.key===null?w:N.key),m=s(N,m,w),k===null?C=N:k.sibling=N,k=N);return e&&E.forEach(function(D){return t(f,D)}),Z&&Xt(f,w),C}function _(f,m,g,S){var C=Kn(g);if(typeof C!="function")throw Error(x(150));if(g=C.call(g),g==null)throw Error(x(151));for(var k=C=null,E=m,w=m=0,N=null,b=g.next();E!==null&&!b.done;w++,b=g.next()){E.index>w?(N=E,E=null):N=E.sibling;var D=h(f,E,b.value,S);if(D===null){E===null&&(E=N);break}e&&E&&D.alternate===null&&t(f,E),m=s(D,m,w),k===null?C=D:k.sibling=D,k=D,E=N}if(b.done)return n(f,E),Z&&Xt(f,w),C;if(E===null){for(;!b.done;w++,b=g.next())b=d(f,b.value,S),b!==null&&(m=s(b,m,w),k===null?C=b:k.sibling=b,k=b);return Z&&Xt(f,w),C}for(E=i(f,E);!b.done;w++,b=g.next())b=v(E,f,w,b.value,S),b!==null&&(e&&b.alternate!==null&&E.delete(b.key===null?w:b.key),m=s(b,m,w),k===null?C=b:k.sibling=b,k=b);return e&&E.forEach(function($){return t(f,$)}),Z&&Xt(f,w),C}function I(f,m,g,S){if(typeof g=="object"&&g!==null&&g.type===yn&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Wi:e:{for(var C=g.key,k=m;k!==null;){if(k.key===C){if(C=g.type,C===yn){if(k.tag===7){n(f,k.sibling),m=r(k,g.props.children),m.return=f,f=m;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===At&&Tl(C)===k.type){n(f,k.sibling),m=r(k,g.props),m.ref=ei(f,k,g),m.return=f,f=m;break e}n(f,k);break}else t(f,k);k=k.sibling}g.type===yn?(m=on(g.props.children,f.mode,S,g.key),m.return=f,f=m):(S=gr(g.type,g.key,g.props,null,f.mode,S),S.ref=ei(f,m,g),S.return=f,f=S)}return o(f);case _n:e:{for(k=g.key;m!==null;){if(m.key===k)if(m.tag===4&&m.stateNode.containerInfo===g.containerInfo&&m.stateNode.implementation===g.implementation){n(f,m.sibling),m=r(m,g.children||[]),m.return=f,f=m;break e}else{n(f,m);break}else t(f,m);m=m.sibling}m=Os(g,f.mode,S),m.return=f,f=m}return o(f);case At:return k=g._init,I(f,m,k(g._payload),S)}if(ri(g))return y(f,m,g,S);if(Kn(g))return _(f,m,g,S);er(f,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,m!==null&&m.tag===6?(n(f,m.sibling),m=r(m,g),m.return=f,f=m):(n(f,m),m=Ms(g,f.mode,S),m.return=f,f=m),o(f)):n(f,m)}return I}var zn=Lc(!0),jc=Lc(!1),Nr=Jt(null),Dr=null,Pn=null,ha=null;function fa(){ha=Pn=Dr=null}function pa(e){var t=Nr.current;Y(Nr),e._currentValue=t}function go(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ln(e,t){Dr=e,ha=Pn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ne=!0),e.firstContext=null)}function Ke(e){var t=e._currentValue;if(ha!==e)if(e={context:e,memoizedValue:t,next:null},Pn===null){if(Dr===null)throw Error(x(308));Pn=e,Dr.dependencies={lanes:0,firstContext:e}}else Pn=Pn.next=e;return t}var tn=null;function ma(e){tn===null?tn=[e]:tn.push(e)}function Mc(e,t,n,i){var r=t.interleaved;return r===null?(n.next=n,ma(t)):(n.next=r.next,r.next=n),t.interleaved=n,Tt(e,i)}function Tt(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Nt=!1;function ga(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ct(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zt(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,z&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Tt(e,n)}return r=i.interleaved,r===null?(t.next=t,ma(i)):(t.next=r.next,r.next=t),i.interleaved=t,Tt(e,n)}function cr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,ta(e,n)}}function Pl(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=t:s=s.next=t}else r=s=t;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Lr(e,t,n,i){var r=e.updateQueue;Nt=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=e.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,v=a.eventTime;if((i&h)===h){c!==null&&(c=c.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,_=a;switch(h=t,v=n,_.tag){case 1:if(y=_.payload,typeof y=="function"){d=y.call(v,d,h);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=_.payload,h=typeof y=="function"?y.call(v,d,h):y,h==null)break e;d=ie({},d,h);break e;case 2:Nt=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else v={eventTime:v,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=v,l=d):c=c.next=v,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(c===null&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else s===null&&(r.shared.lanes=0);dn|=o,e.lanes=o,e.memoizedState=d}}function bl(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(x(191,r));r.call(i)}}}var Fi={},pt=Jt(Fi),bi=Jt(Fi),Ii=Jt(Fi);function nn(e){if(e===Fi)throw Error(x(174));return e}function va(e,t){switch(J(Ii,t),J(bi,e),J(pt,Fi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ks(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ks(t,e)}Y(pt),J(pt,t)}function Vn(){Y(pt),Y(bi),Y(Ii)}function Uc(e){nn(Ii.current);var t=nn(pt.current),n=Ks(t,e.type);t!==n&&(J(bi,e),J(pt,n))}function _a(e){bi.current===e&&(Y(pt),Y(bi))}var te=Jt(0);function jr(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Rs=[];function ya(){for(var e=0;e<Rs.length;e++)Rs[e]._workInProgressVersionPrimary=null;Rs.length=0}var dr=It.ReactCurrentDispatcher,As=It.ReactCurrentBatchConfig,cn=0,ne=null,ue=null,pe=null,Mr=!1,hi=!1,Ri=0,Yf=0;function Se(){throw Error(x(321))}function Sa(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lt(e[n],t[n]))return!1;return!0}function wa(e,t,n,i,r,s){if(cn=s,ne=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,dr.current=e===null||e.memoizedState===null?tp:np,e=n(i,r),hi){s=0;do{if(hi=!1,Ri=0,25<=s)throw Error(x(301));s+=1,pe=ue=null,t.updateQueue=null,dr.current=ip,e=n(i,r)}while(hi)}if(dr.current=Or,t=ue!==null&&ue.next!==null,cn=0,pe=ue=ne=null,Mr=!1,t)throw Error(x(300));return e}function xa(){var e=Ri!==0;return Ri=0,e}function dt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pe===null?ne.memoizedState=pe=e:pe=pe.next=e,pe}function qe(){if(ue===null){var e=ne.alternate;e=e!==null?e.memoizedState:null}else e=ue.next;var t=pe===null?ne.memoizedState:pe.next;if(t!==null)pe=t,ue=e;else{if(e===null)throw Error(x(310));ue=e,e={memoizedState:ue.memoizedState,baseState:ue.baseState,baseQueue:ue.baseQueue,queue:ue.queue,next:null},pe===null?ne.memoizedState=pe=e:pe=pe.next=e}return pe}function Ai(e,t){return typeof t=="function"?t(e):t}function Ns(e){var t=qe(),n=t.queue;if(n===null)throw Error(x(311));n.lastRenderedReducer=e;var i=ue,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((cn&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,ne.lanes|=c,dn|=c}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,lt(i,t.memoizedState)||(Ne=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=l,n.lastRenderedState=i}if(e=n.interleaved,e!==null){r=e;do s=r.lane,ne.lanes|=s,dn|=s,r=r.next;while(r!==e)}else r===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ds(e){var t=qe(),n=t.queue;if(n===null)throw Error(x(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=e(s,o.action),o=o.next;while(o!==r);lt(s,t.memoizedState)||(Ne=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function Fc(){}function $c(e,t){var n=ne,i=qe(),r=t(),s=!lt(i.memoizedState,r);if(s&&(i.memoizedState=r,Ne=!0),i=i.queue,Ca(Wc.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||pe!==null&&pe.memoizedState.tag&1){if(n.flags|=2048,Ni(9,Vc.bind(null,n,i,r,t),void 0,null),ge===null)throw Error(x(349));cn&30||zc(n,t,r)}return r}function zc(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ne.updateQueue,t===null?(t={lastEffect:null,stores:null},ne.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Vc(e,t,n,i){t.value=n,t.getSnapshot=i,Hc(t)&&Bc(e)}function Wc(e,t,n){return n(function(){Hc(t)&&Bc(e)})}function Hc(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!lt(e,n)}catch{return!0}}function Bc(e){var t=Tt(e,1);t!==null&&ot(t,e,1,-1)}function Il(e){var t=dt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:e},t.queue=e,e=e.dispatch=ep.bind(null,ne,e),[t.memoizedState,e]}function Ni(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=ne.updateQueue,t===null?(t={lastEffect:null,stores:null},ne.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function Gc(){return qe().memoizedState}function hr(e,t,n,i){var r=dt();ne.flags|=e,r.memoizedState=Ni(1|t,n,void 0,i===void 0?null:i)}function Yr(e,t,n,i){var r=qe();i=i===void 0?null:i;var s=void 0;if(ue!==null){var o=ue.memoizedState;if(s=o.destroy,i!==null&&Sa(i,o.deps)){r.memoizedState=Ni(t,n,s,i);return}}ne.flags|=e,r.memoizedState=Ni(1|t,n,s,i)}function Rl(e,t){return hr(8390656,8,e,t)}function Ca(e,t){return Yr(2048,8,e,t)}function Qc(e,t){return Yr(4,2,e,t)}function Jc(e,t){return Yr(4,4,e,t)}function Kc(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function qc(e,t,n){return n=n!=null?n.concat([e]):null,Yr(4,4,Kc.bind(null,t,e),n)}function ka(){}function Yc(e,t){var n=qe();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&Sa(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Xc(e,t){var n=qe();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&Sa(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Zc(e,t,n){return cn&21?(lt(n,t)||(n=rc(),ne.lanes|=n,dn|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ne=!0),e.memoizedState=n)}function Xf(e,t){var n=B;B=n!==0&&4>n?n:4,e(!0);var i=As.transition;As.transition={};try{e(!1),t()}finally{B=n,As.transition=i}}function ed(){return qe().memoizedState}function Zf(e,t,n){var i=Wt(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},td(e))nd(t,n);else if(n=Mc(e,t,n,i),n!==null){var r=Pe();ot(n,e,i,r),id(n,t,i)}}function ep(e,t,n){var i=Wt(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(td(e))nd(t,r);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,lt(a,o)){var l=t.interleaved;l===null?(r.next=r,ma(t)):(r.next=l.next,l.next=r),t.interleaved=r;return}}catch{}finally{}n=Mc(e,t,r,i),n!==null&&(r=Pe(),ot(n,e,i,r),id(n,t,i))}}function td(e){var t=e.alternate;return e===ne||t!==null&&t===ne}function nd(e,t){hi=Mr=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function id(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,ta(e,n)}}var Or={readContext:Ke,useCallback:Se,useContext:Se,useEffect:Se,useImperativeHandle:Se,useInsertionEffect:Se,useLayoutEffect:Se,useMemo:Se,useReducer:Se,useRef:Se,useState:Se,useDebugValue:Se,useDeferredValue:Se,useTransition:Se,useMutableSource:Se,useSyncExternalStore:Se,useId:Se,unstable_isNewReconciler:!1},tp={readContext:Ke,useCallback:function(e,t){return dt().memoizedState=[e,t===void 0?null:t],e},useContext:Ke,useEffect:Rl,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,hr(4194308,4,Kc.bind(null,t,e),n)},useLayoutEffect:function(e,t){return hr(4194308,4,e,t)},useInsertionEffect:function(e,t){return hr(4,2,e,t)},useMemo:function(e,t){var n=dt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=dt();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Zf.bind(null,ne,e),[i.memoizedState,e]},useRef:function(e){var t=dt();return e={current:e},t.memoizedState=e},useState:Il,useDebugValue:ka,useDeferredValue:function(e){return dt().memoizedState=e},useTransition:function(){var e=Il(!1),t=e[0];return e=Xf.bind(null,e[1]),dt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=ne,r=dt();if(Z){if(n===void 0)throw Error(x(407));n=n()}else{if(n=t(),ge===null)throw Error(x(349));cn&30||zc(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Rl(Wc.bind(null,i,s,e),[e]),i.flags|=2048,Ni(9,Vc.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=dt(),t=ge.identifierPrefix;if(Z){var n=xt,i=wt;n=(i&~(1<<32-st(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ri++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Yf++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},np={readContext:Ke,useCallback:Yc,useContext:Ke,useEffect:Ca,useImperativeHandle:qc,useInsertionEffect:Qc,useLayoutEffect:Jc,useMemo:Xc,useReducer:Ns,useRef:Gc,useState:function(){return Ns(Ai)},useDebugValue:ka,useDeferredValue:function(e){var t=qe();return Zc(t,ue.memoizedState,e)},useTransition:function(){var e=Ns(Ai)[0],t=qe().memoizedState;return[e,t]},useMutableSource:Fc,useSyncExternalStore:$c,useId:ed,unstable_isNewReconciler:!1},ip={readContext:Ke,useCallback:Yc,useContext:Ke,useEffect:Ca,useImperativeHandle:qc,useInsertionEffect:Qc,useLayoutEffect:Jc,useMemo:Xc,useReducer:Ds,useRef:Gc,useState:function(){return Ds(Ai)},useDebugValue:ka,useDeferredValue:function(e){var t=qe();return ue===null?t.memoizedState=e:Zc(t,ue.memoizedState,e)},useTransition:function(){var e=Ds(Ai)[0],t=qe().memoizedState;return[e,t]},useMutableSource:Fc,useSyncExternalStore:$c,useId:ed,unstable_isNewReconciler:!1};function et(e,t){if(e&&e.defaultProps){t=ie({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function vo(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:ie({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Xr={isMounted:function(e){return(e=e._reactInternals)?pn(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Pe(),r=Wt(e),s=Ct(i,r);s.payload=t,n!=null&&(s.callback=n),t=zt(e,s,r),t!==null&&(ot(t,e,r,i),cr(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Pe(),r=Wt(e),s=Ct(i,r);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=zt(e,s,r),t!==null&&(ot(t,e,r,i),cr(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Pe(),i=Wt(e),r=Ct(n,i);r.tag=2,t!=null&&(r.callback=t),t=zt(e,r,i),t!==null&&(ot(t,e,i,n),cr(t,e,i))}};function Al(e,t,n,i,r,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,o):t.prototype&&t.prototype.isPureReactComponent?!ki(n,i)||!ki(r,s):!0}function rd(e,t,n){var i=!1,r=Gt,s=t.contextType;return typeof s=="object"&&s!==null?s=Ke(s):(r=Le(t)?ln:ke.current,i=t.contextTypes,s=(i=i!=null)?Fn(e,r):Gt),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Xr,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Nl(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Xr.enqueueReplaceState(t,t.state,null)}function _o(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},ga(e);var s=t.contextType;typeof s=="object"&&s!==null?r.context=Ke(s):(s=Le(t)?ln:ke.current,r.context=Fn(e,s)),r.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(vo(e,t,s,n),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&Xr.enqueueReplaceState(r,r.state,null),Lr(e,n,r,i),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Wn(e,t){try{var n="",i=t;do n+=Rh(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:r,digest:null}}function Ls(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function yo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var rp=typeof WeakMap=="function"?WeakMap:Map;function sd(e,t,n){n=Ct(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Fr||(Fr=!0,Io=i),yo(e,t)},n}function od(e,t,n){n=Ct(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){yo(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){yo(e,t),typeof i!="function"&&(Vt===null?Vt=new Set([this]):Vt.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Dl(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new rp;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=_p.bind(null,e,t,n),t.then(e,e))}function Ll(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function jl(e,t,n,i,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Ct(-1,1),t.tag=2,zt(n,t,1))),n.lanes|=1),e)}var sp=It.ReactCurrentOwner,Ne=!1;function Ee(e,t,n,i){t.child=e===null?jc(t,null,n,i):zn(t,e.child,n,i)}function Ml(e,t,n,i,r){n=n.render;var s=t.ref;return Ln(t,r),i=wa(e,t,n,i,s,r),n=xa(),e!==null&&!Ne?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Pt(e,t,r)):(Z&&n&&ua(t),t.flags|=1,Ee(e,t,i,r),t.child)}function Ol(e,t,n,i,r){if(e===null){var s=n.type;return typeof s=="function"&&!Na(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,ad(e,t,s,i,r)):(e=gr(n.type,null,i,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ki,n(o,i)&&e.ref===t.ref)return Pt(e,t,r)}return t.flags|=1,e=Ht(s,i),e.ref=t.ref,e.return=t,t.child=e}function ad(e,t,n,i,r){if(e!==null){var s=e.memoizedProps;if(ki(s,i)&&e.ref===t.ref)if(Ne=!1,t.pendingProps=i=s,(e.lanes&r)!==0)e.flags&131072&&(Ne=!0);else return t.lanes=e.lanes,Pt(e,t,r)}return So(e,t,n,i,r)}function ld(e,t,n){var i=t.pendingProps,r=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},J(In,Oe),Oe|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,J(In,Oe),Oe|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,J(In,Oe),Oe|=i}else s!==null?(i=s.baseLanes|n,t.memoizedState=null):i=n,J(In,Oe),Oe|=i;return Ee(e,t,r,n),t.child}function ud(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function So(e,t,n,i,r){var s=Le(n)?ln:ke.current;return s=Fn(t,s),Ln(t,r),n=wa(e,t,n,i,s,r),i=xa(),e!==null&&!Ne?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Pt(e,t,r)):(Z&&i&&ua(t),t.flags|=1,Ee(e,t,n,r),t.child)}function Ul(e,t,n,i,r){if(Le(n)){var s=!0;Ir(t)}else s=!1;if(Ln(t,r),t.stateNode===null)fr(e,t),rd(t,n,i),_o(t,n,i,r),i=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ke(u):(u=Le(n)?ln:ke.current,u=Fn(t,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&Nl(t,o,i,u),Nt=!1;var h=t.memoizedState;o.state=h,Lr(t,i,o,r),l=t.memoizedState,a!==i||h!==l||De.current||Nt?(typeof c=="function"&&(vo(t,n,c,i),l=t.memoizedState),(a=Nt||Al(t,n,a,i,h,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Oc(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:et(t.type,a),o.props=u,d=t.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ke(l):(l=Le(n)?ln:ke.current,l=Fn(t,l));var v=n.getDerivedStateFromProps;(c=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&Nl(t,o,i,l),Nt=!1,h=t.memoizedState,o.state=h,Lr(t,i,o,r);var y=t.memoizedState;a!==d||h!==y||De.current||Nt?(typeof v=="function"&&(vo(t,n,v,i),y=t.memoizedState),(u=Nt||Al(t,n,u,i,h,y,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,y,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=y),o.props=i,o.state=y,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return wo(e,t,n,i,s,r)}function wo(e,t,n,i,r,s){ud(e,t);var o=(t.flags&128)!==0;if(!i&&!o)return r&&Cl(t,n,!1),Pt(e,t,s);i=t.stateNode,sp.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&o?(t.child=zn(t,e.child,null,s),t.child=zn(t,null,a,s)):Ee(e,t,a,s),t.memoizedState=i.state,r&&Cl(t,n,!0),t.child}function cd(e){var t=e.stateNode;t.pendingContext?xl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xl(e,t.context,!1),va(e,t.containerInfo)}function Fl(e,t,n,i,r){return $n(),da(r),t.flags|=256,Ee(e,t,n,i),t.child}var xo={dehydrated:null,treeContext:null,retryLane:0};function Co(e){return{baseLanes:e,cachePool:null,transitions:null}}function dd(e,t,n){var i=t.pendingProps,r=te.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),J(te,r&1),e===null)return mo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=i.children,e=i.fallback,s?(i=t.mode,s=t.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=ts(o,i,0,null),e=on(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Co(n),t.memoizedState=xo,e):Ea(t,o));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return op(e,t,o,i,a,r,n);if(s){s=i.fallback,o=t.mode,r=e.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=Ht(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Ht(a,s):(s=on(s,o,n,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,o=e.child.memoizedState,o=o===null?Co(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=xo,i}return s=e.child,e=s.sibling,i=Ht(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ea(e,t){return t=ts({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function tr(e,t,n,i){return i!==null&&da(i),zn(t,e.child,null,n),e=Ea(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function op(e,t,n,i,r,s,o){if(n)return t.flags&256?(t.flags&=-257,i=Ls(Error(x(422))),tr(e,t,o,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,r=t.mode,i=ts({mode:"visible",children:i.children},r,0,null),s=on(s,r,o,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&zn(t,e.child,null,o),t.child.memoizedState=Co(o),t.memoizedState=xo,s);if(!(t.mode&1))return tr(e,t,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(x(419)),i=Ls(s,i,void 0),tr(e,t,o,i)}if(a=(o&e.childLanes)!==0,Ne||a){if(i=ge,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Tt(e,r),ot(i,e,r,-1))}return Aa(),i=Ls(Error(x(421))),tr(e,t,o,i)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=yp.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,Ue=$t(r.nextSibling),Fe=t,Z=!0,it=null,e!==null&&(He[Be++]=wt,He[Be++]=xt,He[Be++]=un,wt=e.id,xt=e.overflow,un=t),t=Ea(t,i.children),t.flags|=4096,t)}function $l(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),go(e.return,t,n)}function js(e,t,n,i,r){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function hd(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Ee(e,t,i.children,n),i=te.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$l(e,n,t);else if(e.tag===19)$l(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(J(te,i),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&jr(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),js(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&jr(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}js(t,!0,n,null,s);break;case"together":js(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function fr(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Pt(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),dn|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(x(153));if(t.child!==null){for(e=t.child,n=Ht(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ht(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function ap(e,t,n){switch(t.tag){case 3:cd(t),$n();break;case 5:Uc(t);break;case 1:Le(t.type)&&Ir(t);break;case 4:va(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;J(Nr,i._currentValue),i._currentValue=r;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(J(te,te.current&1),t.flags|=128,null):n&t.child.childLanes?dd(e,t,n):(J(te,te.current&1),e=Pt(e,t,n),e!==null?e.sibling:null);J(te,te.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return hd(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),J(te,te.current),i)break;return null;case 22:case 23:return t.lanes=0,ld(e,t,n)}return Pt(e,t,n)}var fd,ko,pd,md;fd=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ko=function(){};pd=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,nn(pt.current);var s=null;switch(n){case"input":r=Bs(e,r),i=Bs(e,i),s=[];break;case"select":r=ie({},r,{value:void 0}),i=ie({},i,{value:void 0}),s=[];break;case"textarea":r=Js(e,r),i=Js(e,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Pr)}qs(n,i);var o;n=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(vi.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(vi.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&q("scroll",e),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};md=function(e,t,n,i){n!==i&&(t.flags|=4)};function ti(e,t){if(!Z)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function we(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function lp(e,t,n){var i=t.pendingProps;switch(ca(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return we(t),null;case 1:return Le(t.type)&&br(),we(t),null;case 3:return i=t.stateNode,Vn(),Y(De),Y(ke),ya(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Zi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,it!==null&&(No(it),it=null))),ko(e,t),we(t),null;case 5:_a(t);var r=nn(Ii.current);if(n=t.type,e!==null&&t.stateNode!=null)pd(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(x(166));return we(t),null}if(e=nn(pt.current),Zi(t)){i=t.stateNode,n=t.type;var s=t.memoizedProps;switch(i[ht]=t,i[Pi]=s,e=(t.mode&1)!==0,n){case"dialog":q("cancel",i),q("close",i);break;case"iframe":case"object":case"embed":q("load",i);break;case"video":case"audio":for(r=0;r<oi.length;r++)q(oi[r],i);break;case"source":q("error",i);break;case"img":case"image":case"link":q("error",i),q("load",i);break;case"details":q("toggle",i);break;case"input":Ka(i,s),q("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},q("invalid",i);break;case"textarea":Ya(i,s),q("invalid",i)}qs(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Xi(i.textContent,a,e),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Xi(i.textContent,a,e),r=["children",""+a]):vi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&q("scroll",i)}switch(n){case"input":Hi(i),qa(i,s,!0);break;case"textarea":Hi(i),Xa(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Pr)}i=r,t.updateQueue=i,i!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Wu(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=o.createElement(n,{is:i.is}):(e=o.createElement(n),n==="select"&&(o=e,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):e=o.createElementNS(e,n),e[ht]=t,e[Pi]=i,fd(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ys(n,i),n){case"dialog":q("cancel",e),q("close",e),r=i;break;case"iframe":case"object":case"embed":q("load",e),r=i;break;case"video":case"audio":for(r=0;r<oi.length;r++)q(oi[r],e);r=i;break;case"source":q("error",e),r=i;break;case"img":case"image":case"link":q("error",e),q("load",e),r=i;break;case"details":q("toggle",e),r=i;break;case"input":Ka(e,i),r=Bs(e,i),q("invalid",e);break;case"option":r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=ie({},i,{value:void 0}),q("invalid",e);break;case"textarea":Ya(e,i),r=Js(e,i),q("invalid",e);break;default:r=i}qs(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Gu(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Hu(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&_i(e,l):typeof l=="number"&&_i(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(vi.hasOwnProperty(s)?l!=null&&s==="onScroll"&&q("scroll",e):l!=null&&Ko(e,s,l,o))}switch(n){case"input":Hi(e),qa(e,i,!1);break;case"textarea":Hi(e),Xa(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Bt(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?Rn(e,!!i.multiple,s,!1):i.defaultValue!=null&&Rn(e,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=Pr)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return we(t),null;case 6:if(e&&t.stateNode!=null)md(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(x(166));if(n=nn(Ii.current),nn(pt.current),Zi(t)){if(i=t.stateNode,n=t.memoizedProps,i[ht]=t,(s=i.nodeValue!==n)&&(e=Fe,e!==null))switch(e.tag){case 3:Xi(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xi(i.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[ht]=t,t.stateNode=i}return we(t),null;case 13:if(Y(te),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Z&&Ue!==null&&t.mode&1&&!(t.flags&128))Dc(),$n(),t.flags|=98560,s=!1;else if(s=Zi(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(x(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(x(317));s[ht]=t}else $n(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;we(t),s=!1}else it!==null&&(No(it),it=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||te.current&1?de===0&&(de=3):Aa())),t.updateQueue!==null&&(t.flags|=4),we(t),null);case 4:return Vn(),ko(e,t),e===null&&Ei(t.stateNode.containerInfo),we(t),null;case 10:return pa(t.type._context),we(t),null;case 17:return Le(t.type)&&br(),we(t),null;case 19:if(Y(te),s=t.memoizedState,s===null)return we(t),null;if(i=(t.flags&128)!==0,o=s.rendering,o===null)if(i)ti(s,!1);else{if(de!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=jr(e),o!==null){for(t.flags|=128,ti(s,!1),i=o.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)s=n,e=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return J(te,te.current&1|2),t.child}e=e.sibling}s.tail!==null&&oe()>Hn&&(t.flags|=128,i=!0,ti(s,!1),t.lanes=4194304)}else{if(!i)if(e=jr(o),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ti(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Z)return we(t),null}else 2*oe()-s.renderingStartTime>Hn&&n!==1073741824&&(t.flags|=128,i=!0,ti(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=oe(),t.sibling=null,n=te.current,J(te,i?n&1|2:n&1),t):(we(t),null);case 22:case 23:return Ra(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?Oe&1073741824&&(we(t),t.subtreeFlags&6&&(t.flags|=8192)):we(t),null;case 24:return null;case 25:return null}throw Error(x(156,t.tag))}function up(e,t){switch(ca(t),t.tag){case 1:return Le(t.type)&&br(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Vn(),Y(De),Y(ke),ya(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _a(t),null;case 13:if(Y(te),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(x(340));$n()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Y(te),null;case 4:return Vn(),null;case 10:return pa(t.type._context),null;case 22:case 23:return Ra(),null;case 24:return null;default:return null}}var nr=!1,Ce=!1,cp=typeof WeakSet=="function"?WeakSet:Set,A=null;function bn(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){re(e,t,i)}else n.current=null}function Eo(e,t,n){try{n()}catch(i){re(e,t,i)}}var zl=!1;function dp(e,t){if(ao=kr,e=Sc(),la(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,d=e,h=null;t:for(;;){for(var v;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(v=d.firstChild)!==null;)h=d,d=v;for(;;){if(d===e)break t;if(h===n&&++u===r&&(a=o),h===s&&++c===i&&(l=o),(v=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(lo={focusedElem:e,selectionRange:n},kr=!1,A=t;A!==null;)if(t=A,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,A=e;else for(;A!==null;){t=A;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var _=y.memoizedProps,I=y.memoizedState,f=t.stateNode,m=f.getSnapshotBeforeUpdate(t.elementType===t.type?_:et(t.type,_),I);f.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(x(163))}}catch(S){re(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,A=e;break}A=t.return}return y=zl,zl=!1,y}function fi(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,s!==void 0&&Eo(t,n,s)}r=r.next}while(r!==i)}}function Zr(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function To(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function gd(e){var t=e.alternate;t!==null&&(e.alternate=null,gd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ht],delete t[Pi],delete t[ho],delete t[Qf],delete t[Jf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function vd(e){return e.tag===5||e.tag===3||e.tag===4}function Vl(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||vd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Po(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Pr));else if(i!==4&&(e=e.child,e!==null))for(Po(e,t,n),e=e.sibling;e!==null;)Po(e,t,n),e=e.sibling}function bo(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(bo(e,t,n),e=e.sibling;e!==null;)bo(e,t,n),e=e.sibling}var ve=null,nt=!1;function Rt(e,t,n){for(n=n.child;n!==null;)_d(e,t,n),n=n.sibling}function _d(e,t,n){if(ft&&typeof ft.onCommitFiberUnmount=="function")try{ft.onCommitFiberUnmount(Br,n)}catch{}switch(n.tag){case 5:Ce||bn(n,t);case 6:var i=ve,r=nt;ve=null,Rt(e,t,n),ve=i,nt=r,ve!==null&&(nt?(e=ve,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ve.removeChild(n.stateNode));break;case 18:ve!==null&&(nt?(e=ve,n=n.stateNode,e.nodeType===8?bs(e.parentNode,n):e.nodeType===1&&bs(e,n),xi(e)):bs(ve,n.stateNode));break;case 4:i=ve,r=nt,ve=n.stateNode.containerInfo,nt=!0,Rt(e,t,n),ve=i,nt=r;break;case 0:case 11:case 14:case 15:if(!Ce&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Eo(n,t,o),r=r.next}while(r!==i)}Rt(e,t,n);break;case 1:if(!Ce&&(bn(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){re(n,t,a)}Rt(e,t,n);break;case 21:Rt(e,t,n);break;case 22:n.mode&1?(Ce=(i=Ce)||n.memoizedState!==null,Rt(e,t,n),Ce=i):Rt(e,t,n);break;default:Rt(e,t,n)}}function Wl(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new cp),t.forEach(function(i){var r=Sp.bind(null,e,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Xe(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:ve=a.stateNode,nt=!1;break e;case 3:ve=a.stateNode.containerInfo,nt=!0;break e;case 4:ve=a.stateNode.containerInfo,nt=!0;break e}a=a.return}if(ve===null)throw Error(x(160));_d(s,o,r),ve=null,nt=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){re(r,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)yd(t,e),t=t.sibling}function yd(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Xe(t,e),ct(e),i&4){try{fi(3,e,e.return),Zr(3,e)}catch(_){re(e,e.return,_)}try{fi(5,e,e.return)}catch(_){re(e,e.return,_)}}break;case 1:Xe(t,e),ct(e),i&512&&n!==null&&bn(n,n.return);break;case 5:if(Xe(t,e),ct(e),i&512&&n!==null&&bn(n,n.return),e.flags&32){var r=e.stateNode;try{_i(r,"")}catch(_){re(e,e.return,_)}}if(i&4&&(r=e.stateNode,r!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&zu(r,s),Ys(a,o);var u=Ys(a,s);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?Gu(r,d):c==="dangerouslySetInnerHTML"?Hu(r,d):c==="children"?_i(r,d):Ko(r,c,d,u)}switch(a){case"input":Gs(r,s);break;case"textarea":Vu(r,s);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Rn(r,!!s.multiple,v,!1):h!==!!s.multiple&&(s.defaultValue!=null?Rn(r,!!s.multiple,s.defaultValue,!0):Rn(r,!!s.multiple,s.multiple?[]:"",!1))}r[Pi]=s}catch(_){re(e,e.return,_)}}break;case 6:if(Xe(t,e),ct(e),i&4){if(e.stateNode===null)throw Error(x(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(_){re(e,e.return,_)}}break;case 3:if(Xe(t,e),ct(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{xi(t.containerInfo)}catch(_){re(e,e.return,_)}break;case 4:Xe(t,e),ct(e);break;case 13:Xe(t,e),ct(e),r=e.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(ba=oe())),i&4&&Wl(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(Ce=(u=Ce)||c,Xe(t,e),Ce=u):Xe(t,e),ct(e),i&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(A=e,c=e.child;c!==null;){for(d=A=c;A!==null;){switch(h=A,v=h.child,h.tag){case 0:case 11:case 14:case 15:fi(4,h,h.return);break;case 1:bn(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){i=h,n=h.return;try{t=i,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(_){re(i,n,_)}}break;case 5:bn(h,h.return);break;case 22:if(h.memoizedState!==null){Bl(d);continue}}v!==null?(v.return=h,A=v):Bl(d)}c=c.sibling}e:for(c=null,d=e;;){if(d.tag===5){if(c===null){c=d;try{r=d.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Bu("display",o))}catch(_){re(e,e.return,_)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(_){re(e,e.return,_)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Xe(t,e),ct(e),i&4&&Wl(e);break;case 21:break;default:Xe(t,e),ct(e)}}function ct(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(vd(n)){var i=n;break e}n=n.return}throw Error(x(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(_i(r,""),i.flags&=-33);var s=Vl(e);bo(e,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=Vl(e);Po(e,a,o);break;default:throw Error(x(161))}}catch(l){re(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function hp(e,t,n){A=e,Sd(e)}function Sd(e,t,n){for(var i=(e.mode&1)!==0;A!==null;){var r=A,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||nr;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Ce;a=nr;var u=Ce;if(nr=o,(Ce=l)&&!u)for(A=r;A!==null;)o=A,l=o.child,o.tag===22&&o.memoizedState!==null?Gl(r):l!==null?(l.return=o,A=l):Gl(r);for(;s!==null;)A=s,Sd(s),s=s.sibling;A=r,nr=a,Ce=u}Hl(e)}else r.subtreeFlags&8772&&s!==null?(s.return=r,A=s):Hl(e)}}function Hl(e){for(;A!==null;){var t=A;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ce||Zr(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Ce)if(n===null)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:et(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&bl(t,s,i);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bl(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&xi(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(x(163))}Ce||t.flags&512&&To(t)}catch(h){re(t,t.return,h)}}if(t===e){A=null;break}if(n=t.sibling,n!==null){n.return=t.return,A=n;break}A=t.return}}function Bl(e){for(;A!==null;){var t=A;if(t===e){A=null;break}var n=t.sibling;if(n!==null){n.return=t.return,A=n;break}A=t.return}}function Gl(e){for(;A!==null;){var t=A;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Zr(4,t)}catch(l){re(t,n,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var r=t.return;try{i.componentDidMount()}catch(l){re(t,r,l)}}var s=t.return;try{To(t)}catch(l){re(t,s,l)}break;case 5:var o=t.return;try{To(t)}catch(l){re(t,o,l)}}}catch(l){re(t,t.return,l)}if(t===e){A=null;break}var a=t.sibling;if(a!==null){a.return=t.return,A=a;break}A=t.return}}var fp=Math.ceil,Ur=It.ReactCurrentDispatcher,Ta=It.ReactCurrentOwner,Qe=It.ReactCurrentBatchConfig,z=0,ge=null,ae=null,_e=0,Oe=0,In=Jt(0),de=0,Di=null,dn=0,es=0,Pa=0,pi=null,Ae=null,ba=0,Hn=1/0,_t=null,Fr=!1,Io=null,Vt=null,ir=!1,Mt=null,$r=0,mi=0,Ro=null,pr=-1,mr=0;function Pe(){return z&6?oe():pr!==-1?pr:pr=oe()}function Wt(e){return e.mode&1?z&2&&_e!==0?_e&-_e:qf.transition!==null?(mr===0&&(mr=rc()),mr):(e=B,e!==0||(e=window.event,e=e===void 0?16:dc(e.type)),e):1}function ot(e,t,n,i){if(50<mi)throw mi=0,Ro=null,Error(x(185));Mi(e,n,i),(!(z&2)||e!==ge)&&(e===ge&&(!(z&2)&&(es|=n),de===4&&Lt(e,_e)),je(e,i),n===1&&z===0&&!(t.mode&1)&&(Hn=oe()+500,qr&&Kt()))}function je(e,t){var n=e.callbackNode;Kh(e,t);var i=Cr(e,e===ge?_e:0);if(i===0)n!==null&&tl(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&tl(n),t===1)e.tag===0?Kf(Ql.bind(null,e)):Rc(Ql.bind(null,e)),Bf(function(){!(z&6)&&Kt()}),n=null;else{switch(sc(i)){case 1:n=ea;break;case 4:n=nc;break;case 16:n=xr;break;case 536870912:n=ic;break;default:n=xr}n=bd(n,wd.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function wd(e,t){if(pr=-1,mr=0,z&6)throw Error(x(327));var n=e.callbackNode;if(jn()&&e.callbackNode!==n)return null;var i=Cr(e,e===ge?_e:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=zr(e,i);else{t=i;var r=z;z|=2;var s=Cd();(ge!==e||_e!==t)&&(_t=null,Hn=oe()+500,sn(e,t));do try{gp();break}catch(a){xd(e,a)}while(!0);fa(),Ur.current=s,z=r,ae!==null?t=0:(ge=null,_e=0,t=de)}if(t!==0){if(t===2&&(r=no(e),r!==0&&(i=r,t=Ao(e,r))),t===1)throw n=Di,sn(e,0),Lt(e,i),je(e,oe()),n;if(t===6)Lt(e,i);else{if(r=e.current.alternate,!(i&30)&&!pp(r)&&(t=zr(e,i),t===2&&(s=no(e),s!==0&&(i=s,t=Ao(e,s))),t===1))throw n=Di,sn(e,0),Lt(e,i),je(e,oe()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(x(345));case 2:Zt(e,Ae,_t);break;case 3:if(Lt(e,i),(i&130023424)===i&&(t=ba+500-oe(),10<t)){if(Cr(e,0)!==0)break;if(r=e.suspendedLanes,(r&i)!==i){Pe(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=co(Zt.bind(null,e,Ae,_t),t);break}Zt(e,Ae,_t);break;case 4:if(Lt(e,i),(i&4194240)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-st(i);s=1<<o,o=t[o],o>r&&(r=o),i&=~s}if(i=r,i=oe()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*fp(i/1960))-i,10<i){e.timeoutHandle=co(Zt.bind(null,e,Ae,_t),i);break}Zt(e,Ae,_t);break;case 5:Zt(e,Ae,_t);break;default:throw Error(x(329))}}}return je(e,oe()),e.callbackNode===n?wd.bind(null,e):null}function Ao(e,t){var n=pi;return e.current.memoizedState.isDehydrated&&(sn(e,t).flags|=256),e=zr(e,t),e!==2&&(t=Ae,Ae=n,t!==null&&No(t)),e}function No(e){Ae===null?Ae=e:Ae.push.apply(Ae,e)}function pp(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!lt(s(),r))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Lt(e,t){for(t&=~Pa,t&=~es,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),i=1<<n;e[n]=-1,t&=~i}}function Ql(e){if(z&6)throw Error(x(327));jn();var t=Cr(e,0);if(!(t&1))return je(e,oe()),null;var n=zr(e,t);if(e.tag!==0&&n===2){var i=no(e);i!==0&&(t=i,n=Ao(e,i))}if(n===1)throw n=Di,sn(e,0),Lt(e,t),je(e,oe()),n;if(n===6)throw Error(x(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Zt(e,Ae,_t),je(e,oe()),null}function Ia(e,t){var n=z;z|=1;try{return e(t)}finally{z=n,z===0&&(Hn=oe()+500,qr&&Kt())}}function hn(e){Mt!==null&&Mt.tag===0&&!(z&6)&&jn();var t=z;z|=1;var n=Qe.transition,i=B;try{if(Qe.transition=null,B=1,e)return e()}finally{B=i,Qe.transition=n,z=t,!(z&6)&&Kt()}}function Ra(){Oe=In.current,Y(In)}function sn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Hf(n)),ae!==null)for(n=ae.return;n!==null;){var i=n;switch(ca(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&br();break;case 3:Vn(),Y(De),Y(ke),ya();break;case 5:_a(i);break;case 4:Vn();break;case 13:Y(te);break;case 19:Y(te);break;case 10:pa(i.type._context);break;case 22:case 23:Ra()}n=n.return}if(ge=e,ae=e=Ht(e.current,null),_e=Oe=t,de=0,Di=null,Pa=es=dn=0,Ae=pi=null,tn!==null){for(t=0;t<tn.length;t++)if(n=tn[t],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}tn=null}return e}function xd(e,t){do{var n=ae;try{if(fa(),dr.current=Or,Mr){for(var i=ne.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Mr=!1}if(cn=0,pe=ue=ne=null,hi=!1,Ri=0,Ta.current=null,n===null||n.return===null){de=1,Di=t,ae=null;break}e:{var s=e,o=n.return,a=n,l=t;if(t=_e,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var v=Ll(o);if(v!==null){v.flags&=-257,jl(v,o,a,s,t),v.mode&1&&Dl(s,u,t),t=v,l=u;var y=t.updateQueue;if(y===null){var _=new Set;_.add(l),t.updateQueue=_}else y.add(l);break e}else{if(!(t&1)){Dl(s,u,t),Aa();break e}l=Error(x(426))}}else if(Z&&a.mode&1){var I=Ll(o);if(I!==null){!(I.flags&65536)&&(I.flags|=256),jl(I,o,a,s,t),da(Wn(l,a));break e}}s=l=Wn(l,a),de!==4&&(de=2),pi===null?pi=[s]:pi.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var f=sd(s,l,t);Pl(s,f);break e;case 1:a=l;var m=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof m.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Vt===null||!Vt.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=od(s,a,t);Pl(s,S);break e}}s=s.return}while(s!==null)}Ed(n)}catch(C){t=C,ae===n&&n!==null&&(ae=n=n.return);continue}break}while(!0)}function Cd(){var e=Ur.current;return Ur.current=Or,e===null?Or:e}function Aa(){(de===0||de===3||de===2)&&(de=4),ge===null||!(dn&268435455)&&!(es&268435455)||Lt(ge,_e)}function zr(e,t){var n=z;z|=2;var i=Cd();(ge!==e||_e!==t)&&(_t=null,sn(e,t));do try{mp();break}catch(r){xd(e,r)}while(!0);if(fa(),z=n,Ur.current=i,ae!==null)throw Error(x(261));return ge=null,_e=0,de}function mp(){for(;ae!==null;)kd(ae)}function gp(){for(;ae!==null&&!$h();)kd(ae)}function kd(e){var t=Pd(e.alternate,e,Oe);e.memoizedProps=e.pendingProps,t===null?Ed(e):ae=t,Ta.current=null}function Ed(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=up(n,t),n!==null){n.flags&=32767,ae=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{de=6,ae=null;return}}else if(n=lp(n,t,Oe),n!==null){ae=n;return}if(t=t.sibling,t!==null){ae=t;return}ae=t=e}while(t!==null);de===0&&(de=5)}function Zt(e,t,n){var i=B,r=Qe.transition;try{Qe.transition=null,B=1,vp(e,t,n,i)}finally{Qe.transition=r,B=i}return null}function vp(e,t,n,i){do jn();while(Mt!==null);if(z&6)throw Error(x(327));n=e.finishedWork;var r=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(x(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(qh(e,s),e===ge&&(ae=ge=null,_e=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ir||(ir=!0,bd(xr,function(){return jn(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Qe.transition,Qe.transition=null;var o=B;B=1;var a=z;z|=4,Ta.current=null,dp(e,n),yd(n,e),Of(lo),kr=!!ao,lo=ao=null,e.current=n,hp(n),zh(),z=a,B=o,Qe.transition=s}else e.current=n;if(ir&&(ir=!1,Mt=e,$r=r),s=e.pendingLanes,s===0&&(Vt=null),Hh(n.stateNode),je(e,oe()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Fr)throw Fr=!1,e=Io,Io=null,e;return $r&1&&e.tag!==0&&jn(),s=e.pendingLanes,s&1?e===Ro?mi++:(mi=0,Ro=e):mi=0,Kt(),null}function jn(){if(Mt!==null){var e=sc($r),t=Qe.transition,n=B;try{if(Qe.transition=null,B=16>e?16:e,Mt===null)var i=!1;else{if(e=Mt,Mt=null,$r=0,z&6)throw Error(x(331));var r=z;for(z|=4,A=e.current;A!==null;){var s=A,o=s.child;if(A.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(A=u;A!==null;){var c=A;switch(c.tag){case 0:case 11:case 15:fi(8,c,s)}var d=c.child;if(d!==null)d.return=c,A=d;else for(;A!==null;){c=A;var h=c.sibling,v=c.return;if(gd(c),c===u){A=null;break}if(h!==null){h.return=v,A=h;break}A=v}}}var y=s.alternate;if(y!==null){var _=y.child;if(_!==null){y.child=null;do{var I=_.sibling;_.sibling=null,_=I}while(_!==null)}}A=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,A=o;else e:for(;A!==null;){if(s=A,s.flags&2048)switch(s.tag){case 0:case 11:case 15:fi(9,s,s.return)}var f=s.sibling;if(f!==null){f.return=s.return,A=f;break e}A=s.return}}var m=e.current;for(A=m;A!==null;){o=A;var g=o.child;if(o.subtreeFlags&2064&&g!==null)g.return=o,A=g;else e:for(o=m;A!==null;){if(a=A,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Zr(9,a)}}catch(C){re(a,a.return,C)}if(a===o){A=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,A=S;break e}A=a.return}}if(z=r,Kt(),ft&&typeof ft.onPostCommitFiberRoot=="function")try{ft.onPostCommitFiberRoot(Br,e)}catch{}i=!0}return i}finally{B=n,Qe.transition=t}}return!1}function Jl(e,t,n){t=Wn(n,t),t=sd(e,t,1),e=zt(e,t,1),t=Pe(),e!==null&&(Mi(e,1,t),je(e,t))}function re(e,t,n){if(e.tag===3)Jl(e,e,n);else for(;t!==null;){if(t.tag===3){Jl(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Vt===null||!Vt.has(i))){e=Wn(n,e),e=od(t,e,1),t=zt(t,e,1),e=Pe(),t!==null&&(Mi(t,1,e),je(t,e));break}}t=t.return}}function _p(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=Pe(),e.pingedLanes|=e.suspendedLanes&n,ge===e&&(_e&n)===n&&(de===4||de===3&&(_e&130023424)===_e&&500>oe()-ba?sn(e,0):Pa|=n),je(e,t)}function Td(e,t){t===0&&(e.mode&1?(t=Qi,Qi<<=1,!(Qi&130023424)&&(Qi=4194304)):t=1);var n=Pe();e=Tt(e,t),e!==null&&(Mi(e,t,n),je(e,n))}function yp(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Td(e,n)}function Sp(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(x(314))}i!==null&&i.delete(t),Td(e,n)}var Pd;Pd=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||De.current)Ne=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ne=!1,ap(e,t,n);Ne=!!(e.flags&131072)}else Ne=!1,Z&&t.flags&1048576&&Ac(t,Ar,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;fr(e,t),e=t.pendingProps;var r=Fn(t,ke.current);Ln(t,n),r=wa(null,t,i,e,r,n);var s=xa();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Le(i)?(s=!0,Ir(t)):s=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,ga(t),r.updater=Xr,t.stateNode=r,r._reactInternals=t,_o(t,i,e,n),t=wo(null,t,i,!0,s,n)):(t.tag=0,Z&&s&&ua(t),Ee(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(fr(e,t),e=t.pendingProps,r=i._init,i=r(i._payload),t.type=i,r=t.tag=xp(i),e=et(i,e),r){case 0:t=So(null,t,i,e,n);break e;case 1:t=Ul(null,t,i,e,n);break e;case 11:t=Ml(null,t,i,e,n);break e;case 14:t=Ol(null,t,i,et(i.type,e),n);break e}throw Error(x(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:et(i,r),So(e,t,i,r,n);case 1:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:et(i,r),Ul(e,t,i,r,n);case 3:e:{if(cd(t),e===null)throw Error(x(387));i=t.pendingProps,s=t.memoizedState,r=s.element,Oc(e,t),Lr(t,i,null,n);var o=t.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){r=Wn(Error(x(423)),t),t=Fl(e,t,i,n,r);break e}else if(i!==r){r=Wn(Error(x(424)),t),t=Fl(e,t,i,n,r);break e}else for(Ue=$t(t.stateNode.containerInfo.firstChild),Fe=t,Z=!0,it=null,n=jc(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($n(),i===r){t=Pt(e,t,n);break e}Ee(e,t,i,n)}t=t.child}return t;case 5:return Uc(t),e===null&&mo(t),i=t.type,r=t.pendingProps,s=e!==null?e.memoizedProps:null,o=r.children,uo(i,r)?o=null:s!==null&&uo(i,s)&&(t.flags|=32),ud(e,t),Ee(e,t,o,n),t.child;case 6:return e===null&&mo(t),null;case 13:return dd(e,t,n);case 4:return va(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=zn(t,null,i,n):Ee(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:et(i,r),Ml(e,t,i,r,n);case 7:return Ee(e,t,t.pendingProps,n),t.child;case 8:return Ee(e,t,t.pendingProps.children,n),t.child;case 12:return Ee(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,J(Nr,i._currentValue),i._currentValue=o,s!==null)if(lt(s.value,o)){if(s.children===r.children&&!De.current){t=Pt(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Ct(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),go(s.return,n,t),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(x(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),go(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ee(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ln(t,n),r=Ke(r),i=i(r),t.flags|=1,Ee(e,t,i,n),t.child;case 14:return i=t.type,r=et(i,t.pendingProps),r=et(i.type,r),Ol(e,t,i,r,n);case 15:return ad(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:et(i,r),fr(e,t),t.tag=1,Le(i)?(e=!0,Ir(t)):e=!1,Ln(t,n),rd(t,i,r),_o(t,i,r,n),wo(null,t,i,!0,e,n);case 19:return hd(e,t,n);case 22:return ld(e,t,n)}throw Error(x(156,t.tag))};function bd(e,t){return tc(e,t)}function wp(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ge(e,t,n,i){return new wp(e,t,n,i)}function Na(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xp(e){if(typeof e=="function")return Na(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Yo)return 11;if(e===Xo)return 14}return 2}function Ht(e,t){var n=e.alternate;return n===null?(n=Ge(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function gr(e,t,n,i,r,s){var o=2;if(i=e,typeof e=="function")Na(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case yn:return on(n.children,r,s,t);case qo:o=8,r|=8;break;case zs:return e=Ge(12,n,t,r|2),e.elementType=zs,e.lanes=s,e;case Vs:return e=Ge(13,n,t,r),e.elementType=Vs,e.lanes=s,e;case Ws:return e=Ge(19,n,t,r),e.elementType=Ws,e.lanes=s,e;case Uu:return ts(n,r,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Mu:o=10;break e;case Ou:o=9;break e;case Yo:o=11;break e;case Xo:o=14;break e;case At:o=16,i=null;break e}throw Error(x(130,e==null?e:typeof e,""))}return t=Ge(o,n,t,r),t.elementType=e,t.type=i,t.lanes=s,t}function on(e,t,n,i){return e=Ge(7,e,i,t),e.lanes=n,e}function ts(e,t,n,i){return e=Ge(22,e,i,t),e.elementType=Uu,e.lanes=n,e.stateNode={isHidden:!1},e}function Ms(e,t,n){return e=Ge(6,e,null,t),e.lanes=n,e}function Os(e,t,n){return t=Ge(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Cp(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vs(0),this.expirationTimes=vs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vs(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Da(e,t,n,i,r,s,o,a,l){return e=new Cp(e,t,n,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ge(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ga(s),e}function kp(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_n,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function Id(e){if(!e)return Gt;e=e._reactInternals;e:{if(pn(e)!==e||e.tag!==1)throw Error(x(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Le(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(x(171))}if(e.tag===1){var n=e.type;if(Le(n))return Ic(e,n,t)}return t}function Rd(e,t,n,i,r,s,o,a,l){return e=Da(n,i,!0,e,r,s,o,a,l),e.context=Id(null),n=e.current,i=Pe(),r=Wt(n),s=Ct(i,r),s.callback=t??null,zt(n,s,r),e.current.lanes=r,Mi(e,r,i),je(e,i),e}function ns(e,t,n,i){var r=t.current,s=Pe(),o=Wt(r);return n=Id(n),t.context===null?t.context=n:t.pendingContext=n,t=Ct(s,o),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=zt(r,t,o),e!==null&&(ot(e,r,o,s),cr(e,r,o)),o}function Vr(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Kl(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function La(e,t){Kl(e,t),(e=e.alternate)&&Kl(e,t)}function Ep(){return null}var Ad=typeof reportError=="function"?reportError:function(e){console.error(e)};function ja(e){this._internalRoot=e}is.prototype.render=ja.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(x(409));ns(e,t,null,null)};is.prototype.unmount=ja.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hn(function(){ns(null,e,null,null)}),t[Et]=null}};function is(e){this._internalRoot=e}is.prototype.unstable_scheduleHydration=function(e){if(e){var t=lc();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&t!==0&&t<Dt[n].priority;n++);Dt.splice(n,0,e),n===0&&cc(e)}};function Ma(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function rs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ql(){}function Tp(e,t,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=Vr(o);s.call(u)}}var o=Rd(t,i,e,0,null,!1,!1,"",ql);return e._reactRootContainer=o,e[Et]=o.current,Ei(e.nodeType===8?e.parentNode:e),hn(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=Vr(l);a.call(u)}}var l=Da(e,0,!1,null,null,!1,!1,"",ql);return e._reactRootContainer=l,e[Et]=l.current,Ei(e.nodeType===8?e.parentNode:e),hn(function(){ns(t,l,n,i)}),l}function ss(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=Vr(o);a.call(l)}}ns(t,o,e,r)}else o=Tp(n,t,e,r,i);return Vr(o)}oc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=si(t.pendingLanes);n!==0&&(ta(t,n|1),je(t,oe()),!(z&6)&&(Hn=oe()+500,Kt()))}break;case 13:hn(function(){var i=Tt(e,1);if(i!==null){var r=Pe();ot(i,e,1,r)}}),La(e,1)}};na=function(e){if(e.tag===13){var t=Tt(e,134217728);if(t!==null){var n=Pe();ot(t,e,134217728,n)}La(e,134217728)}};ac=function(e){if(e.tag===13){var t=Wt(e),n=Tt(e,t);if(n!==null){var i=Pe();ot(n,e,t,i)}La(e,t)}};lc=function(){return B};uc=function(e,t){var n=B;try{return B=e,t()}finally{B=n}};Zs=function(e,t,n){switch(t){case"input":if(Gs(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Kr(i);if(!r)throw Error(x(90));$u(i),Gs(i,r)}}}break;case"textarea":Vu(e,n);break;case"select":t=n.value,t!=null&&Rn(e,!!n.multiple,t,!1)}};Ku=Ia;qu=hn;var Pp={usingClientEntryPoint:!1,Events:[Ui,Cn,Kr,Qu,Ju,Ia]},ni={findFiberByHostInstance:en,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bp={bundleType:ni.bundleType,version:ni.version,rendererPackageName:ni.rendererPackageName,rendererConfig:ni.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:It.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zu(e),e===null?null:e.stateNode},findFiberByHostInstance:ni.findFiberByHostInstance||Ep,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rr.isDisabled&&rr.supportsFiber)try{Br=rr.inject(bp),ft=rr}catch{}}Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pp;Ve.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ma(t))throw Error(x(200));return kp(e,t,null,n)};Ve.createRoot=function(e,t){if(!Ma(e))throw Error(x(299));var n=!1,i="",r=Ad;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=Da(e,1,!1,null,null,n,!1,i,r),e[Et]=t.current,Ei(e.nodeType===8?e.parentNode:e),new ja(t)};Ve.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(x(188)):(e=Object.keys(e).join(","),Error(x(268,e)));return e=Zu(t),e=e===null?null:e.stateNode,e};Ve.flushSync=function(e){return hn(e)};Ve.hydrate=function(e,t,n){if(!rs(t))throw Error(x(200));return ss(null,e,t,!0,n)};Ve.hydrateRoot=function(e,t,n){if(!Ma(e))throw Error(x(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=Ad;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Rd(t,null,e,1,n??null,r,!1,s,o),e[Et]=t.current,Ei(e),i)for(e=0;e<i.length;e++)n=i[e],r=n._getVersion,r=r(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new is(t)};Ve.render=function(e,t,n){if(!rs(t))throw Error(x(200));return ss(null,e,t,!1,n)};Ve.unmountComponentAtNode=function(e){if(!rs(e))throw Error(x(40));return e._reactRootContainer?(hn(function(){ss(null,null,e,!1,function(){e._reactRootContainer=null,e[Et]=null})}),!0):!1};Ve.unstable_batchedUpdates=Ia;Ve.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!rs(n))throw Error(x(200));if(e==null||e._reactInternals===void 0)throw Error(x(38));return ss(e,t,n,!1,i)};Ve.version="18.3.1-next-f1338f8080-20240426";function Nd(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Nd)}catch(e){console.error(e)}}Nd(),Nu.exports=Ve;var Ip=Nu.exports,Yl=Ip;Fs.createRoot=Yl.createRoot,Fs.hydrateRoot=Yl.hydrateRoot;const Ze="https://recoverai-backend-7k3o2t7hcq-uc.a.run.app",rt={LOGIN:`${Ze}/token`,ANALYZE:`${Ze}/api/v1/analyze`,INGEST:`${Ze}/api/v1/ingest`,PAYMENT:`${Ze}/api/v1/payment/create`,CASES:`${Ze}/api/v1/cases`,LOG_INTERACTION:e=>`${Ze}/api/v1/cases/${e}/log_interaction`,UPDATE_STATUS:e=>`${Ze}/api/v1/cases/${e}/status`,ANALYZE_AUDIO:e=>`${Ze}/api/v1/cases/${e}/analyze_audio`,UPDATE_CONTACT:e=>`${Ze}/api/v1/cases/${e}/update_contact`,INITIATE_BRIDGE:`${Ze}/api/v1/telephony/initiate_bridge`,CREATE_CASE:`${Ze}/api/v1/cases/create`};function Rp({caseId:e,companyName:t,onClose:n,onSuccess:i}){var C;const[r,s]=j.useState(""),[o,a]=j.useState(null),[l,u]=j.useState(!1),[c,d]=j.useState(null),[h,v]=j.useState(!1),[y,_]=j.useState(""),I=async()=>{try{const k=await navigator.mediaDevices.getUserMedia({audio:!0}),E=new MediaRecorder(k),w=[];E.ondataavailable=N=>w.push(N.data),E.onstop=async()=>{const N=new Blob(w,{type:"audio/webm"});await m(N)},E.start(),d(E),u(!0),_("")}catch(k){_("Could not access microphone: "+k.message)}},f=()=>{c&&(c.stop(),u(!1),c.stream.getTracks().forEach(k=>k.stop()))},m=async k=>{v(!0);const E=new FormData;E.append("file",k,"recording.webm");try{const w=localStorage.getItem("token"),N=await fetch(rt.ANALYZE_AUDIO(e),{method:"POST",headers:{Authorization:`Bearer ${w}`},body:E});if(!N.ok)throw new Error("Audio analysis failed");const b=await N.json();s(b.analysis.transcript),a(b.analysis),setTimeout(()=>{i(),n()},3e3)}catch(w){_(w.message)}finally{v(!1)}},g=async()=>{if(!r.trim()){_("Please enter interaction text");return}v(!0),_("");try{const k=localStorage.getItem("token"),E=await fetch(rt.LOG_INTERACTION(e),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify({text:r})});if(!E.ok)throw new Error("Failed to log interaction");const w=await E.json();a(w.compliance),setTimeout(()=>{i(),n()},2e3)}catch(k){_(k.message)}finally{v(!1)}},S=k=>{switch(k){case"SAFE":return"bg-green-100 text-green-800 border-green-300";case"MODERATE":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"CRITICAL":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Log Call"}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("p",{className:"text-sm text-gray-500",children:t}),!c&&p.jsx("p",{className:"text-xs text-indigo-600 italic",children:"Call the customer manually and record the interaction below."}),l&&p.jsxs("span",{className:"flex items-center gap-1 text-xs text-red-600 font-bold animate-pulse",children:[p.jsx("span",{className:"w-2 h-2 bg-red-600 rounded-full"}),"LIVE RECORDING"]})]})]}),p.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),y&&p.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4 text-sm",children:y}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What did you say to the debtor?"}),p.jsx("textarea",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",rows:"6",value:r,onChange:k=>s(k.target.value),placeholder:'Example: "Called customer about invoice #1234. They agreed to pay by Friday."',disabled:h||o}),p.jsxs("div",{className:"flex justify-between mt-1",children:[p.jsxs("span",{className:"text-xs text-gray-500",children:[r.length," characters"]}),o&&p.jsx("span",{className:"text-xs text-green-600 font-medium",children:" Logged successfully"})]})]}),o&&p.jsxs("div",{className:`border-2 rounded-lg p-4 ${S(o.risk_level)}`,children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.jsxs("span",{className:"text-lg font-bold",children:[o.risk_level==="SAFE"&&"",o.risk_level==="MODERATE"&&"",o.risk_level==="CRITICAL"&&""]}),p.jsxs("span",{className:"font-semibold",children:[o.risk_level," Risk Level"]})]}),o.violation_flags&&o.violation_flags.length>0&&p.jsxs("div",{className:"mt-2",children:[p.jsx("p",{className:"text-sm font-medium mb-1",children:"Violations Detected:"}),p.jsx("ul",{className:"text-sm list-disc list-inside",children:o.violation_flags.map((k,E)=>p.jsx("li",{children:k},E))})]}),p.jsxs("div",{className:"mt-2 text-sm",children:[p.jsx("strong",{children:"Sentiment Score:"})," ",((C=o.sentiment_score)==null?void 0:C.toFixed(2))||"N/A"]})]}),p.jsxs("div",{className:"flex gap-3 pt-2",children:[p.jsx("button",{type:"button",onClick:n,className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition",children:o?"Close":"Cancel"}),!o&&p.jsxs(p.Fragment,{children:[l?p.jsx("button",{onClick:f,className:"flex-1 bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-black transition flex items-center justify-center gap-2",children:" Stop & Analyze"}):p.jsx("button",{onClick:I,className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition flex items-center justify-center gap-2",children:" Start Recording"}),p.jsx("button",{onClick:g,disabled:h||!r.trim()||l,className:"flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Analyzing...":"Manual Log"})]})]})]})]})})}function Ap({status:e}){const n=(i=>{const r={PENDING:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-300",icon:""},IN_PROGRESS:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-300",icon:""},UNDER_REVIEW:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-300",icon:""},RESOLVED:{bg:"bg-green-100",text:"text-green-700",border:"border-green-300",icon:""},CLOSED:{bg:"bg-slate-100",text:"text-slate-700",border:"border-slate-300",icon:""},ESCALATED:{bg:"bg-red-100",text:"text-red-700",border:"border-red-300",icon:""}};return r[i]||r.PENDING})(e);return p.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-semibold border ${n.bg} ${n.text} ${n.border}`,children:[p.jsx("span",{children:n.icon}),p.jsx("span",{children:e.replace("_"," ")})]})}function Np({caseId:e,currentStatus:t,companyName:n,onClose:i,onSuccess:r}){const[s,o]=j.useState(""),[a,l]=j.useState(""),[u,c]=j.useState(!1),[d,h]=j.useState(""),y=(f=>({PENDING:["IN_PROGRESS","CLOSED"],IN_PROGRESS:["UNDER_REVIEW","RESOLVED","CLOSED","ESCALATED"],UNDER_REVIEW:["IN_PROGRESS","RESOLVED","ESCALATED"],RESOLVED:["CLOSED"],ESCALATED:["UNDER_REVIEW","CLOSED"],CLOSED:[]})[f]||[])(t),_=async()=>{if(!s){h("Please select a new status");return}if(s==="CLOSED"&&!a.trim()){h("Please provide a reason for closing the case");return}c(!0),h("");try{const f=localStorage.getItem("token"),m=await fetch(rt.UPDATE_STATUS(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({new_status:s,reason:a.trim()||null})});if(!m.ok){const S=await m.json();throw new Error(S.detail||"Failed to update status")}const g=await m.json();setTimeout(()=>{r(),i()},1e3)}catch(f){h(f.message)}finally{c(!1)}},I=f=>({IN_PROGRESS:"Agent actively working on this case",UNDER_REVIEW:"Needs supervisor/manager review",RESOLVED:"Successfully resolved (payment received or settled)",CLOSED:"Case finalized and archived",ESCALATED:"Escalated due to compliance or other issues"})[f]||"";return p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Update Status"}),p.jsx("p",{className:"text-sm text-gray-500",children:n})]}),p.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),d&&p.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4 text-sm",children:d}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{children:p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Current Status: ",p.jsx("span",{className:"font-bold text-blue-600",children:t.replace("_"," ")})]})}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Status"}),p.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",value:s,onChange:f=>o(f.target.value),disabled:u||y.length===0,children:[p.jsx("option",{value:"",children:"-- Select Status --"}),y.map(f=>p.jsx("option",{value:f,children:f.replace("_"," ")},f))]}),s&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:I(s)}),y.length===0&&p.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["No valid transitions available from ",t]})]}),s&&p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason ",s==="CLOSED"&&p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsx("textarea",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",rows:"3",value:a,onChange:f=>l(f.target.value),placeholder:s==="CLOSED"?"Required: Why is this case being closed?":"Optional: Additional context for this change",disabled:u})]}),p.jsxs("div",{className:"flex gap-3 pt-2",children:[p.jsx("button",{type:"button",onClick:i,className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition",disabled:u,children:"Cancel"}),p.jsx("button",{onClick:_,disabled:u||!s,className:"flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Updating...":"Update Status"})]})]})]})})}const Dp=({caseData:e,onPay:t,onLogCall:n,onCall:i})=>{const[r,s]=j.useState(!1),[o,a]=j.useState(!1),[l,u]=j.useState(!1),[c,d]=j.useState(""),[h,v]=j.useState(!1),[y,_]=j.useState(null),{case_id:I,companyName:f,phone:m,amount:g,pScore:S,suggestedAction:C,riskLevel:k,violationTag:E,history:w=[],status:N="PENDING"}=e,[b,D]=j.useState(m);Ru.useEffect(()=>{D(m)},[m]);const $=async()=>{if(!c.trim()){_("Phone number cannot be empty");return}v(!0),_(null);try{const G=localStorage.getItem("token"),vt=await fetch(rt.UPDATE_CONTACT(I),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${G}`},body:JSON.stringify({phone:c})});if(vt.ok)D(c),setEditingPhone(!1),n&&n();else{const R=await vt.json();_(R.detail||"Update failed")}}catch(G){console.error("Failed to update phone",G),_("Network error. Is the backend running?")}finally{v(!1)}},he=G=>G>.8?"bg-green-50 border-l-4 border-green-500":G>.5?"bg-yellow-50 border-l-4 border-yellow-500":"bg-gray-50 border-l-4 border-gray-400",ut=G=>G.replace("ALLOCATE_","").replace("_"," "),gt=G=>{const vt={SAFE:"bg-green-100 text-green-800",MODERATE:"bg-yellow-100 text-yellow-800",CRITICAL:"bg-red-100 text-red-800",UNKNOWN:"bg-gray-100 text-gray-800"};return vt[G]||vt.UNKNOWN};return p.jsxs("div",{className:`p-4 rounded shadow-sm bg-white mb-4 ${he(S)}`,children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{className:"w-1/3",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsx("h3",{className:"font-bold text-lg text-gray-800",children:f}),b&&!editingPhone?p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{onClick:()=>{i(b),s(!0)},className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors shadow-sm",title:`Direct Browser Call to ${b}`,children:""}),p.jsx("button",{onClick:()=>{d(b),setEditingPhone(!0)},className:"text-[10px] text-gray-400 hover:text-blue-500",title:"Edit Number",children:""})]}):editingPhone?p.jsxs("div",{className:"relative",children:[p.jsxs("div",{className:`flex gap-1 items-center bg-gray-50 p-1 rounded border ${y?"border-red-500":"border-blue-100"} ${h?"opacity-50":""}`,children:[p.jsx("input",{type:"tel",autoFocus:!0,disabled:h,className:"text-xs border-none bg-transparent outline-none w-24",placeholder:"Mobile No.",value:c,onChange:G=>{d(G.target.value),_(null)},onKeyDown:G=>{G.key==="Enter"&&$(),G.key==="Escape"&&setEditingPhone(!1)}}),p.jsx("button",{onClick:$,disabled:h,className:"text-xs text-green-600 font-bold hover:scale-110 transition-transform",children:""}),p.jsx("button",{onClick:()=>setEditingPhone(!1),disabled:h,className:"text-xs text-red-400 font-bold hover:scale-110 transition-transform",children:""})]}),y&&p.jsx("div",{className:"absolute top-8 left-0 text-[9px] text-red-500 bg-white px-1 shadow-sm rounded border border-red-100 whitespace-nowrap z-10",children:y})]}):p.jsx("button",{onClick:()=>setEditingPhone(!0),className:"text-xs bg-gray-100 text-gray-500 px-2 py-1 rounded hover:bg-gray-200",title:"Add contact number",children:"+ Phone"}),p.jsx(Ap,{status:N})]}),p.jsxs("p",{className:"text-sm font-mono text-gray-600",children:["Outstanding: ",p.jsxs("span",{className:"font-semibold",children:["",g.toLocaleString()]})]}),p.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[w.length>0&&p.jsxs("button",{onClick:()=>a(!o),className:"text-xs text-indigo-600 hover:text-indigo-800",children:[o?"":""," ",w.length," interaction",w.length!==1?"s":""]}),N!=="CLOSED"&&p.jsx("button",{onClick:()=>u(!0),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:" Update Status"})]})]}),p.jsx("div",{className:"text-center w-1/3",children:p.jsxs("div",{className:"inline-block px-3 py-1 rounded bg-white border border-gray-100 shadow-sm",children:[p.jsxs("span",{className:"block text-2xl font-bold text-gray-800",children:[(S*100).toFixed(0),"%"]}),p.jsx("span",{className:"text-[10px] uppercase tracking-wide text-gray-500",children:"Prob. to Pay"})]})}),p.jsxs("div",{className:"w-1/3 text-right",children:[p.jsx("span",{className:"inline-block px-3 py-1 text-xs font-semibold tracking-wide text-indigo-800 bg-indigo-100 rounded-full mb-2",children:"Recommended Strategy"}),p.jsx("div",{className:"font-bold text-indigo-600 mb-2",children:ut(C)}),p.jsxs("div",{className:"flex gap-2 justify-end",children:[p.jsx("button",{onClick:()=>s(!0),className:"bg-purple-600 hover:bg-purple-700 text-white text-xs font-bold py-1 px-3 rounded shadow transition-colors",children:" Log Call"}),p.jsx("button",{onClick:()=>t(e),className:"bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold py-1 px-3 rounded shadow transition-colors",children:" Pay Now"})]})]})]}),o&&w.length>0&&p.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[p.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Recent Interactions"}),p.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:w.slice(0,5).map(G=>p.jsxs("div",{className:"bg-gray-50 p-2 rounded text-xs",children:[p.jsxs("div",{className:"flex justify-between items-start mb-1",children:[p.jsxs("span",{className:"text-gray-500",children:[new Date(G.date).toLocaleDateString()," ",new Date(G.date).toLocaleTimeString()]}),p.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-semibold ${gt(G.riskLevel)}`,children:G.riskLevel})]}),p.jsx("p",{className:"text-gray-700",children:G.text}),G.sentimentScore!==void 0&&p.jsxs("p",{className:"text-gray-500 mt-1",children:["Sentiment: ",G.sentimentScore.toFixed(2)]})]},G.id))})]}),p.jsxs("div",{className:"mt-4 pt-2 border-t border-gray-100 flex items-center justify-between text-xs",children:[p.jsx("div",{className:"text-gray-400",children:"AI Model: RISKON_ODE_v1.0"}),p.jsxs("div",{className:"flex items-center",children:[p.jsx("span",{className:"font-semibold mr-2 text-gray-600",children:"Sentinel Guard:"}),k==="LOW"||k==="SAFE"?p.jsx("span",{className:"text-teal-600 flex items-center font-bold",children:" COMPLIANT"}):p.jsx("span",{className:"text-red-600 flex items-center font-bold",children:" RISK DETECTED"})]})]}),r&&p.jsx(Rp,{caseId:I,companyName:f,onClose:()=>s(!1),onSuccess:()=>{s(!1),n&&n()}}),l&&p.jsx(Np,{caseId:I,currentStatus:N,companyName:f,onClose:()=>u(!1),onSuccess:()=>{u(!1),n&&n()}})]})};function Lp({onLogin:e}){const[t,n]=j.useState(""),[i,r]=j.useState(""),[s,o]=j.useState(""),[a,l]=j.useState(!1),u=async c=>{c.preventDefault(),l(!0),o("");const d=new URLSearchParams;d.append("username",t),d.append("password",i);const h=rt.LOGIN;try{const v=await fetch(h,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:d});if(!v.ok)throw new Error("Invalid credentials");const y=await v.json();e(y.access_token)}catch(v){o("Login failed: "+v.message)}finally{l(!1)}};return p.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-900",children:p.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl border border-slate-700 w-96",children:[p.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:"RecoverAI Login"}),s&&p.jsx("div",{className:"bg-red-500/20 text-red-400 p-3 rounded mb-4 text-sm text-center",children:s}),p.jsxs("form",{onSubmit:u,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-slate-400 text-sm mb-1",children:"Username"}),p.jsx("input",{type:"text",className:"w-full bg-slate-700 text-white rounded p-2 focus:outline-none focus:ring-2 focus:ring-emerald-500",value:t,onChange:c=>n(c.target.value),placeholder:"admin"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-slate-400 text-sm mb-1",children:"Password"}),p.jsx("input",{type:"password",className:"w-full bg-slate-700 text-white rounded p-2 focus:outline-none focus:ring-2 focus:ring-emerald-500",value:i,onChange:c=>r(c.target.value),placeholder:"password"})]}),p.jsx("button",{type:"submit",disabled:a,className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-2 px-4 rounded transition-colors disabled:opacity-50",children:a?"Verifying...":"Sign In"})]}),p.jsx("div",{className:"mt-4 text-center text-xs text-slate-500",children:"MVP Default: admin / password123"})]})})}function jp({onClose:e}){const[t,n]=j.useState(null),[i,r]=j.useState(null);if(j.useEffect(()=>{const o=new URLSearchParams(window.location.search),a=o.get("payment");a==="success"?(n("success"),r(o.get("case_id"))):a==="cancelled"&&n("cancelled")},[]),!t)return null;const s=()=>{window.history.pushState({},document.title,window.location.pathname),n(null),e&&e()};return p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 animate-fade-in",children:p.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full text-center border border-gray-100",children:[t==="success"&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:p.jsx("span",{className:"text-4xl",children:""})}),p.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Payment Successful!"}),p.jsxs("p",{className:"text-gray-500 mb-6",children:["Thank you for settling case ",p.jsx("span",{className:"font-mono font-bold text-gray-800",children:i||"Unknown"}),". The debt has been cleared from our records."]}),p.jsx("button",{onClick:s,className:"w-full bg-green-600 text-white font-bold py-3 px-6 rounded-xl hover:bg-green-700 transition transform hover:scale-[1.02]",children:"Return to Dashboard"})]}),t==="cancelled"&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:p.jsx("span",{className:"text-4xl",children:""})}),p.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Payment Cancelled"}),p.jsx("p",{className:"text-gray-500 mb-6",children:"The transaction was not completed. No charges were made to your card."}),p.jsx("button",{onClick:s,className:"w-full bg-gray-800 text-white font-bold py-3 px-6 rounded-xl hover:bg-gray-700 transition transform hover:scale-[1.02]",children:"Try Again"})]})]})})}function Mp({onClose:e,onSuccess:t}){const[n,i]=j.useState({company_name:"",amount:"",age_days:"",credit_score:"",phone:""}),[r,s]=j.useState(!1),[o,a]=j.useState(""),l=async u=>{u.preventDefault(),s(!0),a("");try{const c=localStorage.getItem("token"),d=await fetch(rt.CREATE_CASE,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({company_name:n.company_name,amount:parseFloat(n.amount),age_days:parseInt(n.age_days),credit_score:parseFloat(n.credit_score),phone:n.phone})});if(!d.ok)throw new Error("Failed to create case");const h=await d.json();t(h),e()}catch(c){a(c.message)}finally{s(!1)}};return p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Add New Case"}),p.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),o&&p.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4 text-sm",children:o}),p.jsxs("form",{onSubmit:l,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),p.jsx("input",{type:"text",required:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",value:n.company_name,onChange:u=>i({...n,company_name:u.target.value}),placeholder:"Acme Corp Pvt Ltd"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount ()"}),p.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",value:n.amount,onChange:u=>i({...n,amount:u.target.value}),placeholder:"150000"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age (Days Overdue)"}),p.jsx("input",{type:"number",required:!0,min:"0",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",value:n.age_days,onChange:u=>i({...n,age_days:u.target.value}),placeholder:"30"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Score (0.0 - 1.0)"}),p.jsx("input",{type:"number",required:!0,min:"0",max:"1",step:"0.01",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",value:n.credit_score,onChange:u=>i({...n,credit_score:u.target.value}),placeholder:"0.75"})]}),p.jsxs("div",{className:"flex gap-3 pt-2",children:[p.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition",children:"Cancel"}),p.jsx("button",{type:"submit",disabled:r,className:"flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition disabled:opacity-50",children:r?"Creating...":"Create Case"})]})]})]})})}var Oa={exports:{}},Mn=typeof Reflect=="object"?Reflect:null,Xl=Mn&&typeof Mn.apply=="function"?Mn.apply:function(t,n,i){return Function.prototype.apply.call(t,n,i)},vr;Mn&&typeof Mn.ownKeys=="function"?vr=Mn.ownKeys:Object.getOwnPropertySymbols?vr=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:vr=function(t){return Object.getOwnPropertyNames(t)};function Op(e){console&&console.warn&&console.warn(e)}var Dd=Number.isNaN||function(t){return t!==t};function Q(){Q.init.call(this)}Oa.exports=Q;Oa.exports.once=zp;Q.EventEmitter=Q;Q.prototype._events=void 0;Q.prototype._eventsCount=0;Q.prototype._maxListeners=void 0;var Zl=10;function os(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Q,"defaultMaxListeners",{enumerable:!0,get:function(){return Zl},set:function(e){if(typeof e!="number"||e<0||Dd(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Zl=e}});Q.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Q.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Dd(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Ld(e){return e._maxListeners===void 0?Q.defaultMaxListeners:e._maxListeners}Q.prototype.getMaxListeners=function(){return Ld(this)};Q.prototype.emit=function(t){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=t==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[t];if(l===void 0)return!1;if(typeof l=="function")Xl(l,this,n);else for(var u=l.length,c=Fd(l,u),i=0;i<u;++i)Xl(c[i],this,n);return!0};function jd(e,t,n,i){var r,s,o;if(os(n),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),o===void 0)o=s[t]=n,++e._eventsCount;else if(typeof o=="function"?o=s[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),r=Ld(e),r>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,Op(a)}return e}Q.prototype.addListener=function(t,n){return jd(this,t,n,!1)};Q.prototype.on=Q.prototype.addListener;Q.prototype.prependListener=function(t,n){return jd(this,t,n,!0)};function Up(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Md(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=Up.bind(i);return r.listener=n,i.wrapFn=r,r}Q.prototype.once=function(t,n){return os(n),this.on(t,Md(this,t,n)),this};Q.prototype.prependOnceListener=function(t,n){return os(n),this.prependListener(t,Md(this,t,n)),this};Q.prototype.removeListener=function(t,n){var i,r,s,o,a;if(os(n),r=this._events,r===void 0)return this;if(i=r[t],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,i.listener||n));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===n||i[o].listener===n){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():Fp(i,s),i.length===1&&(r[t]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",t,a||n)}return this};Q.prototype.off=Q.prototype.removeListener;Q.prototype.removeAllListeners=function(t){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[t]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(t,n[r]);return this};function Od(e,t,n){var i=e._events;if(i===void 0)return[];var r=i[t];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?$p(r):Fd(r,r.length)}Q.prototype.listeners=function(t){return Od(this,t,!0)};Q.prototype.rawListeners=function(t){return Od(this,t,!1)};Q.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Ud.call(e,t)};Q.prototype.listenerCount=Ud;function Ud(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Q.prototype.eventNames=function(){return this._eventsCount>0?vr(this._events):[]};function Fd(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function Fp(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function $p(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function zp(e,t){return new Promise(function(n,i){function r(o){e.removeListener(t,s),i(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",r),n([].slice.call(arguments))}$d(e,t,s,{once:!0}),t!=="error"&&Vp(e,r,{once:!0})})}function Vp(e,t,n){typeof e.on=="function"&&$d(e,"error",t,n)}function $d(e,t,n,i){if(typeof e.on=="function")i.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function r(s){i.once&&e.removeEventListener(t,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Ye=Oa.exports;class Do extends Ye.EventEmitter{constructor(t){super(),Object.defineProperties(this,{_attempts:{value:0,writable:!0},_duration:{enumerable:!1,get(){if(this._useInitialValue&&this._attempts===0)return this._min;let n=this._min*Math.pow(this._factor,this._attempts);if(this._jitter){const i=Math.random(),r=Math.floor(i*this._jitter*n);n=Math.floor(i*10)&1?n+r:n-r}return Math.min(n,this._max)|0}},_factor:{value:t.factor||2},_jitter:{value:t.jitter>0&&t.jitter<=1?t.jitter:0},_max:{value:t.max||1e4},_min:{value:t.min||100},_timeoutID:{value:null,writable:!0},_useInitialValue:{value:t.useInitialValue||!1}})}backoff(){const t=this._duration;this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null),this.emit("backoff",this._attempts,t),this._timeoutID=setTimeout(()=>{this.emit("ready",this._attempts,t),this._attempts++},t)}reset(){this._attempts=0,this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)}}function Te(e,t,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(d){o(d)}}function l(c){try{u(i.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(e,t||[])).next())})}var zd={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.log=n()})(nh,function(){var t=function(){},n="undefined",i=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],s={},o=null;function a(_,I){var f=_[I];if(typeof f.bind=="function")return f.bind(_);try{return Function.prototype.bind.call(f,_)}catch{return function(){return Function.prototype.apply.apply(f,[_,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(_){return _==="debug"&&(_="log"),typeof console===n?!1:_==="trace"&&i?l:console[_]!==void 0?a(console,_):console.log!==void 0?a(console,"log"):t}function c(){for(var _=this.getLevel(),I=0;I<r.length;I++){var f=r[I];this[f]=I<_?t:this.methodFactory(f,_,this.name)}if(this.log=this.debug,typeof console===n&&_<this.levels.SILENT)return"No console available for logging"}function d(_){return function(){typeof console!==n&&(c.call(this),this[_].apply(this,arguments))}}function h(_,I,f){return u(_)||d.apply(this,arguments)}function v(_,I){var f=this,m,g,S,C="loglevel";typeof _=="string"?C+=":"+_:typeof _=="symbol"&&(C=void 0);function k(D){var $=(r[D]||"silent").toUpperCase();if(!(typeof window===n||!C)){try{window.localStorage[C]=$;return}catch{}try{window.document.cookie=encodeURIComponent(C)+"="+$+";"}catch{}}}function E(){var D;if(!(typeof window===n||!C)){try{D=window.localStorage[C]}catch{}if(typeof D===n)try{var $=window.document.cookie,he=encodeURIComponent(C),ut=$.indexOf(he+"=");ut!==-1&&(D=/^([^;]+)/.exec($.slice(ut+he.length+1))[1])}catch{}return f.levels[D]===void 0&&(D=void 0),D}}function w(){if(!(typeof window===n||!C)){try{window.localStorage.removeItem(C)}catch{}try{window.document.cookie=encodeURIComponent(C)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function N(D){var $=D;if(typeof $=="string"&&f.levels[$.toUpperCase()]!==void 0&&($=f.levels[$.toUpperCase()]),typeof $=="number"&&$>=0&&$<=f.levels.SILENT)return $;throw new TypeError("log.setLevel() called with invalid level: "+D)}f.name=_,f.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},f.methodFactory=I||h,f.getLevel=function(){return S??g??m},f.setLevel=function(D,$){return S=N(D),$!==!1&&k(S),c.call(f)},f.setDefaultLevel=function(D){g=N(D),E()||f.setLevel(D,!1)},f.resetLevel=function(){S=null,w(),c.call(f)},f.enableAll=function(D){f.setLevel(f.levels.TRACE,D)},f.disableAll=function(D){f.setLevel(f.levels.SILENT,D)},f.rebuild=function(){if(o!==f&&(m=N(o.getLevel())),c.call(f),o===f)for(var D in s)s[D].rebuild()},m=N(o?o.getLevel():"WARN");var b=E();b!=null&&(S=N(b)),c.call(f)}o=new v,o.getLogger=function(I){if(typeof I!="symbol"&&typeof I!="string"||I==="")throw new TypeError("You must supply a name when creating a logger.");var f=s[I];return f||(f=s[I]=new v(I,o.methodFactory)),f};var y=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=y),o},o.getLoggers=function(){return s},o.default=o,o})})(zd);var Li=zd.exports;const Wp=yu(Li),Hp=th({__proto__:null,default:Wp},[Li]);class O extends Error{constructor(t,n){super(),Object.setPrototypeOf(this,O.prototype);const i=typeof t=="string"?t:this.explanation,r=typeof t=="object"?t:n;this.message=`${this.name} (${this.code}): ${i}`,this.originalError=r}}var le;(function(e){class t extends O{constructor(s,o){super(s,o),this.causes=[],this.code=20101,this.description="Invalid access token",this.explanation="Twilio was unable to validate your Access Token",this.name="AccessTokenInvalid",this.solutions=[],Object.setPrototypeOf(this,e.AccessTokenInvalid.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}e.AccessTokenInvalid=t;class n extends O{constructor(s,o){super(s,o),this.causes=[],this.code=20104,this.description="Access token expired or expiration date invalid",this.explanation="The Access Token provided to the Twilio API has expired, the expiration time specified in the token was invalid, or the expiration time specified was too far in the future",this.name="AccessTokenExpired",this.solutions=[],Object.setPrototypeOf(this,e.AccessTokenExpired.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}e.AccessTokenExpired=n;class i extends O{constructor(s,o){super(s,o),this.causes=[],this.code=20151,this.description="Authentication Failed",this.explanation="The Authentication with the provided JWT failed",this.name="AuthenticationFailed",this.solutions=[],Object.setPrototypeOf(this,e.AuthenticationFailed.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}e.AuthenticationFailed=i})(le||(le={}));var Lo;(function(e){class t extends O{constructor(i,r){super(i,r),this.causes=["The access token has an invalid Account SID, API Key, or API Key Secret."],this.code=31202,this.description="Signature validation failed.",this.explanation="The provided access token failed signature validation.",this.name="AccessTokenSignatureValidationFailed",this.solutions=["Ensure the Account SID, API Key, and API Key Secret are valid when generating your access token."],Object.setPrototypeOf(this,e.AccessTokenSignatureValidationFailed.prototype);const s=typeof i=="string"?i:this.explanation,o=typeof i=="object"?i:r;this.message=`${this.name} (${this.code}): ${s}`,this.originalError=o}}e.AccessTokenSignatureValidationFailed=t})(Lo||(Lo={}));var rn;(function(e){class t extends O{constructor(o,a){super(o,a),this.causes=[],this.code=31400,this.description="Bad Request (HTTP/SIP)",this.explanation="The request could not be understood due to malformed syntax.",this.name="BadRequest",this.solutions=[],Object.setPrototypeOf(this,e.BadRequest.prototype);const l=typeof o=="string"?o:this.explanation,u=typeof o=="object"?o:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=u}}e.BadRequest=t;class n extends O{constructor(o,a){super(o,a),this.causes=["The outbound call was made to an invalid phone number.","The TwiML application sid is missing a Voice URL."],this.code=31404,this.description="Not Found (HTTP/SIP)",this.explanation="The server has not found anything matching the request.",this.name="NotFound",this.solutions=["Ensure the phone number dialed is valid.","Ensure the TwiML application is configured correctly with a Voice URL link."],Object.setPrototypeOf(this,e.NotFound.prototype);const l=typeof o=="string"?o:this.explanation,u=typeof o=="object"?o:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=u}}e.NotFound=n;class i extends O{constructor(o,a){super(o,a),this.causes=[],this.code=31480,this.description="Temporarily Unavailable (SIP)",this.explanation="The callee is currently unavailable.",this.name="TemporarilyUnavailable",this.solutions=[],Object.setPrototypeOf(this,e.TemporarilyUnavailable.prototype);const l=typeof o=="string"?o:this.explanation,u=typeof o=="object"?o:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=u}}e.TemporarilyUnavailable=i;class r extends O{constructor(o,a){super(o,a),this.causes=[],this.code=31486,this.description="Busy Here (SIP)",this.explanation="The callee is busy.",this.name="BusyHere",this.solutions=[],Object.setPrototypeOf(this,e.BusyHere.prototype);const l=typeof o=="string"?o:this.explanation,u=typeof o=="object"?o:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=u}}e.BusyHere=r})(rn||(rn={}));var jo;(function(e){class t extends O{constructor(i,r){super(i,r),this.causes=[],this.code=31603,this.description="Decline (SIP)",this.explanation="The callee does not wish to participate in the call.",this.name="Decline",this.solutions=[],Object.setPrototypeOf(this,e.Decline.prototype);const s=typeof i=="string"?i:this.explanation,o=typeof i=="object"?i:r;this.message=`${this.name} (${this.code}): ${s}`,this.originalError=o}}e.Decline=t})(jo||(jo={}));var xe;(function(e){class t extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31e3,this.description="Unknown Error",this.explanation="An unknown error has occurred. See error details for more information.",this.name="UnknownError",this.solutions=[],Object.setPrototypeOf(this,e.UnknownError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.UnknownError=t;class n extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31001,this.description="Application Not Found",this.explanation="",this.name="ApplicationNotFoundError",this.solutions=[],Object.setPrototypeOf(this,e.ApplicationNotFoundError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.ApplicationNotFoundError=n;class i extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31002,this.description="Connection Declined",this.explanation="",this.name="ConnectionDeclinedError",this.solutions=[],Object.setPrototypeOf(this,e.ConnectionDeclinedError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.ConnectionDeclinedError=i;class r extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31003,this.description="Connection Timeout",this.explanation="The server could not produce a response within a suitable amount of time.",this.name="ConnectionTimeoutError",this.solutions=[],Object.setPrototypeOf(this,e.ConnectionTimeoutError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.ConnectionTimeoutError=r;class s extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31005,this.description="Connection error",this.explanation="A connection error occurred during the call",this.name="ConnectionError",this.solutions=[],Object.setPrototypeOf(this,e.ConnectionError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.ConnectionError=s;class o extends O{constructor(u,c){super(u,c),this.causes=["The incoming call was cancelled because it was not answered in time or it was accepted/rejected by another application instance registered with the same identity."],this.code=31008,this.description="Call cancelled",this.explanation="Unable to answer because the call has ended",this.name="CallCancelledError",this.solutions=[],Object.setPrototypeOf(this,e.CallCancelledError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.CallCancelledError=o;class a extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31009,this.description="Transport error",this.explanation="No transport available to send or receive messages",this.name="TransportError",this.solutions=[],Object.setPrototypeOf(this,e.TransportError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.TransportError=a})(xe||(xe={}));var yt;(function(e){class t extends O{constructor(u,c){super(u,c),this.causes=["Invalid content or MessageType passed to sendMessage method."],this.code=31100,this.description="The request had malformed syntax.",this.explanation="The request could not be understood due to malformed syntax.",this.name="MalformedRequestError",this.solutions=["Ensure content and MessageType passed to sendMessage method are valid."],Object.setPrototypeOf(this,e.MalformedRequestError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.MalformedRequestError=t;class n extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31101,this.description="Missing parameter array in request",this.explanation="",this.name="MissingParameterArrayError",this.solutions=[],Object.setPrototypeOf(this,e.MissingParameterArrayError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.MissingParameterArrayError=n;class i extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31102,this.description="Authorization token missing in request.",this.explanation="",this.name="AuthorizationTokenMissingError",this.solutions=[],Object.setPrototypeOf(this,e.AuthorizationTokenMissingError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.AuthorizationTokenMissingError=i;class r extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31103,this.description="Maximum parameter length has been exceeded.",this.explanation="Length of parameters cannot exceed MAX_PARAM_LENGTH.",this.name="MaxParameterLengthExceededError",this.solutions=[],Object.setPrototypeOf(this,e.MaxParameterLengthExceededError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.MaxParameterLengthExceededError=r;class s extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31104,this.description="Invalid bridge token",this.explanation="",this.name="InvalidBridgeTokenError",this.solutions=[],Object.setPrototypeOf(this,e.InvalidBridgeTokenError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.InvalidBridgeTokenError=s;class o extends O{constructor(u,c){super(u,c),this.causes=["Client name contains invalid characters."],this.code=31105,this.description="Invalid client name",this.explanation="Client name should not contain control, space, delims, or unwise characters.",this.name="InvalidClientNameError",this.solutions=["Make sure that client name does not contain any of the invalid characters."],Object.setPrototypeOf(this,e.InvalidClientNameError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.InvalidClientNameError=o;class a extends O{constructor(u,c){super(u,c),this.causes=[],this.code=31107,this.description="The reconnect parameter is invalid",this.explanation="",this.name="ReconnectParameterInvalidError",this.solutions=[],Object.setPrototypeOf(this,e.ReconnectParameterInvalidError.prototype);const d=typeof u=="string"?u:this.explanation,h=typeof u=="object"?u:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.ReconnectParameterInvalidError=a})(yt||(yt={}));(function(e){class t extends O{constructor(d,h){super(d,h),this.causes=[],this.code=31201,this.description="Authorization error",this.explanation="The request requires user authentication. The server understood the request, but is refusing to fulfill it.",this.name="AuthorizationError",this.solutions=[],Object.setPrototypeOf(this,e.AuthorizationError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.AuthorizationError=t;class n extends O{constructor(d,h){super(d,h),this.causes=[],this.code=31203,this.description="No valid account",this.explanation="",this.name="NoValidAccountError",this.solutions=[],Object.setPrototypeOf(this,e.NoValidAccountError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.NoValidAccountError=n;class i extends O{constructor(d,h){super(d,h),this.causes=[],this.code=31204,this.description="Invalid JWT token",this.explanation="",this.name="InvalidJWTTokenError",this.solutions=[],Object.setPrototypeOf(this,e.InvalidJWTTokenError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.InvalidJWTTokenError=i;class r extends O{constructor(d,h){super(d,h),this.causes=[],this.code=31205,this.description="JWT token expired",this.explanation="",this.name="JWTTokenExpiredError",this.solutions=[],Object.setPrototypeOf(this,e.JWTTokenExpiredError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.JWTTokenExpiredError=r;class s extends O{constructor(d,h){super(d,h),this.causes=["Rate limit exceeded."],this.code=31206,this.description="Rate exceeded authorized limit.",this.explanation="The request performed exceeds the authorized limit.",this.name="RateExceededError",this.solutions=["Ensure message send rate does not exceed authorized limits."],Object.setPrototypeOf(this,e.RateExceededError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.RateExceededError=s;class o extends O{constructor(d,h){super(d,h),this.causes=[],this.code=31207,this.description="JWT token expiration too long",this.explanation="",this.name="JWTTokenExpirationTooLongError",this.solutions=[],Object.setPrototypeOf(this,e.JWTTokenExpirationTooLongError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.JWTTokenExpirationTooLongError=o;class a extends O{constructor(d,h){super(d,h),this.causes=[],this.code=31209,this.description="Reconnect attempt is not authorized.",this.explanation="",this.name="ReconnectAttemptError",this.solutions=[],Object.setPrototypeOf(this,e.ReconnectAttemptError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.ReconnectAttemptError=a;class l extends O{constructor(d,h){super(d,h),this.causes=["The Call Message Event Type is invalid and is not understood by Twilio Voice."],this.code=31210,this.description="Call Message Event Type is invalid.",this.explanation="The Call Message Event Type is invalid and is not understood by Twilio Voice.",this.name="CallMessageEventTypeInvalidError",this.solutions=["Ensure the Call Message Event Type is Valid and understood by Twilio Voice and try again."],Object.setPrototypeOf(this,e.CallMessageEventTypeInvalidError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.CallMessageEventTypeInvalidError=l;class u extends O{constructor(d,h){super(d,h),this.causes=["The payload size of Call Message Event exceeds the authorized limit."],this.code=31212,this.description="Call Message Event Payload size exceeded authorized limit.",this.explanation="The request performed to send a Call Message Event exceeds the payload size authorized limit",this.name="PayloadSizeExceededError",this.solutions=["Reduce payload size of Call Message Event to be within the authorized limit and try again."],Object.setPrototypeOf(this,e.PayloadSizeExceededError.prototype);const v=typeof d=="string"?d:this.explanation,y=typeof d=="object"?d:h;this.message=`${this.name} (${this.code}): ${v}`,this.originalError=y}}e.PayloadSizeExceededError=u})(le||(le={}));var Bn;(function(e){class t extends O{constructor(r,s){super(r,s),this.causes=["The user denied the getUserMedia request.","The browser denied the getUserMedia request."],this.code=31401,this.description="UserMedia Permission Denied Error",this.explanation="The browser or end-user denied permissions to user media. Therefore we were unable to acquire input audio.",this.name="PermissionDeniedError",this.solutions=["The user should accept the request next time prompted. If the browser saved the deny, the user should change that permission in their browser.","The user should to verify that the browser has permission to access the microphone at this address."],Object.setPrototypeOf(this,e.PermissionDeniedError.prototype);const o=typeof r=="string"?r:this.explanation,a=typeof r=="object"?r:s;this.message=`${this.name} (${this.code}): ${o}`,this.originalError=a}}e.PermissionDeniedError=t;class n extends O{constructor(r,s){super(r,s),this.causes=["NotFoundError - The deviceID specified was not found.","The getUserMedia constraints were overconstrained and no devices matched."],this.code=31402,this.description="UserMedia Acquisition Failed Error",this.explanation="The browser and end-user allowed permissions, however getting the media failed. Usually this is due to bad constraints, but can sometimes fail due to browser, OS or hardware issues.",this.name="AcquisitionFailedError",this.solutions=["Ensure the deviceID being specified exists.","Try acquiring media with fewer constraints."],Object.setPrototypeOf(this,e.AcquisitionFailedError.prototype);const o=typeof r=="string"?r:this.explanation,a=typeof r=="object"?r:s;this.message=`${this.name} (${this.code}): ${o}`,this.originalError=a}}e.AcquisitionFailedError=n})(Bn||(Bn={}));var Je;(function(e){class t extends O{constructor(r,s){super(r,s),this.causes=[],this.code=53e3,this.description="Signaling connection error",this.explanation="Raised whenever a signaling connection error occurs that is not covered by a more specific error code.",this.name="ConnectionError",this.solutions=[],Object.setPrototypeOf(this,e.ConnectionError.prototype);const o=typeof r=="string"?r:this.explanation,a=typeof r=="object"?r:s;this.message=`${this.name} (${this.code}): ${o}`,this.originalError=a}}e.ConnectionError=t;class n extends O{constructor(r,s){super(r,s),this.causes=["The device running your application lost its Internet connection."],this.code=53001,this.description="Signaling connection disconnected",this.explanation="Raised whenever the signaling connection is unexpectedly disconnected.",this.name="ConnectionDisconnected",this.solutions=["Ensure the device running your application has access to a stable Internet connection."],Object.setPrototypeOf(this,e.ConnectionDisconnected.prototype);const o=typeof r=="string"?r:this.explanation,a=typeof r=="object"?r:s;this.message=`${this.name} (${this.code}): ${o}`,this.originalError=a}}e.ConnectionDisconnected=n})(Je||(Je={}));var mt;(function(e){class t extends O{constructor(s,o){super(s,o),this.causes=["The Client may not be using a supported WebRTC implementation.","The Client may not have the necessary resources to create or apply a new media description."],this.code=53400,this.description="Client is unable to create or apply a local media description",this.explanation="Raised whenever a Client is unable to create or apply a local media description.",this.name="ClientLocalDescFailed",this.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(this,e.ClientLocalDescFailed.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}e.ClientLocalDescFailed=t;class n extends O{constructor(s,o){super(s,o),this.causes=["The Client may not be using a supported WebRTC implementation.","The Client may be connecting peer-to-peer with another Participant that is not using a supported WebRTC implementation.","The Client may not have the necessary resources to apply a new media description."],this.code=53402,this.description="Client is unable to apply a remote media description",this.explanation="Raised whenever the Client receives a remote media description but is unable to apply it.",this.name="ClientRemoteDescFailed",this.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(this,e.ClientRemoteDescFailed.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}e.ClientRemoteDescFailed=n;class i extends O{constructor(s,o){super(s,o),this.causes=["The Client was unable to establish a media connection.","A media connection which was active failed liveliness checks."],this.code=53405,this.description="Media connection failed",this.explanation="Raised by the Client or Server whenever a media connection fails.",this.name="ConnectionError",this.solutions=["If the problem persists, try connecting to another region.","Check your Client's network connectivity.","If you've provided custom ICE Servers then ensure that the URLs and credentials are valid."],Object.setPrototypeOf(this,e.ConnectionError.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}e.ConnectionError=i})(mt||(mt={}));const Ua=new Map([[20101,le.AccessTokenInvalid],[20104,le.AccessTokenExpired],[20151,le.AuthenticationFailed],[31202,Lo.AccessTokenSignatureValidationFailed],[31400,rn.BadRequest],[31404,rn.NotFound],[31480,rn.TemporarilyUnavailable],[31486,rn.BusyHere],[31603,jo.Decline],[31e3,xe.UnknownError],[31001,xe.ApplicationNotFoundError],[31002,xe.ConnectionDeclinedError],[31003,xe.ConnectionTimeoutError],[31005,xe.ConnectionError],[31008,xe.CallCancelledError],[31009,xe.TransportError],[31100,yt.MalformedRequestError],[31101,yt.MissingParameterArrayError],[31102,yt.AuthorizationTokenMissingError],[31103,yt.MaxParameterLengthExceededError],[31104,yt.InvalidBridgeTokenError],[31105,yt.InvalidClientNameError],[31107,yt.ReconnectParameterInvalidError],[31201,le.AuthorizationError],[31203,le.NoValidAccountError],[31204,le.InvalidJWTTokenError],[31205,le.JWTTokenExpiredError],[31206,le.RateExceededError],[31207,le.JWTTokenExpirationTooLongError],[31209,le.ReconnectAttemptError],[31210,le.CallMessageEventTypeInvalidError],[31212,le.PayloadSizeExceededError],[31401,Bn.PermissionDeniedError],[31402,Bn.AcquisitionFailedError],[53e3,Je.ConnectionError],[53001,Je.ConnectionDisconnected],[53400,mt.ClientLocalDescFailed],[53402,mt.ClientRemoteDescFailed],[53405,mt.ConnectionError]]);Object.freeze(Ua);const Bp=new Set([31001,31002,31003,31101,31102,31103,31104,31105,31107,31201,31202,31203,31204,31205,31207,31404,31480,31486,31603]);function Mo(e,t){if(!(typeof t!="number"||!Qp(t)||!(e||!Bp.has(t))))return Gp(t)}class W extends Error{constructor(t){super(t),this.name="InvalidArgumentError"}}class tt extends Error{constructor(t){super(t),this.name="InvalidStateError"}}class me extends Error{constructor(t){super(t),this.name="NotSupportedError"}}function Gp(e){const t=Ua.get(e);if(!t)throw new W(`Error code ${e} not found`);return t}function Qp(e){return Ua.has(e)}const Vd="@twilio/voice-sdk",On="2.18.0",Fa="https://sdk.twilio.com/js/client/sounds/releases/1.0.0",Jp=`${Fa}/cowbell.mp3?cache=${On}`,Kp=2e4;class ce{static getLogLevelInstance(t){if(!ce.loglevelInstance)try{ce.loglevelInstance=(t&&t.LogLevelModule?t.LogLevelModule:Hp).getLogger(Vd)}catch{console.warn("Cannot create custom logger"),ce.loglevelInstance=console}return ce.loglevelInstance}constructor(t,n){this._log=ce.getLogLevelInstance(n),this._prefix=`[TwilioVoice][${t}]`}debug(...t){this._log.debug(this._prefix,...t)}error(...t){this._log.error(this._prefix,...t)}info(...t){this._log.info(this._prefix,...t)}setDefaultLevel(t){this._log.setDefaultLevel?this._log.setDefaultLevel(t):console.warn("Logger cannot setDefaultLevel")}warn(...t){this._log.warn(this._prefix,...t)}}ce.levels=Li.levels;ce.getLogLevelInstance();const qp=`${Fa}/outgoing.mp3`;class eu{constructor(t,n,i,r){this._name=t,this._availableDevices=n,this._beforeChange=i,this._isSupported=r,this._activeDevices=new Set,this._log=new ce("OutputDeviceCollection")}delete(t){this._log.debug(".delete",t);const n=!!this._activeDevices.delete(t),i=this._availableDevices.get("default")||Array.from(this._availableDevices.values())[0];!this._activeDevices.size&&i&&this._activeDevices.add(i);const r=Array.from(this._activeDevices.values()).map(s=>s.deviceId);return this._beforeChange(this._name,r),!!n}get(){return this._activeDevices}set(t){if(this._log.debug(".set",t),!this._isSupported)return Promise.reject(new me("This browser does not support audio output selection"));const n=Array.isArray(t)?t:[t];if(!n.length)return Promise.reject(new W("Must specify at least one device to set"));const i=[],r=n.map(s=>{const o=this._availableDevices.get(s);return o||i.push(s),o});return i.length?Promise.reject(new W(`Devices not found: ${i.join(", ")}`)):new Promise(s=>{s(this._beforeChange(this._name,n))}).then(()=>{this._activeDevices.clear(),r.forEach(this._activeDevices.add,this._activeDevices)})}test(t=qp){return this._isSupported?this._activeDevices.size?Promise.all(Array.from(this._activeDevices).map(n=>{let i;return new Promise(r=>{i=new Audio(t),i.oncanplay=r}).then(()=>i.setSinkId(n.deviceId).then(()=>i.play()))})):Promise.reject(new tt("No active output devices to test")):Promise.reject(new me("This browser does not support audio output selection"))}}class Yp{constructor(t){Object.defineProperties(this,{deviceId:{get(){return t.deviceId}},groupId:{get(){return t.groupId}},kind:{get(){return t.kind}},label:{get(){return t.label}}})}}function Wr(e){if(!(this instanceof Wr))return new Wr(e);this.message=e}Wr.prototype.toString=function(){return`Twilio.Exception: ${this.message}`};function gi(e){return e&&e.length?e.reduce((t,n)=>t+n)/e.length:0}function $a(e,t,n){n=n||(r=>r);const i=new Set(t.map(n));return e.filter(r=>!i.has(n(r)))}function Wd(e){return!!e.userAgent.match("Electron")}function za(e,t){const n=!!t.userAgent.match("CriOS"),i=!!t.userAgent.match("HeadlessChrome"),r=typeof e.chrome<"u"&&t.vendor==="Google Inc."&&t.userAgent.indexOf("OPR")===-1&&t.userAgent.indexOf("Edge")===-1;return n||Wd(t)||r||i}function Xp(e){return e=e||(typeof window>"u"?global.navigator:window.navigator),!!e&&typeof e.userAgent=="string"&&/firefox|fxios/i.test(e.userAgent)}function as(e){return e=e||(typeof window>"u"?global.navigator:window.navigator),!!e&&typeof e.userAgent=="string"&&/edge\/\d+/i.test(e.userAgent)}function Zp(e){return!!e.vendor&&e.vendor.indexOf("Apple")!==-1&&e.userAgent&&e.userAgent.indexOf("CriOS")===-1&&e.userAgent.indexOf("FxiOS")===-1}function Hd(e){return e?e.split("&").reduce((t,n)=>{const i=n.split("="),r=i[0],s=decodeURIComponent((i[1]||"").replace(/\+/g,"%20"));return r&&(t[r]=s),t},{}):""}function Oo(e,t){const n=e instanceof Map||e instanceof Set?Array.from(e.values()):e;return t=t||(i=>i),n.reduce((i,r)=>{const s=t(r);return i.concat(s)},[])}function Uo(e,t,n){return new Promise((i,r)=>{function s(){e.removeListener(n,o),i()}function o(){e.removeListener(t,s),r()}e.once(t,s),e.once(n,o)})}function Bd(e,t){const n=t.map(i=>"audio/"+i.toLowerCase());return e.sort((i,r)=>{const s=n.indexOf(i.mimeType.toLowerCase()),o=n.indexOf(r.mimeType.toLowerCase()),a=s>=0?s:Number.MAX_VALUE,l=o>=0?o:Number.MAX_VALUE;return a-l})}const em=Wr,Gd=Object.freeze(Object.defineProperty({__proto__:null,Exception:em,average:gi,difference:$a,flatMap:Oo,isChrome:za,isElectron:Wd,isFirefox:Xp,isLegacyEdge:as,isSafari:Zp,promisifyEvents:Uo,queryToJson:Hd,sortByMimeTypes:Bd},Symbol.toStringTag,{value:"Module"})),tm={audioinput:"Audio Input",audiooutput:"Audio Output"};class Fo extends Ye.EventEmitter{get audioConstraints(){return this._audioConstraints}get inputDevice(){return this._inputDevice}get inputStream(){return this._localProcessedStream||this._selectedInputDeviceStream}get processedStream(){return this._log.warn("AudioHelper#processedStream is deprecated. Please use AudioHelper#localProcessedStream instead."),this._localProcessedStream}get localProcessedStream(){return this._localProcessedStream}get remoteProcessedStream(){return this._remoteProcessedStream}constructor(t,n,i){super(),this.availableInputDevices=new Map,this.availableOutputDevices=new Map,this._audioConstraints=null,this._defaultInputDeviceStream=null,this._enabledSounds={[P.SoundName.Disconnect]:!0,[P.SoundName.Incoming]:!0,[P.SoundName.Outgoing]:!0},this._inputDevice=null,this._inputDevicePromise=null,this._isPollingInputVolume=!1,this._log=new ce("AudioHelper"),this._localProcessedStream=null,this._remoteProcessedStream=null,this._selectedInputDeviceStream=null,this._unknownDeviceIndexes={audioinput:{},audiooutput:{}},this._updateAvailableDevices=()=>!this._mediaDevices||!this._enumerateDevices?Promise.reject("Enumeration not supported"):this._enumerateDevices().then(a=>{this._updateDevices(a.filter(u=>u.kind==="audiooutput"),this.availableOutputDevices,this._removeLostOutput),this._updateDevices(a.filter(u=>u.kind==="audioinput"),this.availableInputDevices,this._removeLostInput);const l=this.availableOutputDevices.get("default")||Array.from(this.availableOutputDevices.values())[0];[this.speakerDevices,this.ringtoneDevices].forEach(u=>{!u.get().size&&this.availableOutputDevices.size&&this.isOutputSelectionSupported&&u.set(l.deviceId).catch(c=>{this._log.warn(`Unable to set audio output devices. ${c}`)})})}),this._removeLostInput=a=>{if(!this.inputDevice||this.inputDevice.deviceId!==a.deviceId)return!1;this._destroyLocalProcessedStream(),this._replaceStream(null),this._inputDevice=null,this._maybeStopPollingVolume();const l=this.availableInputDevices.get("default")||Array.from(this.availableInputDevices.values())[0];return l&&this.setInputDevice(l.deviceId),!0},this._removeLostOutput=a=>{const l=this.speakerDevices.delete(a),u=this.ringtoneDevices.delete(a);return l||u},i=Object.assign({AudioContext:typeof AudioContext<"u"&&AudioContext,setSinkId:typeof HTMLAudioElement<"u"&&HTMLAudioElement.prototype.setSinkId},i),this._beforeSetInputDevice=i.beforeSetInputDevice||(()=>Promise.resolve()),this._updateUserOptions(i),this._audioProcessorEventObserver=i.audioProcessorEventObserver,this._mediaDevices=i.mediaDevices||navigator.mediaDevices,this._onActiveInputChanged=n,this._enumerateDevices=typeof i.enumerateDevices=="function"?i.enumerateDevices:this._mediaDevices&&this._mediaDevices.enumerateDevices.bind(this._mediaDevices);const r=!!(i.AudioContext||i.audioContext),s=!!this._enumerateDevices;i.enabledSounds&&(this._enabledSounds=i.enabledSounds);const o=typeof i.setSinkId=="function";this.isOutputSelectionSupported=s&&o,this.isVolumeSupported=r,this.isVolumeSupported&&(this._audioContext=i.audioContext||i.AudioContext&&new i.AudioContext,this._audioContext&&(this._inputVolumeAnalyser=this._audioContext.createAnalyser(),this._inputVolumeAnalyser.fftSize=32,this._inputVolumeAnalyser.smoothingTimeConstant=.3)),this.ringtoneDevices=new eu("ringtone",this.availableOutputDevices,t,this.isOutputSelectionSupported),this.speakerDevices=new eu("speaker",this.availableOutputDevices,t,this.isOutputSelectionSupported),this.addListener("newListener",a=>{a==="inputVolume"&&this._maybeStartPollingVolume()}),this.addListener("removeListener",a=>{a==="inputVolume"&&this._maybeStopPollingVolume()}),this.once("newListener",()=>{this.isOutputSelectionSupported||this._log.warn("Warning: This browser does not support audio output selection."),this.isVolumeSupported||this._log.warn("Warning: This browser does not support Twilio's volume indicator feature.")}),s&&this._initializeEnumeration(),navigator&&navigator.permissions&&typeof navigator.permissions.query=="function"?navigator.permissions.query({name:"microphone"}).then(a=>{if(a.state!=="granted"){const l=()=>{this._updateAvailableDevices(),this._stopMicrophonePermissionListener()};a.addEventListener("change",l),this._microphonePermissionStatus=a,this._onMicrophonePermissionStatusChanged=l}}).catch(a=>this._log.warn(`Warning: unable to listen for microphone permission changes. ${a}`)):this._log.warn("Warning: current browser does not support permissions API.")}_destroy(){this._stopDefaultInputDeviceStream(),this._stopSelectedInputDeviceStream(),this._destroyLocalProcessedStream(),this._destroyRemoteProcessedStream(),this._maybeStopPollingVolume(),this.removeAllListeners(),this._stopMicrophonePermissionListener(),this._unbind()}_destroyRemoteProcessedStream(){if(this._remoteProcessor&&this._remoteProcessedStream){this._log.info("destroying remote processed stream");const t=this._remoteProcessedStream;this._remoteProcessedStream.getTracks().forEach(n=>n.stop()),this._remoteProcessedStream=null,this._remoteProcessor.destroyProcessedStream(t),this._audioProcessorEventObserver.emit("destroy",!0)}}_getInputDevicePromise(){return this._inputDevicePromise}_getAudioProcessorEventObserver(){return this._audioProcessorEventObserver}_maybeCreateRemoteProcessedStream(t){return this._remoteProcessor?(this._log.info("Creating remote processed stream"),this._remoteProcessor.createProcessedStream(t).then(n=>(this._remoteProcessedStream=n,this._audioProcessorEventObserver.emit("create",!0),this._remoteProcessedStream))):Promise.resolve(t)}_maybeStartPollingVolume(){if(!this.isVolumeSupported||!this.inputStream||(this._updateVolumeSource(),this._isPollingInputVolume||!this._inputVolumeAnalyser))return;const t=this._inputVolumeAnalyser.frequencyBinCount,n=new Uint8Array(t);this._isPollingInputVolume=!0;const i=()=>{if(this._isPollingInputVolume){if(this._inputVolumeAnalyser){this._inputVolumeAnalyser.getByteFrequencyData(n);const r=gi(n);this.emit("inputVolume",r/255)}requestAnimationFrame(i)}};requestAnimationFrame(i)}_maybeStopPollingVolume(){this.isVolumeSupported&&(!this._isPollingInputVolume||this.inputStream&&this.listenerCount("inputVolume")||(this._inputVolumeSource&&(this._inputVolumeSource.disconnect(),delete this._inputVolumeSource),this._isPollingInputVolume=!1))}_openDefaultDeviceWithConstraints(t){return this._log.info("Opening default device with constraints",t),this._getUserMedia(t).then(n=>(this._log.info("Opened default device. Updating available devices."),this._updateAvailableDevices().catch(i=>{this._log.warn("Unable to updateAvailableDevices after gUM call",i)}),this._defaultInputDeviceStream=n,this._maybeCreateLocalProcessedStream(n)))}_stopDefaultInputDeviceStream(){this._defaultInputDeviceStream&&(this._log.info("stopping default device stream"),this._defaultInputDeviceStream.getTracks().forEach(t=>t.stop()),this._defaultInputDeviceStream=null,this._destroyLocalProcessedStream())}_unbind(){var t;!((t=this._mediaDevices)===null||t===void 0)&&t.removeEventListener&&this._mediaDevices.removeEventListener("devicechange",this._updateAvailableDevices)}_updateUserOptions(t){typeof t.enumerateDevices=="function"&&(this._enumerateDevices=t.enumerateDevices),typeof t.getUserMedia=="function"&&(this._getUserMedia=t.getUserMedia)}addProcessor(t,n=!1){if(this._log.debug(".addProcessor"),this._localProcessor&&!n)throw new me("Can only have one Local AudioProcessor at a time.");if(this._remoteProcessor&&n)throw new me("Can only have one Remote AudioProcessor at a time.");if(typeof t!="object"||t===null)throw new W("Missing AudioProcessor argument.");if(typeof t.createProcessedStream!="function")throw new W("Missing createProcessedStream() method.");if(typeof t.destroyProcessedStream!="function")throw new W("Missing destroyProcessedStream() method.");return n?(this._remoteProcessor=t,this._audioProcessorEventObserver.emit("add",!0),Promise.resolve()):(this._localProcessor=t,this._audioProcessorEventObserver.emit("add",!1),this._restartInputStreams())}disconnect(t){return this._log.debug(".disconnect",t),this._maybeEnableSound(P.SoundName.Disconnect,t)}incoming(t){return this._log.debug(".incoming",t),this._maybeEnableSound(P.SoundName.Incoming,t)}outgoing(t){return this._log.debug(".outgoing",t),this._maybeEnableSound(P.SoundName.Outgoing,t)}removeProcessor(t,n=!1){if(this._log.debug(".removeProcessor"),typeof t!="object"||t===null)throw new W("Missing AudioProcessor argument.");if(this._localProcessor!==t&&!n)throw new W("Cannot remove a Local AudioProcessor that has not been previously added.");if(this._remoteProcessor!==t&&n)throw new W("Cannot remove a Remote AudioProcessor that has not been previously added.");return n?(this._destroyRemoteProcessedStream(),this._remoteProcessor=null,this._audioProcessorEventObserver.emit("remove",!0),Promise.resolve()):(this._destroyLocalProcessedStream(),this._localProcessor=null,this._audioProcessorEventObserver.emit("remove",!1),this._restartInputStreams())}setAudioConstraints(t){return this._log.debug(".setAudioConstraints",t),this._audioConstraints=Object.assign({},t),delete this._audioConstraints.deviceId,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()}setInputDevice(t){return this._log.debug(".setInputDevice",t),this._setInputDevice(t,!1)}unsetAudioConstraints(){return this._log.debug(".unsetAudioConstraints"),this._audioConstraints=null,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()}unsetInputDevice(){return this._log.debug(".unsetInputDevice",this.inputDevice),this.inputDevice?(this._destroyLocalProcessedStream(),this._onActiveInputChanged(null).then(()=>{this._replaceStream(null),this._inputDevice=null,this._maybeStopPollingVolume()})):Promise.resolve()}_destroyLocalProcessedStream(){if(this._localProcessor&&this._localProcessedStream){this._log.info("destroying local processed stream");const t=this._localProcessedStream;this._localProcessedStream.getTracks().forEach(n=>n.stop()),this._localProcessedStream=null,this._localProcessor.destroyProcessedStream(t),this._audioProcessorEventObserver.emit("destroy",!1)}}_getUnknownDeviceIndex(t){const n=t.deviceId,i=t.kind;let r=this._unknownDeviceIndexes[i][n];return r||(r=Object.keys(this._unknownDeviceIndexes[i]).length+1,this._unknownDeviceIndexes[i][n]=r),r}_initializeEnumeration(){if(!this._mediaDevices||!this._enumerateDevices)throw new me("Enumeration is not supported");this._mediaDevices.addEventListener&&this._mediaDevices.addEventListener("devicechange",this._updateAvailableDevices),this._updateAvailableDevices().then(()=>{this.isOutputSelectionSupported&&Promise.all([this.speakerDevices.set("default"),this.ringtoneDevices.set("default")]).catch(t=>{this._log.warn(`Warning: Unable to set audio output devices. ${t}`)})})}_maybeCreateLocalProcessedStream(t){return this._localProcessor?(this._log.info("Creating local processed stream"),this._localProcessor.createProcessedStream(t).then(n=>(this._localProcessedStream=n,this._audioProcessorEventObserver.emit("create",!1),this._localProcessedStream))):Promise.resolve(t)}_maybeEnableSound(t,n){return typeof n<"u"&&(this._enabledSounds[t]=n),this._enabledSounds[t]}_replaceStream(t){this._log.info("Replacing with new stream."),this._selectedInputDeviceStream&&(this._log.info("Old stream detected. Stopping tracks."),this._stopSelectedInputDeviceStream()),this._selectedInputDeviceStream=t}_restartInputStreams(){if(this.inputDevice&&this._selectedInputDeviceStream)return this._log.info("Restarting selected input device"),this._setInputDevice(this.inputDevice.deviceId,!0);if(this._defaultInputDeviceStream){const t=this.availableInputDevices.get("default")||Array.from(this.availableInputDevices.values())[0];return this._log.info("Restarting default input device, now becoming selected."),this._setInputDevice(t.deviceId,!0)}return Promise.resolve()}_setInputDevice(t,n){return Te(this,void 0,void 0,function*(){const i=()=>Te(this,void 0,void 0,function*(){if(yield this._beforeSetInputDevice(),typeof t!="string")return Promise.reject(new W("Must specify the device to set"));const r=this.availableInputDevices.get(t);if(!r)return Promise.reject(new W(`Device not found: ${t}`));if(this._log.info("Setting input device. ID: "+t),this._inputDevice&&this._inputDevice.deviceId===t&&this._selectedInputDeviceStream){if(!n)return Promise.resolve();this._log.info("Same track detected on setInputDevice, stopping old tracks."),this._stopSelectedInputDeviceStream()}this._stopDefaultInputDeviceStream();const s={audio:Object.assign({deviceId:{exact:t}},this.audioConstraints)};return this._log.info("setInputDevice: getting new tracks."),this._getUserMedia(s).then(o=>(this._destroyLocalProcessedStream(),this._maybeCreateLocalProcessedStream(o).then(a=>(this._log.info("setInputDevice: invoking _onActiveInputChanged."),this._onActiveInputChanged(a).then(()=>{this._replaceStream(o),this._inputDevice=r,this._maybeStartPollingVolume()})))))});return this._inputDevicePromise=i().finally(()=>{this._inputDevicePromise=null})})}_stopMicrophonePermissionListener(){var t;!((t=this._microphonePermissionStatus)===null||t===void 0)&&t.removeEventListener&&this._microphonePermissionStatus.removeEventListener("change",this._onMicrophonePermissionStatusChanged)}_stopSelectedInputDeviceStream(){this._selectedInputDeviceStream&&(this._log.info("Stopping selected device stream"),this._selectedInputDeviceStream.getTracks().forEach(t=>t.stop()))}_updateDevices(t,n,i){const r=t.map(u=>u.deviceId),s=Array.from(n.values()).map(u=>u.deviceId),o=[],a=$a(s,r);a.forEach(u=>{const c=n.get(u);c&&(n.delete(u),i(c)&&o.push(c))});let l=!1;if(t.forEach(u=>{const c=n.get(u.deviceId),d=this._wrapMediaDeviceInfo(u);(!c||c.label!==d.label)&&(n.set(u.deviceId,d),l=!0)}),l||a.length){const u="default",c=this.inputDevice&&this.inputDevice.deviceId===u,d=this._defaultInputDeviceStream&&this.availableInputDevices.get(u);(c||d)&&(this._log.warn("Calling getUserMedia after device change to ensure that the           tracks of the active device (default) have not gone stale."),setTimeout(()=>{this._setInputDevice(u,!0)},0)),this._log.debug("#deviceChange",o),this.emit("deviceChange",o)}}_updateVolumeSource(){if(!(!this.inputStream||!this._audioContext||!this._inputVolumeAnalyser)){this._inputVolumeSource&&this._inputVolumeSource.disconnect();try{this._inputVolumeSource=this._audioContext.createMediaStreamSource(this.inputStream),this._inputVolumeSource.connect(this._inputVolumeAnalyser)}catch(t){this._log.warn("Unable to update volume source",t),delete this._inputVolumeSource}}}_wrapMediaDeviceInfo(t){const n={deviceId:t.deviceId,groupId:t.groupId,kind:t.kind,label:t.label};if(!n.label)if(n.deviceId==="default")n.label="Default";else{const i=this._getUnknownDeviceIndex(t);n.label=`Unknown ${tm[n.kind]} Device ${i}`}return new Yp(n)}}Fo||(Fo={});var nm=Fo;class im extends Ye.EventEmitter{constructor(){super(),this._log=new ce("AudioProcessorEventObserver"),this._log.info("Creating AudioProcessorEventObserver instance"),this.on("enabled",t=>this._reEmitEvent("enabled",t)),this.on("add",t=>this._reEmitEvent("add",t)),this.on("remove",t=>this._reEmitEvent("remove",t)),this.on("create",t=>this._reEmitEvent("create-processed-stream",t)),this.on("destroy",t=>this._reEmitEvent("destroy-processed-stream",t))}destroy(){this.removeAllListeners()}_reEmitEvent(t,n){this._log.info(`${n?"Remote":"Local"} AudioProcessor:${t}`),this.emit("event",{name:t,group:"audio-processor",isRemote:n})}}const rm={dtmf0:[1360,960],dtmf1:[1230,720],dtmf2:[1360,720],dtmf3:[1480,720],dtmf4:[1230,790],dtmf5:[1360,790],dtmf6:[1480,790],dtmf7:[1230,870],dtmf8:[1360,870],dtmf9:[1480,870],dtmfh:[1480,960],dtmfs:[1230,960]};class sm{constructor(t){this._context=t,this._gainNodes=[],this._gainNodes=[this._context.createGain(),this._context.createGain()],this._gainNodes.forEach(n=>{n.connect(this._context.destination),n.gain.value=.1,this._gainNodes.push(n)})}cleanup(){this._gainNodes.forEach(t=>{t.disconnect()})}play(t){const n=rm[t];if(!n)throw new W("Invalid DTMF sound name");[this._context.createOscillator(),this._context.createOscillator()].forEach((r,s)=>{r.type="sine",r.frequency.value=n[s],r.connect(this._gainNodes[s]),r.start(),r.stop(this._context.currentTime+.1),r.addEventListener("ended",()=>r.disconnect())})}}function om(e,t,n){const i=JSON.stringify(t.body||{}),r=new Headers;t.headers=t.headers||[],Object.entries(t.headers).forEach(([s,o])=>r.append(s,o)),fetch(t.url,{body:i,headers:r,method:e}).then(s=>s.text(),n).then(s=>n(null,s),n)}const Va=om;Va.get=function(t,n){return new this("GET",t,n)};Va.post=function(t,n){return new this("POST",t,n)};class be extends Ye.EventEmitter{constructor(t,n,i){if(super(),!(this instanceof be))return new be(t,n,i);i=Object.assign({defaultPayload(){return{}}},i);let r=i.defaultPayload;typeof r!="function"&&(r=()=>Object.assign({},i.defaultPayload));let s=!0;const o=Object.assign({app_name:void 0,app_version:void 0},i.metadata);Object.defineProperties(this,{_defaultPayload:{value:r},_host:{value:i.host,writable:!0},_isEnabled:{get(){return s},set(a){s=a}},_log:{value:new ce("EventPublisher")},_request:{value:i.request||Va,writable:!0},_token:{value:n,writable:!0},isEnabled:{enumerable:!0,get(){return s}},metadata:{enumerable:!0,get(){return o}},productName:{enumerable:!0,value:t},token:{enumerable:!0,get(){return this._token}}})}}be.prototype._post=function(t,n,i,r,s,o,a){if(!this.isEnabled&&!a||!this._host)return this._log.debug("Publishing cancelled",JSON.stringify({isEnabled:this.isEnabled,force:a,host:this._host})),Promise.resolve();if(!o||(!o.parameters||!o.parameters.CallSid)&&!o.outboundConnectionId)return o?this._log.debug("Publishing cancelled. Missing connection info",JSON.stringify({outboundConnectionId:o.outboundConnectionId,parameters:o.parameters})):this._log.debug("Publishing cancelled. Missing connection object"),Promise.resolve();const l={group:i,level:n.toUpperCase(),name:r,payload:s&&s.forEach?s.slice(0):Object.assign(this._defaultPayload(o),s),payload_type:"application/json",private:!1,publisher:this.productName,timestamp:new Date().toISOString()};this.metadata&&(l.publisher_metadata=this.metadata),t==="EndpointEvents"&&this._log.debug("Publishing insights",JSON.stringify({endpointName:t,event:l,force:a,host:this._host}));const u={body:l,headers:{"Content-Type":"application/json","X-Twilio-Token":this.token},url:`https://${this._host}/v4/${t}`};return new Promise((c,d)=>{this._request.post(u,h=>{h?(this.emit("error",h),d(h)):c()})}).catch(c=>{this._log.error(`Unable to post ${i} ${r} event to Insights. Received error: ${c}`)})};be.prototype.post=function(t,n,i,r,s,o){return this._post("EndpointEvents",t,n,i,r,s,o)};be.prototype.debug=function(t,n,i,r){return this.post("debug",t,n,i,r)};be.prototype.info=function(t,n,i,r){return this.post("info",t,n,i,r)};be.prototype.warn=function(t,n,i,r){return this.post("warning",t,n,i,r)};be.prototype.error=function(t,n,i,r){return this.post("error",t,n,i,r)};be.prototype.postMetrics=function(t,n,i,r,s){return new Promise(o=>{const a=i.map(am).map(l=>Object.assign(l,r));o(this._post("EndpointMetrics","info",t,n,a,s))})};be.prototype.setHost=function(t){this._host=t};be.prototype.setToken=function(t){this._token=t};be.prototype.enable=function(){this._isEnabled=!0};be.prototype.disable=function(){this._isEnabled=!1};function am(e){return{audio_codec:e.codecName,audio_level_in:e.audioInputLevel,audio_level_out:e.audioOutputLevel,bytes_received:e.bytesReceived,bytes_sent:e.bytesSent,call_volume_input:e.inputVolume,call_volume_output:e.outputVolume,jitter:e.jitter,mos:e.mos&&Math.round(e.mos*100)/100,packets_lost:e.packetsLost,packets_lost_fraction:e.packetsLostFraction&&Math.round(e.packetsLostFraction*100)/100,packets_received:e.packetsReceived,rtt:e.rtt,timestamp:new Date(e.timestamp).toISOString(),total_bytes_received:e.totals.bytesReceived,total_bytes_sent:e.totals.bytesSent,total_packets_lost:e.totals.packetsLost,total_packets_received:e.totals.packetsReceived,total_packets_sent:e.totals.packetsSent}}const tu=32767,nu=typeof window<"u"?window.RTCStatsReport:void 0;function at(e){if(!(this instanceof at))return new at(e);const t=this;Object.defineProperties(this,{_map:{value:e},size:{enumerable:!0,get(){return t._map.size}}}),this[Symbol.iterator]=e[Symbol.iterator]}nu&&(at.prototype=Object.create(nu.prototype),at.prototype.constructor=at);["entries","forEach","get","has","keys","values"].forEach(e=>{at.prototype[e]=function(...t){return this._map[e](...t)}});at.fromArray=function(t){return new at(t.reduce((n,i)=>(n.set(i.id,i),n),new Map))};at.fromRTCStatsResponse=function(t){let n;const i=new Map,r=t.result().reduce((s,o)=>{const a=o.id;switch(o.type){case"googCertificate":s.set(a,fm(o));break;case"datachannel":s.set(a,pm(o));break;case"googCandidatePair":Jd(o,"googActiveConnection")&&(n=a),s.set(a,hm(o));break;case"localcandidate":s.set(a,ru(o,!1));break;case"remotecandidate":s.set(a,ru(o,!0));break;case"ssrc":an(o,"packetsReceived")?s.set(`rtp-${a}`,cm(o)):s.set(`rtp-${a}`,dm(o)),s.set(`track-${a}`,um(o)),s.set(`codec-${a}`,lm(o));break;case"googComponent":const l=iu(o);i.set(l.selectedCandidatePairId,a),s.set(a,iu(o));break}return s},new Map);if(n){const s=i.get(n);s&&(r.get(s).dtlsState="connected")}return new at(r)};function iu(e){return{bytesReceived:void 0,bytesSent:void 0,dtlsState:void 0,id:e.id,localCertificateId:e.stat("localCertificateId"),remoteCertificateId:e.stat("remoteCertificateId"),rtcpTransportStatsId:void 0,selectedCandidatePairId:e.stat("selectedCandidatePairId"),timestamp:Date.parse(e.timestamp),type:"transport"}}function lm(e){return{channels:void 0,clockRate:void 0,id:e.id,implementation:void 0,mimeType:`${e.stat("mediaType")}/${e.stat("googCodecName")}`,payloadType:void 0,sdpFmtpLine:void 0,timestamp:Date.parse(e.timestamp),type:"codec"}}function um(e){return{audioLevel:an(e,"audioOutputLevel")?H(e,"audioOutputLevel")/tu:(H(e,"audioInputLevel")||0)/tu,detached:void 0,echoReturnLoss:zo(e,"googEchoCancellationReturnLoss"),echoReturnLossEnhancement:zo(e,"googEchoCancellationReturnLossEnhancement"),ended:void 0,frameHeight:an(e,"googFrameHeightReceived")?H(e,"googFrameHeightReceived"):H(e,"googFrameHeightSent"),frameWidth:an(e,"googFrameWidthReceived")?H(e,"googFrameWidthReceived"):H(e,"googFrameWidthSent"),framesCorrupted:void 0,framesDecoded:H(e,"framesDecoded"),framesDropped:void 0,framesPerSecond:void 0,framesReceived:void 0,framesSent:H(e,"framesEncoded"),fullFramesLost:void 0,id:e.id,kind:e.stat("mediaType"),partialFramesLost:void 0,remoteSource:void 0,ssrcIds:void 0,timestamp:Date.parse(e.timestamp),trackIdentifier:e.stat("googTrackId"),type:"track"}}function Qd(e,t){return{associateStatsId:void 0,codecId:`codec-${e.id}`,firCount:t?H(e,"googFirsSent"):void 0,id:e.id,isRemote:void 0,mediaType:e.stat("mediaType"),nackCount:t?H(e,"googNacksSent"):H(e,"googNacksReceived"),pliCount:t?H(e,"googPlisSent"):H(e,"googPlisReceived"),qpSum:H(e,"qpSum"),sliCount:void 0,ssrc:e.stat("ssrc"),timestamp:Date.parse(e.timestamp),trackId:`track-${e.id}`,transportId:e.stat("transportId")}}function cm(e){const t=Qd(e,!0);return Object.assign(t,{burstDiscardCount:void 0,burstDiscardRate:void 0,burstLossCount:void 0,burstLossRate:void 0,burstPacketsDiscarded:void 0,burstPacketsLost:void 0,bytesReceived:H(e,"bytesReceived"),fractionLost:void 0,framesDecoded:H(e,"framesDecoded"),gapDiscardRate:void 0,gapLossRate:void 0,jitter:$o(e.stat("googJitterReceived")),packetsDiscarded:void 0,packetsLost:H(e,"packetsLost"),packetsReceived:H(e,"packetsReceived"),packetsRepaired:void 0,roundTripTime:$o(e.stat("googRtt")),type:"inbound-rtp"}),t}function dm(e){const t=Qd(e,!1);return Object.assign(t,{bytesSent:H(e,"bytesSent"),framesEncoded:H(e,"framesEncoded"),packetsSent:H(e,"packetsSent"),remoteTimestamp:void 0,targetBitrate:void 0,type:"outbound-rtp"}),t}function ru(e,t){return{candidateType:mm(e.stat("candidateType")),deleted:void 0,id:e.id,ip:e.stat("ipAddress"),isRemote:t,port:H(e,"portNumber"),priority:zo(e,"priority"),protocol:e.stat("transport"),relayProtocol:void 0,timestamp:Date.parse(e.timestamp),transportId:void 0,type:t?"remote-candidate":"local-candidate",url:void 0}}function hm(e){return{availableIncomingBitrate:void 0,availableOutgoingBitrate:void 0,bytesReceived:H(e,"bytesReceived"),bytesSent:H(e,"bytesSent"),consentRequestsSent:H(e,"consentRequestsSent"),currentRoundTripTime:$o(e.stat("googRtt")),id:e.id,lastPacketReceivedTimestamp:void 0,lastPacketSentTimestamp:void 0,localCandidateId:e.stat("localCandidateId"),nominated:void 0,priority:void 0,readable:void 0,remoteCandidateId:e.stat("remoteCandidateId"),requestsReceived:H(e,"requestsReceived"),requestsSent:H(e,"requestsSent"),responsesReceived:H(e,"responsesReceived"),responsesSent:H(e,"responsesSent"),retransmissionsReceived:void 0,retransmissionsSent:void 0,state:void 0,timestamp:Date.parse(e.timestamp),totalRoundTripTime:void 0,transportId:e.stat("googChannelId"),type:"candidate-pair",writable:Jd(e,"googWritable")}}function fm(e){return{base64Certificate:e.stat("googDerBase64"),fingerprint:e.stat("googFingerprint"),fingerprintAlgorithm:e.stat("googFingerprintAlgorithm"),id:e.id,issuerCertificateId:e.stat("googIssuerId"),timestamp:Date.parse(e.timestamp),type:"certificate"}}function pm(e){return{bytesReceived:void 0,bytesSent:void 0,datachannelid:e.stat("datachannelid"),id:e.id,label:e.stat("label"),messagesReceived:void 0,messagesSent:void 0,protocol:e.stat("protocol"),state:e.stat("state"),timestamp:Date.parse(e.timestamp),transportId:e.stat("transportId"),type:"data-channel"}}function $o(e){return isNaN(e)||e===""?void 0:parseInt(e,10)/1e3}function mm(e){switch(e){case"peerreflexive":return"prflx";case"serverreflexive":return"srflx";case"host":case"relay":default:return e}}function H(e,t){const n=e.stat(t);return an(e,t)?parseInt(n,10):void 0}function zo(e,t){const n=e.stat(t);return an(e,t)?parseFloat(n):void 0}function Jd(e,t){const n=e.stat(t);return an(e,t)?n==="true"||n===!0:void 0}function an(e,t){const n=e.stat(t);return typeof n<"u"&&n!==""}const gm="PeerConnection is null",vm="WebRTC statistics are unsupported";function gn(e,t){return typeof e.get=="function"?e.get(t):e.find(n=>n.id===t)}function Kd(e){if(!e)return Promise.reject(new W(gm));if(typeof e.getStats!="function")return Promise.reject(new me(vm));let t;try{t=e.getStats()}catch{t=new Promise(i=>e.getStats(i)).then(at.fromRTCStatsResponse)}return t}function _m(e,t){return t=Object.assign({createRTCSample:wm},t),Kd(e).then(t.createRTCSample)}function ym(e){return Kd(e).then(t=>{const{candidatePairs:n,localCandidates:i,remoteCandidates:r,transport:s}=Array.from(t.values()).reduce((l,u)=>{switch(["candidatePairs","localCandidates","remoteCandidates"].forEach(c=>{l[c]||(l[c]=[])}),u.type){case"candidate-pair":l.candidatePairs.push(u);break;case"local-candidate":l.localCandidates.push(u);break;case"remote-candidate":l.remoteCandidates.push(u);break;case"transport":u.selectedCandidatePairId&&(l.transport=u);break}return l},{}),o=n.find(l=>l.selected||s&&l.id===s.selectedCandidatePairId);let a;return o&&(a={localCandidate:i.find(l=>l.id===o.localCandidateId),remoteCandidate:r.find(l=>l.id===o.remoteCandidateId)}),{iceCandidateStats:[...i,...r],selectedIceCandidatePairStats:a}})}function Sm(){}function wm(e){let t=null;const n=new Sm;let i;Array.from(e.values()).forEach(l=>{if(l.isRemote)return;const u=l.type.replace("-","");if(i=i||l.timestamp,l.remoteId){const c=gn(e,l.remoteId);c&&c.roundTripTime&&(n.rtt=c.roundTripTime*1e3)}switch(u){case"inboundrtp":n.timestamp=n.timestamp||l.timestamp,n.jitter=l.jitter*1e3,n.packetsLost=l.packetsLost,n.packetsReceived=l.packetsReceived,n.bytesReceived=l.bytesReceived;break;case"outboundrtp":if(n.timestamp=l.timestamp,n.packetsSent=l.packetsSent,n.bytesSent=l.bytesSent,l.codecId){const c=gn(e,l.codecId);n.codecName=c?c.mimeType&&c.mimeType.match(/(.*\/)?(.*)/)[2]:l.codecId}break;case"transport":t=l.id;break}}),n.timestamp||(n.timestamp=i);const r=gn(e,t);if(!r)return n;const s=gn(e,r.selectedCandidatePairId);if(!s)return n;const o=gn(e,s.localCandidateId),a=gn(e,s.remoteCandidateId);return n.rtt||(n.rtt=s&&s.currentRoundTripTime*1e3),Object.assign(n,{localAddress:o&&(o.address||o.ip),remoteAddress:a&&(a.address||a.ip)}),n}class X extends Ye.EventEmitter{constructor(t,n){super(),this._hasInsightsErrored=!1,this._log=new ce("PreflightTest"),this._networkTiming={},this._options={codecPreferences:[T.Codec.PCMU,T.Codec.Opus],edge:"roaming",fakeMicInput:!1,logLevel:"error",signalingTimeoutMs:1e4},this._status=X.Status.Connecting,Object.assign(this._options,n),this._samples=[],this._warnings=[],this._startTime=Date.now(),this._initDevice(t,Object.assign(Object.assign({},this._options),{fileInputStream:this._options.fakeMicInput?this._getStreamFromFile():void 0}));const i=["codecPreferences","edge","fakeMicInput","logLevel","signalingTimeoutMs"],r=["audioContext","deviceFactory","fileInputStream","getRTCIceCandidateStatsReport","iceServers","rtcConfiguration"];if(typeof n=="object"){const s=Object.assign({},n);Object.keys(s).forEach(o=>{!i.includes(o)&&!r.includes(o)&&delete s[o],r.includes(o)&&(s[o]=!0)}),this._log.debug(".constructor",JSON.stringify(s))}}stop(){this._log.debug(".stop");const t=new xe.CallCancelledError;this._device?(this._device.once(P.EventName.Unregistered,()=>this._onFailed(t)),this._device.destroy()):this._onFailed(t)}_emitWarning(t,n,i){const r={name:t,description:n};i&&(r.rtcWarning=i),this._warnings.push(r),this._log.debug(`#${X.Events.Warning}`,JSON.stringify(r)),this.emit(X.Events.Warning,r)}_getCallQuality(t){return t>4.2?X.CallQuality.Excellent:t>=4.1&&t<=4.2?X.CallQuality.Great:t>=3.7&&t<=4?X.CallQuality.Good:t>=3.1&&t<=3.6?X.CallQuality.Fair:X.CallQuality.Degraded}_getReport(){var t,n,i;const r=this._getRTCStats(),s={start:this._startTime};this._endTime&&(s.end=this._endTime,s.duration=this._endTime-this._startTime);const o={callSid:this._callSid,edge:this._edge,iceCandidateStats:(n=(t=this._rtcIceCandidateStatsReport)===null||t===void 0?void 0:t.iceCandidateStats)!==null&&n!==void 0?n:[],networkTiming:this._networkTiming,samples:this._samples,selectedEdge:this._options.edge,stats:r,testTiming:s,totals:this._getRTCSampleTotals(),warnings:this._warnings},a=(i=this._rtcIceCandidateStatsReport)===null||i===void 0?void 0:i.selectedIceCandidatePairStats;return a&&(o.selectedIceCandidatePairStats=a,o.isTurnRequired=a.localCandidate.candidateType==="relay"||a.remoteCandidate.candidateType==="relay"),r&&(o.callQuality=this._getCallQuality(r.mos.average)),o}_getRTCSampleTotals(){if(this._latestSample)return Object.assign({},this._latestSample.totals)}_getRTCStats(){const t=this._samples.findIndex(i=>typeof i.mos=="number"&&i.mos>0),n=t>=0?this._samples.slice(t):[];if(!(!n||!n.length))return["jitter","mos","rtt"].reduce((i,r)=>{const s=n.map(o=>o[r]);return Object.assign(Object.assign({},i),{[r]:{average:Number((s.reduce((o,a)=>o+a)/s.length).toPrecision(5)),max:Math.max(...s),min:Math.min(...s)}})},{})}_getStreamFromFile(){const t=this._options.audioContext;if(!t)throw new me("Cannot fake input audio stream: AudioContext is not supported by this browser.");const n=new Audio(Jp);n.addEventListener("canplaythrough",()=>n.play()),typeof n.setAttribute=="function"&&n.setAttribute("crossorigin","anonymous");const i=t.createMediaElementSource(n),r=t.createMediaStreamDestination();return i.connect(r),r.stream}_initDevice(t,n){try{this._device=new(n.deviceFactory||P)(t,{chunderw:n.chunderw,codecPreferences:n.codecPreferences,edge:n.edge,eventgw:n.eventgw,fileInputStream:n.fileInputStream,logLevel:n.logLevel,preflight:!0}),this._device.once(P.EventName.Registered,()=>{this._onDeviceRegistered()}),this._device.once(P.EventName.Error,i=>{this._onDeviceError(i)}),this._device.register()}catch(i){setTimeout(()=>{this._onFailed(i)});return}this._signalingTimeoutTimer=setTimeout(()=>{this._onDeviceError(new Je.ConnectionError("WebSocket Connection Timeout"))},n.signalingTimeoutMs)}_onDeviceError(t){this._device.destroy(),this._onFailed(t)}_onDeviceRegistered(){return Te(this,void 0,void 0,function*(){if(clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._call=yield this._device.connect({rtcConfiguration:this._options.rtcConfiguration}),this._networkTiming.signaling={start:Date.now()},this._setupCallHandlers(this._call),this._edge=this._device.edge||void 0,this._options.fakeMicInput){this._echoTimer=setTimeout(()=>this._device.disconnectAll(),Kp);const n=this._device.audio;n&&(n.disconnect(!1),n.outgoing(!1))}this._call.once("disconnect",()=>{this._device.once(P.EventName.Unregistered,()=>this._onUnregistered()),this._device.destroy()}),this._call._publisher.on("error",()=>{this._hasInsightsErrored||this._emitWarning("insights-connection-error","Received an error when attempting to connect to Insights gateway"),this._hasInsightsErrored=!0})})}_onFailed(t){clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._releaseHandlers(),this._endTime=Date.now(),this._status=X.Status.Failed,this._log.debug(`#${X.Events.Failed}`,t),this.emit(X.Events.Failed,t)}_onUnregistered(){setTimeout(()=>{this._status!==X.Status.Failed&&(clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._releaseHandlers(),this._endTime=Date.now(),this._status=X.Status.Completed,this._report=this._getReport(),this._log.debug(`#${X.Events.Completed}`,JSON.stringify(this._report)),this.emit(X.Events.Completed,this._report))},10)}_releaseHandlers(){[this._device,this._call].forEach(t=>{t&&t.eventNames().forEach(n=>t.removeAllListeners(n))})}_setupCallHandlers(t){this._options.fakeMicInput&&t.once("volume",()=>{t._mediaHandler.outputs.forEach(n=>n.audio.muted=!0)}),t.on("warning",(n,i)=>{this._emitWarning(n,"Received an RTCWarning. See .rtcWarning for the RTCWarning",i)}),t.once("accept",()=>{this._callSid=t._mediaHandler.callSid,this._status=X.Status.Connected,this._log.debug(`#${X.Events.Connected}`),this.emit(X.Events.Connected)}),t.on("sample",n=>Te(this,void 0,void 0,function*(){this._latestSample||(this._rtcIceCandidateStatsReport=yield(this._options.getRTCIceCandidateStatsReport||ym)(t._mediaHandler.version.pc)),this._latestSample=n,this._samples.push(n),this._log.debug(`#${X.Events.Sample}`,JSON.stringify(n)),this.emit(X.Events.Sample,n)})),[{reportLabel:"peerConnection",type:"pcconnection"},{reportLabel:"ice",type:"iceconnection"},{reportLabel:"dtls",type:"dtlstransport"},{reportLabel:"signaling",type:"signaling"}].forEach(({type:n,reportLabel:i})=>{const r=`on${n}statechange`,s=t._mediaHandler[r];t._mediaHandler[r]=o=>{const a=this._networkTiming[i]=this._networkTiming[i]||{start:0};o==="connecting"||o==="checking"?a.start=Date.now():(o==="connected"||o==="stable")&&!a.duration&&(a.end=Date.now(),a.duration=a.end-a.start),s(o)}})}get callSid(){return this._callSid}get endTime(){return this._endTime}get latestSample(){return this._latestSample}get report(){return this._report}get startTime(){return this._startTime}get status(){return this._status}}(function(e){(function(t){t.Excellent="excellent",t.Great="great",t.Good="good",t.Fair="fair",t.Degraded="degraded"})(e.CallQuality||(e.CallQuality={})),function(t){t.Completed="completed",t.Connected="connected",t.Failed="failed",t.Sample="sample",t.Warning="warning"}(e.Events||(e.Events={})),function(t){t.Connecting="connecting",t.Connected="connected",t.Completed="completed",t.Failed="failed"}(e.Status||(e.Status={}))})(X||(X={}));const vn=globalThis.WebSocket,xm=1e4,Cm=5e3,su=15e3,km=15e3,Em=1/0,Tm=75e3,Pm=1e3,bm=2e4,Im=6e4;var Me;(function(e){e.Connecting="connecting",e.Closed="closed",e.Open="open"})(Me||(Me={}));class ls extends Ye.EventEmitter{constructor(t,n={}){super(),this.state=Me.Closed,this._backoffStartTime={preferred:null,primary:null},this._connectedUri=null,this._log=new ce("WSTransport"),this._retryAfter=null,this._shouldFallback=!1,this._uriIndex=0,this._moveUriIndex=()=>{this._uriIndex++,this._uriIndex>=this._uris.length&&(this._uriIndex=0)},this._onSocketClose=i=>{if(this._log.error(`Received websocket close event code: ${i.code}. Reason: ${i.reason}`),i.code===1006||i.code===1015){this.emit("error",{code:31005,message:i.reason||"Websocket connection to Twilio's signaling servers were unexpectedly ended. If this is happening consistently, there may be an issue resolving the hostname provided. If a region or an edge is being specified in Device setup, ensure it is valid.",twilioError:new Je.ConnectionError});const r=this.state===Me.Open||this._previousState===Me.Open;(this._shouldFallback||!r)&&this._moveUriIndex(),this._shouldFallback=!0}this._closeSocket()},this._onSocketError=i=>{this._log.error(`WebSocket received error: ${i.message}`),this.emit("error",{code:31e3,message:i.message||"WSTransport socket error",twilioError:new Je.ConnectionDisconnected})},this._onSocketMessage=i=>{if(this._setHeartbeatTimeout(),this._socket&&i.data===`
`){this._socket.send(`
`),this._log.debug("heartbeat");return}if(i&&typeof i.data=="string"){this._log.debug(`Received: ${i.data}`);const{type:r,payload:s={}}=JSON.parse(i.data);r==="error"&&s.error&&s.error.retryAfter&&(this._retryAfter=s.error.retryAfter*1e3)}this.emit("message",i)},this._onSocketOpen=()=>{this._log.info("WebSocket opened successfully."),this._timeOpened=Date.now(),this._shouldFallback=!1,this._setState(Me.Open),clearTimeout(this._connectTimeout),this._backoff&&this._resetBackoffs(),this._setHeartbeatTimeout(),this.emit("open")},this._options=Object.assign(Object.assign({},ls.defaultConstructorOptions),n),this._uris=t,this._backoff=null}close(){this._log.info("WSTransport.close() called..."),this._close()}open(){if(this._log.info("WSTransport.open() called..."),this._socket&&(this._socket.readyState===vn.CONNECTING||this._socket.readyState===vn.OPEN)){this._log.info("WebSocket already open.");return}this._preferredUri?this._connect(this._preferredUri):this._connect(this._uris[this._uriIndex])}send(t){if(this._log.debug(`Sending: ${t}`),!this._socket||this._socket.readyState!==vn.OPEN)return this._log.debug("Cannot send message. WebSocket is not open."),!1;try{this._socket.send(t)}catch(n){return this._log.error("Error while sending message:",n.message),this._closeSocket(),!1}return!0}updatePreferredURI(t){this._preferredUri=t}updateURIs(t){typeof t=="string"&&(t=[t]),this._uris=t,this._uriIndex=0}_close(){this._setState(Me.Closed),this._closeSocket()}_closeSocket(){if(clearTimeout(this._connectTimeout),clearTimeout(this._heartbeatTimeout),this._log.info("Closing and cleaning up WebSocket..."),!this._socket){this._log.info("No WebSocket to clean up.");return}this._socket.removeEventListener("close",this._onSocketClose),this._socket.removeEventListener("error",this._onSocketError),this._socket.removeEventListener("message",this._onSocketMessage),this._socket.removeEventListener("open",this._onSocketOpen),(this._socket.readyState===vn.CONNECTING||this._socket.readyState===vn.OPEN)&&this._socket.close(),this._backoff&&this._timeOpened&&Date.now()-this._timeOpened>xm&&this._resetBackoffs(),this.state!==Me.Closed&&(this._backoff||(this._backoff=this._setupBackoffs()),this._performBackoff()),delete this._socket,this.emit("close")}_connect(t,n){this._log.info(typeof n=="number"?`Attempting to reconnect (retry #${n})...`:"Attempting to connect..."),this._closeSocket(),this._setState(Me.Connecting),this._connectedUri=t;try{this._socket=new this._options.WebSocket(this._connectedUri)}catch(i){this._log.error("Could not connect to endpoint:",i.message),this._close(),this.emit("error",{code:31e3,message:i.message||`Could not connect to ${this._connectedUri}`,twilioError:new Je.ConnectionDisconnected});return}this._socket.addEventListener("close",this._onSocketClose),this._socket.addEventListener("error",this._onSocketError),this._socket.addEventListener("message",this._onSocketMessage),this._socket.addEventListener("open",this._onSocketOpen),delete this._timeOpened,this._connectTimeout=setTimeout(()=>{this._log.info("WebSocket connection attempt timed out."),this._moveUriIndex(),this._closeSocket()},this._options.connectTimeoutMs)}_performBackoff(){if(!this._backoff){this._log.info("No backoff instance to perform backoff.");return}this._preferredUri?(this._log.info("Preferred URI set; backing off."),this._backoff.preferred.backoff()):(this._log.info("Preferred URI not set; backing off."),this._backoff.primary.backoff())}_resetBackoffs(){if(!this._backoff){this._log.info("No backoff instance to reset.");return}this._backoff.preferred.removeAllListeners("backoff"),this._backoff.preferred.removeAllListeners("ready"),this._backoff.primary.removeAllListeners("backoff"),this._backoff.primary.removeAllListeners("ready"),this._backoff=null,this._retryAfter=null,this._backoffStartTime.preferred=null,this._backoffStartTime.primary=null}_setHeartbeatTimeout(){clearTimeout(this._heartbeatTimeout),this._heartbeatTimeout=setTimeout(()=>{this._log.info(`No messages received in ${su/1e3} seconds. Reconnecting...`),this._shouldFallback=!0,this._closeSocket()},su)}_setState(t){this._previousState=this.state,this.state=t}_setupBackoffs(){const t=this._retryAfter!==null&&this._preferredUri?this._retryAfter:null;t&&this._log.info(`Setting initial preferred backoff value to retryAfter: ${t}ms`);const n=t?this._options.maxRetryAfterDurationMs:this._options.maxPreferredDurationMs,i={factor:2,jitter:.4,max:t?this._options.maxRetryAfterDelayMs:this._options.maxPreferredDelayMs,min:t||100,useInitialValue:!!t};this._log.info("Initializing preferred transport backoff using config: ",i);const r=new Do(i);r.on("backoff",(a,l)=>{if(this.state===Me.Closed){this._log.info("Preferred backoff initiated but transport state is closed; not attempting a connection.");return}this._log.info(`Will attempt to reconnect Websocket to preferred URI in ${l}ms`),a===0&&(this._backoffStartTime.preferred=Date.now(),this._log.info(`Preferred backoff start; ${this._backoffStartTime.preferred}`))}),r.on("ready",(a,l)=>{if(this.state===Me.Closed){this._log.info("Preferred backoff ready but transport state is closed; not attempting a connection.");return}if(this._backoffStartTime.preferred===null){this._log.info("Preferred backoff start time invalid; not attempting a connection.");return}if(!this._backoff){this._log.info("Preferred backoff instance invalid; not attempting a connection.");return}if(Date.now()-this._backoffStartTime.preferred>n){this._log.info("Max preferred backoff attempt time exceeded; falling back to primary backoff."),this._preferredUri=null,this._backoff.primary.backoff();return}if(typeof this._preferredUri!="string"){this._log.info("Preferred URI cleared; falling back to primary backoff."),this._preferredUri=null,this._backoff.primary.backoff();return}this._connect(this._preferredUri,a+1)});const s={factor:2,jitter:.4,max:this._options.maxPrimaryDelayMs,min:this._uris&&this._uris.length>1?Math.floor(Math.random()*4001)+1e3:100};this._log.info("Initializing primary transport backoff using config: ",s);const o=new Do(s);return o.on("backoff",(a,l)=>{if(this.state===Me.Closed){this._log.info("Primary backoff initiated but transport state is closed; not attempting a connection.");return}this._log.info(`Will attempt to reconnect WebSocket in ${l}ms`),a===0&&(this._backoffStartTime.primary=Date.now(),this._log.info(`Primary backoff start; ${this._backoffStartTime.primary}`))}),o.on("ready",(a,l)=>{if(this.state===Me.Closed){this._log.info("Primary backoff ready but transport state is closed; not attempting a connection.");return}if(this._backoffStartTime.primary===null){this._log.info("Primary backoff start time invalid; not attempting a connection.");return}if(Date.now()-this._backoffStartTime.primary>this._options.maxPrimaryDurationMs){this._log.info("Max primary backoff attempt time exceeded; not attempting a connection.");return}this._connect(this._uris[this._uriIndex],a+1)}),{preferred:r,primary:o}}get uri(){return this._connectedUri}}ls.defaultConstructorOptions={WebSocket:vn,connectTimeoutMs:Cm,maxPreferredDelayMs:Pm,maxPreferredDurationMs:km,maxPrimaryDelayMs:bm,maxPrimaryDurationMs:Em,maxRetryAfterDelayMs:Im,maxRetryAfterDurationMs:Tm};const Rm="1.6",Am=30;class K extends Ye.EventEmitter{constructor(t,n,i){if(super(),!(this instanceof K))return new K(t,n,i);const r={TransportFactory:ls};i=i||{};for(const o in r)o in i||(i[o]=r[o]);this.options=i,this.token=t||"",this.status="disconnected",this.gateway=null,this.region=null,this._messageQueue=[],this._preferredUri=null,this._uris=n,this._handleTransportClose=this._handleTransportClose.bind(this),this._handleTransportError=this._handleTransportError.bind(this),this._handleTransportMessage=this._handleTransportMessage.bind(this),this._handleTransportOpen=this._handleTransportOpen.bind(this),this._log=new ce("PStream"),this.on("error",()=>{this._log.warn("Unexpected error handled in pstream")});const s=this;return this.addListener("ready",()=>{s.status="ready"}),this.addListener("offline",()=>{s.status="offline"}),this.addListener("close",()=>{s._log.info('Received "close" from server. Destroying PStream...'),s._destroy()}),this.transport=new this.options.TransportFactory(this._uris,{backoffMaxMs:this.options.backoffMaxMs,maxPreferredDurationMs:this.options.maxPreferredDurationMs}),Object.defineProperties(this,{uri:{enumerable:!0,get(){return this.transport.uri}}}),this.transport.on("close",this._handleTransportClose),this.transport.on("error",this._handleTransportError),this.transport.on("message",this._handleTransportMessage),this.transport.on("open",this._handleTransportOpen),this.transport.open(),this}}K.prototype._handleTransportClose=function(){this.emit("transportClose"),this.status!=="disconnected"&&(this.status!=="offline"&&this.emit("offline",this),this.status="disconnected")};K.prototype._handleTransportError=function(e){if(!e){this.emit("error",{error:{code:31e3,message:"Websocket closed without a provided reason",twilioError:new Je.ConnectionDisconnected}});return}this.emit("error",typeof e.code<"u"?{error:e}:e)};K.prototype._handleTransportMessage=function(e){if(!e||!e.data||typeof e.data!="string")return;const{type:t,payload:n={}}=JSON.parse(e.data);this.gateway=n.gateway||this.gateway,this.region=n.region||this.region,t==="error"&&n.error&&(n.error.twilioError=new Je.ConnectionError),this.emit(t,n)};K.prototype._handleTransportOpen=function(){this.status="connected",this.setToken(this.token),this.emit("transportOpen"),this._messageQueue.splice(0,this._messageQueue.length).forEach(t=>this._publish(...t))};K.toString=()=>"[Twilio.PStream class]";K.prototype.toString=()=>"[Twilio.PStream instance]";K.prototype.setToken=function(e){this._log.info("Setting token and publishing listen"),this.token=e;let t=0;const n=this.options.maxPreferredDurationMs;this._log.info(`maxPreferredDurationMs:${n}`),typeof n=="number"&&n>=0&&(t=Math.min(Math.ceil(n/1e3),Am)),this._log.info(`reconnectTimeout:${t}`);const i={browserinfo:Nm(),reconnectTimeout:t,token:e};this._publish("listen",i)};K.prototype.sendMessage=function(e,t,n="application/json",i,r){const s={callsid:e,content:t,contenttype:n,messagetype:i,voiceeventsid:r};this._publish("message",s,!0)};K.prototype.register=function(e){const t={media:e};this._publish("register",t,!0)};K.prototype.invite=function(e,t,n){const i={callsid:t,sdp:e,twilio:n?{params:n}:{}};this._publish("invite",i,!0)};K.prototype.reconnect=function(e,t,n){const i={callsid:t,reconnect:n,sdp:e,twilio:{}};this._publish("invite",i,!0)};K.prototype.answer=function(e,t){this._publish("answer",{sdp:e,callsid:t},!0)};K.prototype.dtmf=function(e,t){this._publish("dtmf",{callsid:e,dtmf:t},!0)};K.prototype.hangup=function(e,t){const n=t?{callsid:e,message:t}:{callsid:e};this._publish("hangup",n,!0)};K.prototype.reject=function(e){this._publish("reject",{callsid:e},!0)};K.prototype.reinvite=function(e,t){this._publish("reinvite",{sdp:e,callsid:t},!1)};K.prototype._destroy=function(){this.transport.removeListener("close",this._handleTransportClose),this.transport.removeListener("error",this._handleTransportError),this.transport.removeListener("message",this._handleTransportMessage),this.transport.removeListener("open",this._handleTransportOpen),this.transport.close(),this.emit("offline",this)};K.prototype.destroy=function(){return this._log.info("PStream.destroy() called..."),this._destroy(),this};K.prototype.updatePreferredURI=function(e){this._preferredUri=e,this.transport.updatePreferredURI(e)};K.prototype.updateURIs=function(e){this._uris=e,this.transport.updateURIs(this._uris)};K.prototype.publish=function(e,t){return this._publish(e,t,!0)};K.prototype._publish=function(e,t,n){const i=JSON.stringify({payload:t,type:e,version:Rm});!!this.transport.send(i)||(this.emit("error",{error:{code:31009,message:"No transport available to send or receive messages",twilioError:new xe.TransportError}}),n&&this._messageQueue.push([e,t,!0]))};function Nm(){const e=typeof navigator<"u"?navigator:{};return{browser:{platform:e.platform||"unknown",userAgent:e.userAgent||"unknown"},p:"browser",plugin:"rtc",v:On}}var ee;(function(e){e.Sydney="sydney",e.SaoPaulo="sao-paulo",e.Dublin="dublin",e.Frankfurt="frankfurt",e.Tokyo="tokyo",e.Singapore="singapore",e.Ashburn="ashburn",e.Umatilla="umatilla",e.Roaming="roaming",e.AshburnIx="ashburn-ix",e.SanJoseIx="san-jose-ix",e.LondonIx="london-ix",e.FrankfurtIx="frankfurt-ix",e.SingaporeIx="singapore-ix",e.SydneyIx="sydney-ix",e.TokyoIx="tokyo-ix"})(ee||(ee={}));var V;(function(e){e.Au1="au1",e.Au1Ix="au1-ix",e.Br1="br1",e.De1="de1",e.De1Ix="de1-ix",e.Gll="gll",e.Ie1="ie1",e.Ie1Ix="ie1-ix",e.Ie1Tnx="ie1-tnx",e.Jp1="jp1",e.Jp1Ix="jp1-ix",e.Sg1="sg1",e.Sg1Ix="sg1-ix",e.Sg1Tnx="sg1-tnx",e.Us1="us1",e.Us1Ix="us1-ix",e.Us1Tnx="us1-tnx",e.Us2="us2",e.Us2Ix="us2-ix",e.Us2Tnx="us2-tnx"})(V||(V={}));const Dm={ASIAPAC_SINGAPORE:V.Sg1,ASIAPAC_SYDNEY:V.Au1,ASIAPAC_TOKYO:V.Jp1,EU_FRANKFURT:V.De1,EU_IRELAND:V.Ie1,SOUTH_AMERICA_SAO_PAULO:V.Br1,US_EAST_VIRGINIA:V.Us1,US_WEST_OREGON:V.Us2},Lm={[V.Au1]:ee.Sydney,[V.Br1]:ee.SaoPaulo,[V.Ie1]:ee.Dublin,[V.De1]:ee.Frankfurt,[V.Jp1]:ee.Tokyo,[V.Sg1]:ee.Singapore,[V.Us1]:ee.Ashburn,[V.Us2]:ee.Umatilla,[V.Gll]:ee.Roaming,[V.Us1Ix]:ee.AshburnIx,[V.Us2Ix]:ee.SanJoseIx,[V.Ie1Ix]:ee.LondonIx,[V.De1Ix]:ee.FrankfurtIx,[V.Sg1Ix]:ee.SingaporeIx,[V.Au1Ix]:ee.SydneyIx,[V.Jp1Ix]:ee.TokyoIx,[V.Us1Tnx]:ee.AshburnIx,[V.Us2Tnx]:ee.AshburnIx,[V.Ie1Tnx]:ee.LondonIx,[V.Sg1Tnx]:ee.SingaporeIx},jm=ee.Roaming,Mm="eventgw.twilio.com";function ou(e){return`voice-js.${e}.twilio.com`}function au(e){return e?`eventgw.${e}.twilio.com`:Mm}function lu(e){return`wss://${e}/signal`}function uu(e){if(e&&typeof e!="string"&&!Array.isArray(e))throw new W("If `edge` is provided, it must be of type `string` or an array of strings.");let t;return e?t=(Array.isArray(e)?e:[e]).map(i=>ou(i)):t=[ou(jm)],t}function Om(e){return Dm[e]||null}const cu={0:"PCMU",8:"PCMA"},Um=111,Fm=51e4,$m=6e3;function zm(e){const[,t,n]=/a=rtpmap:(\d+) (\S+)/m.exec(e)||[null,"",""],i=new RegExp(`a=fmtp:${t} (\\S+)`,"m"),[,r]=i.exec(e)||[null,""];return{codecName:n,codecParams:r}}function Vm(e){return za(window,window.navigator)?e.split(`
`).filter(t=>t.indexOf("a=ice-lite")===-1).join(`
`):e}function qd(e,t){if(typeof t!="number"||t<$m||t>Fm)return e;const n=/a=rtpmap:(\d+) opus/m.exec(e),i=n&&n.length?n[1]:Um,r=new RegExp(`a=fmtp:${i}`);return e.split(`
`).map(o=>r.test(o)?o+`;maxaveragebitrate=${t}`:o).join(`
`)}function Yd(e,t){const n=Wm(e);return[e.split(`\r
m=`)[0]].concat(n.map(r=>{if(!/^m=(audio|video)/.test(r))return r;const s=r.match(/^m=(audio|video)/)[1],o=Hm(r),a=Bm(o,t),l=Gm(a,r),u=o.get("pcma")||[],c=o.get("pcmu")||[];return(s==="audio"?new Set(u.concat(c)):new Set).has(a[0])?l.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):l})).join(`\r
`)}function Wm(e,t,n){return e.replace(/\r\n\r\n$/,`\r
`).split(`\r
m=`).slice(1).map(i=>`m=${i}`).filter(i=>{const r=new RegExp("m=.*","gm"),s=new RegExp("a=.*","gm");return r.test(i)&&s.test(i)})}function Hm(e){return Array.from(Qm(e)).reduce((t,n)=>{const i=n[0],r=n[1],s=t.get(r)||[];return t.set(r,s.concat(i))},new Map)}function Bm(e,t){t=t.map(s=>s.toLowerCase());const n=Oo(t,s=>e.get(s)||[]),i=$a(Array.from(e.keys()),t),r=Oo(i,s=>e.get(s));return n.concat(r)}function Gm(e,t){const n=t.split(`\r
`);let i=n[0];const r=n.slice(1);return i=i.replace(/([0-9]+\s?)+$/,e.join(" ")),[i].concat(r).join(`\r
`)}function Qm(e){return Jm(e).reduce((t,n)=>{const i=new RegExp(`a=rtpmap:${n} ([^/]+)`),r=e.match(i),s=r?r[1].toLowerCase():cu[n]?cu[n].toLowerCase():"";return t.set(n,s)},new Map)}function Jm(e){const n=e.split(`\r
`)[0].match(/([0-9]+)/g);return n?n.slice(1).map(i=>parseInt(i,10)):[]}function ze(e){if(this.log=new ce("RTCPC"),typeof window>"u"){this.log.info("No RTCPeerConnection implementation available. The window object was not found.");return}e&&e.RTCPeerConnection?this.RTCPeerConnection=e.RTCPeerConnection:typeof window.RTCPeerConnection=="function"?this.RTCPeerConnection=window.RTCPeerConnection:typeof window.webkitRTCPeerConnection=="function"?this.RTCPeerConnection=webkitRTCPeerConnection:typeof window.mozRTCPeerConnection=="function"?(this.RTCPeerConnection=mozRTCPeerConnection,window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate):this.log.info("No RTCPeerConnection implementation available")}ze.prototype.create=function(e){this.pc=new this.RTCPeerConnection(e)};ze.prototype.createModernConstraints=e=>{if(typeof e>"u")return null;const t=Object.assign({},e);return typeof webkitRTCPeerConnection<"u"&&!as()?(t.mandatory={},typeof e.audio<"u"&&(t.mandatory.OfferToReceiveAudio=e.audio),typeof e.video<"u"&&(t.mandatory.OfferToReceiveVideo=e.video)):(typeof e.audio<"u"&&(t.offerToReceiveAudio=e.audio),typeof e.video<"u"&&(t.offerToReceiveVideo=e.video)),delete t.audio,delete t.video,t};ze.prototype.createOffer=function(e,t,n,i){return t=this.createModernConstraints(t),Zd(this.pc.createOffer,this.pc)(t).then(r=>{if(!this.pc)return Promise.resolve();const s=qd(r.sdp,e);return us(this.pc.setLocalDescription,this.pc)(new RTCSessionDescription({sdp:s,type:"offer"}))}).then(n,i)};ze.prototype.createAnswer=function(e,t,n,i){return t=this.createModernConstraints(t),Zd(this.pc.createAnswer,this.pc)(t).then(r=>{if(!this.pc)return Promise.resolve();const s=qd(r.sdp,e);return us(this.pc.setLocalDescription,this.pc)(new RTCSessionDescription({sdp:s,type:"answer"}))}).then(n,i)};ze.prototype.processSDP=function(e,t,n,i,r,s){n=Yd(n,t);const o=new RTCSessionDescription({sdp:n,type:"offer"});return us(this.pc.setRemoteDescription,this.pc)(o).then(()=>{this.createAnswer(e,i,r,s)})};ze.prototype.getSDP=function(){return this.pc.localDescription.sdp};ze.prototype.processAnswer=function(e,t,n,i){return this.pc?(t=Yd(t,e),us(this.pc.setRemoteDescription,this.pc)(new RTCSessionDescription({sdp:t,type:"answer"})).then(n,i)):Promise.resolve()};ze.test=()=>{if(typeof navigator=="object"){const e=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.getUserMedia;if(as(navigator))return!1;if(e&&typeof window.RTCPeerConnection=="function")return!0;if(e&&typeof window.webkitRTCPeerConnection=="function")return!0;if(e&&typeof window.mozRTCPeerConnection=="function"){try{if(typeof new window.mozRTCPeerConnection().getLocalStreams!="function")return!1}catch{return!1}return!0}else if(typeof RTCIceGatherer<"u")return!0}return!1};function Xd(e,t,n,i){return function(){const r=Array.prototype.slice.call(arguments);return new Promise(s=>{const o=e.apply(t,r);if(!i){s(o);return}if(typeof o=="object"&&typeof o.then=="function")s(o);else throw new Error}).catch(()=>new Promise((s,o)=>{e.apply(t,n?[s,o].concat(r):r.concat([s,o]))}))}}function Zd(e,t){return Xd(e,t,!0,!0)}function us(e,t){return Xd(e,t,!1,!1)}const Km=15e3,qm="none",Ym="timeout",Xm="new",du=50;function L(e,t,n){if(!e||!t)throw new W("Audiohelper, and pstream are required arguments");if(!(this instanceof L))return new L(e,t,n);this._log=new ce("PeerConnection");function i(){this._log.warn("Unexpected noop call in peerconnection")}this.onaudio=i,this.onopen=i,this.onerror=i,this.onclose=i,this.ondisconnected=i,this.onfailed=i,this.onconnected=i,this.onreconnected=i,this.onsignalingstatechange=i,this.ondtlstransportstatechange=i,this.onicegatheringfailure=i,this.onicegatheringstatechange=i,this.oniceconnectionstatechange=i,this.onpcconnectionstatechange=i,this.onicecandidate=i,this.onselectedcandidatepairchange=i,this.onvolume=i,this.version=null,this.pstream=t,this.stream=null,this.sinkIds=new Set(["default"]),this.outputs=new Map,this.status="connecting",this.callSid=null,this.isMuted=!1;const r=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);return this._isSinkSupported=!!r&&typeof HTMLAudioElement<"u"&&HTMLAudioElement.prototype.setSinkId,this._audioContext=r&&e._audioContext,this._audioHelper=e,this._audioProcessorEventObserver=e._getAudioProcessorEventObserver(),this._hasIceCandidates=!1,this._hasIceGatheringFailures=!1,this._iceGatheringTimeoutId=null,this._masterAudio=null,this._masterAudioDeviceId=null,this._mediaStreamSource=null,this._dtmfSender=null,this._dtmfSenderUnsupported=!1,this._callEvents=[],this._nextTimeToPublish=Date.now(),this._onAnswerOrRinging=i,this._onHangup=i,this._remoteStream=null,this._shouldManageStream=!0,this._iceState=Xm,this.options=n=n||{},this.navigator=n.navigator||(typeof navigator<"u"?navigator:null),this.util=n.util||Gd,this.codecPreferences=n.codecPreferences,this._onAudioProcessorAdded=s=>{this._handleAudioProcessorEvent(s,!0)},this._onAudioProcessorRemoved=s=>{this._handleAudioProcessorEvent(s,!1)},this._audioProcessorEventObserver.on("add",this._onAudioProcessorAdded),this._audioProcessorEventObserver.on("remove",this._onAudioProcessorRemoved),this}L.prototype.uri=function(){return this._uri};L.prototype.openDefaultDeviceWithConstraints=function(e){return this._audioHelper._openDefaultDeviceWithConstraints(e).then(this._setInputTracksFromStream.bind(this,!1))};L.prototype.setInputTracksFromStream=function(e){const t=this;return this._setInputTracksFromStream(!0,e).then(()=>{t._shouldManageStream=!1})};L.prototype._createAnalyser=(e,t)=>{t=Object.assign({fftSize:32,smoothingTimeConstant:.3},t);const n=e.createAnalyser();for(const i in t)n[i]=t[i];return n};L.prototype._setVolumeHandler=function(e){this.onvolume=e};L.prototype._startPollingVolume=function(){if(!this._audioContext||!this.stream||!this._remoteStream)return;const e=this._audioContext,n=(this._inputAnalyser=this._createAnalyser(e)).frequencyBinCount,i=new Uint8Array(n);this._inputAnalyser2=this._createAnalyser(e,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0});const s=(this._outputAnalyser=this._createAnalyser(e)).frequencyBinCount,o=new Uint8Array(s);this._outputAnalyser2=this._createAnalyser(e,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0}),this._updateInputStreamSource(this.stream),this._updateOutputStreamSource(this._remoteStream);const a=this;setTimeout(function l(){if(a._audioContext){if(a.status==="closed"){a._inputAnalyser.disconnect(),a._outputAnalyser.disconnect(),a._inputAnalyser2.disconnect(),a._outputAnalyser2.disconnect();return}}else return;a._inputAnalyser.getByteFrequencyData(i);const u=a.util.average(i);a._inputAnalyser2.getByteFrequencyData(i);const c=a.util.average(i);a._outputAnalyser.getByteFrequencyData(o);const d=a.util.average(o);a._outputAnalyser2.getByteFrequencyData(o);const h=a.util.average(o);a.onvolume(u/255,d/255,c,h),setTimeout(l,du)},du)};L.prototype._stopStream=function(){this._shouldManageStream&&this._audioHelper._stopDefaultInputDeviceStream()};L.prototype._updateInputStreamSource=function(e){this._inputStreamSource&&this._inputStreamSource.disconnect();try{this._inputStreamSource=this._audioContext.createMediaStreamSource(e),this._inputStreamSource.connect(this._inputAnalyser),this._inputStreamSource.connect(this._inputAnalyser2)}catch(t){this._log.warn("Unable to update input MediaStreamSource",t),this._inputStreamSource=null}};L.prototype._updateOutputStreamSource=function(e){this._outputStreamSource&&this._outputStreamSource.disconnect();try{this._outputStreamSource=this._audioContext.createMediaStreamSource(e),this._outputStreamSource.connect(this._outputAnalyser),this._outputStreamSource.connect(this._outputAnalyser2)}catch(t){this._log.warn("Unable to update output MediaStreamSource",t),this._outputStreamSource=null}};L.prototype._setInputTracksFromStream=function(e,t){if(!t)return Promise.reject(new W("Can not set input stream to null while in a call"));if(!t.getAudioTracks().length)return Promise.reject(new W("Supplied input stream has no audio tracks"));const n=this.stream,i=()=>(this.mute(this.isMuted),Promise.resolve(this.stream));if(!n)this.stream=e?hu(t,this.options.MediaStream):t;else return this._shouldManageStream&&this._stopStream(),this._sender||(this._sender=this.version.pc.getSenders()[0]),this._sender.replaceTrack(t.getAudioTracks()[0]).then(()=>(this._updateInputStreamSource(t),this.stream=e?hu(t,this.options.MediaStream):t,i()));return i()};L.prototype._onInputDevicesChanged=function(){if(!this.stream)return;this.stream.getAudioTracks().every(t=>t.readyState==="ended")&&this._shouldManageStream&&this.openDefaultDeviceWithConstraints({audio:!0})};L.prototype._onIceGatheringFailure=function(e){this._hasIceGatheringFailures=!0,this.onicegatheringfailure(e)};L.prototype._onMediaConnectionStateChange=function(e){const t=this._iceState;if(t===e||e!=="connected"&&e!=="disconnected"&&e!=="failed")return;this._iceState=e;let n;switch(e){case"connected":t==="disconnected"||t==="failed"?(n="ICE liveliness check succeeded. Connection with Twilio restored",this._log.info(n),this.onreconnected(n)):(n="Media connection established.",this._log.info(n),this.onconnected(n)),this._stopIceGatheringTimeout(),this._hasIceGatheringFailures=!1;break;case"disconnected":n="ICE liveliness check failed. May be having trouble connecting to Twilio",this._log.warn(n),this.ondisconnected(n);break;case"failed":n="Connection with Twilio was interrupted.",this._log.warn(n),this.onfailed(n);break}};L.prototype._setSinkIds=function(e){return this._isSinkSupported?(this.sinkIds=new Set(e.forEach?e:[e]),this.version?this._updateAudioOutputs():Promise.resolve()):Promise.reject(new me("Audio output selection is not supported by this browser"))};L.prototype._startIceGatheringTimeout=function(){this._stopIceGatheringTimeout(),this._iceGatheringTimeoutId=setTimeout(()=>{this._onIceGatheringFailure(Ym)},Km)};L.prototype._stopIceGatheringTimeout=function(){clearInterval(this._iceGatheringTimeoutId)};L.prototype._updateAudioOutputs=function(){const t=Array.from(this.sinkIds).filter(function(s){return!this.outputs.has(s)},this),n=Array.from(this.outputs.keys()).filter(function(s){return!this.sinkIds.has(s)},this),i=this,r=t.map(this._createAudioOutput,this);return Promise.all(r).then(()=>Promise.all(n.map(i._removeAudioOutput,i)))};L.prototype._createAudio=function(t){const n=new Audio(t);return this.onaudio(n),n};L.prototype._createAudioOutput=function(t){let n=null;this._mediaStreamSource&&(n=this._audioContext.createMediaStreamDestination(),this._mediaStreamSource.connect(n));const i=this._createAudio();cs(i,n&&n.stream?n.stream:this.pcStream,this._audioHelper).catch(()=>this._log.error("Error attaching stream to element (_createAudioOutput)."));const r=this;return i.setSinkId(t).then(()=>i.play()).then(()=>{r.outputs.set(t,{audio:i,dest:n})})};L.prototype._removeAudioOutputs=function(){return this._masterAudio&&typeof this._masterAudioDeviceId<"u"&&(this._disableOutput(this,this._masterAudioDeviceId),this.outputs.delete(this._masterAudioDeviceId),this._masterAudioDeviceId=null,this._masterAudio.paused||this._masterAudio.pause(),typeof this._masterAudio.srcObject<"u"?this._masterAudio.srcObject=null:this._masterAudio.src="",this._masterAudio=null),Array.from(this.outputs.keys()).map(this._removeAudioOutput,this)};L.prototype._disableOutput=function(t,n){const i=t.outputs.get(n);i&&(i.audio&&(i.audio.pause(),i.audio.src=""),i.dest&&i.dest.disconnect())};L.prototype._reassignMasterOutput=function(t,n){const i=t.outputs.get(n);t.outputs.delete(n);const r=this,s=Array.from(t.outputs.keys())[0],o=typeof s=="string"?s:"default";return i.audio.setSinkId(o).then(()=>{r._disableOutput(t,o),t.outputs.set(o,i),t._masterAudioDeviceId=o}).catch(function(){t.outputs.set(n,i),r._log.info("Could not reassign master output. Attempted to roll back.")})};L.prototype._removeAudioOutput=function(t){return this._masterAudioDeviceId===t?this._reassignMasterOutput(this,t):(this._disableOutput(this,t),this.outputs.delete(t),Promise.resolve())};L.prototype._onAddTrack=function(t,n){const i=t._masterAudio=this._createAudio();cs(i,n,this._audioHelper).then(()=>i.play()).catch(()=>t._log.error("Error attaching stream to element (_onAddTrack)."));const r=Array.from(t.outputs.keys())[0],s=typeof r=="string"?r:"default";t._masterAudioDeviceId=s,t.outputs.set(s,{audio:i});try{t._mediaStreamSource=t._audioContext.createMediaStreamSource(n)}catch(o){this._log.warn("Unable to create a MediaStreamSource from onAddTrack",o),this._mediaStreamSource=null}t.pcStream=n,t._updateAudioOutputs()};L.prototype._fallbackOnAddTrack=function(t,n){const i=document&&document.createElement("audio");cs(i,n,this._audioHelper).then(()=>i.play()).catch(()=>t._log.error("Error attaching stream to element (_fallbackOnAddTrack).")),t.outputs.set("default",{audio:i})};L.prototype._setEncodingParameters=function(e){if(!e||!this._sender||typeof this._sender.getParameters!="function"||typeof this._sender.setParameters!="function")return;const t=this._sender.getParameters();!t.priority&&!(t.encodings&&t.encodings.length)||(t.priority="high",t.encodings&&t.encodings.length&&t.encodings.forEach(n=>{n.priority="high",n.networkPriority="high"}),this._sender.setParameters(t))};L.prototype._setupPeerConnection=function(e){const t=this,n=new(this.options.rtcpcFactory||ze)({RTCPeerConnection:this.options.RTCPeerConnection});n.create(e),Zm(n.pc,this.stream);const i=RTCRtpReceiver.getCapabilities("audio").codecs;this._log.debug("sorting codecs",i,this.codecPreferences);const r=Bd(i,this.codecPreferences),[s]=n.pc.getTransceivers();this._log.debug("setting sorted codecs",r),s.setCodecPreferences(r);const o="ontrack"in n.pc?"ontrack":"onaddstream";return n.pc[o]=a=>{const l=t._remoteStream=a.stream||a.streams[0];typeof n.pc.getSenders=="function"&&(this._sender=n.pc.getSenders()[0]),t._isSinkSupported?t._onAddTrack(t,l):t._fallbackOnAddTrack(t,l),t._startPollingVolume()},n};L.prototype._maybeSetIceAggressiveNomination=function(e){return this.options.forceAggressiveIceNomination?Vm(e):e};L.prototype._setupChannel=function(){const e=this.version.pc;this.version.pc.onopen=()=>{this.status="open",this.onopen()},this.version.pc.onstatechange=()=>{this.version.pc&&this.version.pc.readyState==="stable"&&(this.status="open",this.onopen())},this.version.pc.onsignalingstatechange=()=>{const t=e.signalingState;this._log.info(`signalingState is "${t}"`),this.version.pc&&this.version.pc.signalingState==="stable"&&(this.status="open",this.onopen()),this.onsignalingstatechange(e.signalingState)},e.onconnectionstatechange=t=>{let n=e.connectionState;if(!n&&t&&t.target){const i=t.target;n=i.connectionState||i.connectionState_,this._log.info(`pc.connectionState not detected. Using target PC. State=${n}`)}n?this._log.info(`pc.connectionState is "${n}"`):this._log.warn(`onconnectionstatechange detected but state is "${n}"`),this.onpcconnectionstatechange(n),this._onMediaConnectionStateChange(n)},e.onicecandidate=t=>{const{candidate:n}=t;n&&(this._hasIceCandidates=!0,this.onicecandidate(n),this._setupRTCIceTransportListener()),this._log.info(`ICE Candidate: ${JSON.stringify(n)}`)},e.onicegatheringstatechange=()=>{const t=e.iceGatheringState;t==="gathering"?this._startIceGatheringTimeout():t==="complete"&&(this._stopIceGatheringTimeout(),this._hasIceCandidates||this._onIceGatheringFailure(qm),this._hasIceCandidates&&this._hasIceGatheringFailures&&this._startIceGatheringTimeout()),this._log.info(`pc.iceGatheringState is "${e.iceGatheringState}"`),this.onicegatheringstatechange(t)},e.oniceconnectionstatechange=()=>{this._log.info(`pc.iceConnectionState is "${e.iceConnectionState}"`),this.oniceconnectionstatechange(e.iceConnectionState),this._onMediaConnectionStateChange(e.iceConnectionState)}};L.prototype._initializeMediaStream=function(e){return this.status==="open"?!1:this.pstream.status==="disconnected"?(this.onerror({info:{code:31e3,message:"Cannot establish connection. Client is disconnected",twilioError:new Je.ConnectionDisconnected}}),this.close(),!1):(this.version=this._setupPeerConnection(e),this._setupChannel(),!0)};L.prototype._removeReconnectionListeners=function(){this.pstream&&(this.pstream.removeListener("answer",this._onAnswerOrRinging),this.pstream.removeListener("hangup",this._onHangup))};L.prototype._setupRTCDtlsTransportListener=function(){const e=this.getRTCDtlsTransport();if(!e||e.onstatechange)return;const t=()=>{this._log.info(`dtlsTransportState is "${e.state}"`),this.ondtlstransportstatechange(e.state)};t(),e.onstatechange=t};L.prototype._setupRTCIceTransportListener=function(){const e=this._getRTCIceTransport();!e||e.onselectedcandidatepairchange||(e.onselectedcandidatepairchange=()=>this.onselectedcandidatepairchange(e.getSelectedCandidatePair()))};L.prototype.iceRestart=function(){this._log.info("Attempting to restart ICE..."),this._hasIceCandidates=!1,this.version.createOffer(this.options.maxAverageBitrate,{iceRestart:!0}).then(()=>{this._removeReconnectionListeners(),this._onAnswerOrRinging=e=>{if(this._removeReconnectionListeners(),!e.sdp||this.version.pc.signalingState!=="have-local-offer"){const n=`Invalid state or param during ICE Restart:hasSdp:${!!e.sdp}, signalingState:${this.version.pc.signalingState}`;this._log.warn(n);return}const t=this._maybeSetIceAggressiveNomination(e.sdp);this._answerSdp=t,this.status!=="closed"&&this.version.processAnswer(this.codecPreferences,t,null,n=>{const i=n&&n.message?n.message:n;this._log.error(`Failed to process answer during ICE Restart. Error: ${i}`)})},this._onHangup=()=>{this._log.info("Received hangup during ICE Restart"),this._removeReconnectionListeners()},this.pstream.on("answer",this._onAnswerOrRinging),this.pstream.on("hangup",this._onHangup),this.pstream.reinvite(this.version.getSDP(),this.callSid)}).catch(e=>{const t=e&&e.message?e.message:e;this._log.error(`Failed to createOffer during ICE Restart. Error: ${t}`),this.onfailed(t)})};L.prototype.makeOutgoingCall=function(e,t,n,i,r){if(!this._initializeMediaStream(i))return;const s=this;this.callSid=n;function o(){s.options&&s._setEncodingParameters(s.options.dscp),r(s.version.pc)}function a(c){const d=c.message||c;s.onerror({info:{code:31e3,message:`Error processing answer: ${d}`,twilioError:new mt.ClientRemoteDescFailed}})}this._onAnswerOrRinging=c=>{if(!c.sdp)return;const d=this._maybeSetIceAggressiveNomination(c.sdp);s._answerSdp=d,s.status!=="closed"&&s.version.processAnswer(this.codecPreferences,d,o,a),s.pstream.removeListener("answer",s._onAnswerOrRinging),s.pstream.removeListener("ringing",s._onAnswerOrRinging)},this.pstream.on("answer",this._onAnswerOrRinging),this.pstream.on("ringing",this._onAnswerOrRinging);function l(){s.status!=="closed"&&(t?s.pstream.reconnect(s.version.getSDP(),s.callSid,t):s.pstream.invite(s.version.getSDP(),s.callSid,e),s._setupRTCDtlsTransportListener())}function u(c){const d=c.message||c;s.onerror({info:{code:31e3,message:`Error creating the offer: ${d}`,twilioError:new mt.ClientLocalDescFailed}})}this.version.createOffer(this.options.maxAverageBitrate,{audio:!0},l,u)};L.prototype.answerIncomingCall=function(e,t,n,i){if(!this._initializeMediaStream(n))return;t=this._maybeSetIceAggressiveNomination(t),this._answerSdp=t.replace(/^a=setup:actpass$/gm,"a=setup:passive"),this.callSid=e;const r=this;function s(){r.status!=="closed"&&(r.pstream.answer(r.version.getSDP(),e),r.options&&r._setEncodingParameters(r.options.dscp),i(r.version.pc),r._setupRTCDtlsTransportListener())}function o(a){const l=a.message||a;r.onerror({info:{code:31e3,message:`Error creating the answer: ${l}`,twilioError:new mt.ClientRemoteDescFailed}})}this.version.processSDP(this.options.maxAverageBitrate,this.codecPreferences,t,{audio:!0},s,o)};L.prototype.close=function(){this.version&&this.version.pc&&(this.version.pc.signalingState!=="closed"&&this.version.pc.close(),this.version.pc=null),this.stream&&(this.mute(!1),this._stopStream()),this.stream=null,this._removeReconnectionListeners(),this._stopIceGatheringTimeout(),this._audioHelper._destroyRemoteProcessedStream(),this._audioProcessorEventObserver.removeListener("add",this._onAudioProcessorAdded),this._audioProcessorEventObserver.removeListener("remove",this._onAudioProcessorRemoved),Promise.all(this._removeAudioOutputs()).catch(()=>{}),this._mediaStreamSource&&this._mediaStreamSource.disconnect(),this._inputAnalyser&&this._inputAnalyser.disconnect(),this._outputAnalyser&&this._outputAnalyser.disconnect(),this._inputAnalyser2&&this._inputAnalyser2.disconnect(),this._outputAnalyser2&&this._outputAnalyser2.disconnect(),this.status="closed",this.onclose()};L.prototype.reject=function(e){this.callSid=e};L.prototype.ignore=function(e){this.callSid=e};L.prototype.mute=function(e){this.isMuted=e,this.stream&&(this._sender&&this._sender.track?this._sender.track.enabled=!e:(typeof this.stream.getAudioTracks=="function"?this.stream.getAudioTracks():this.stream.audioTracks).forEach(n=>{n.enabled=!e}))};L.prototype.getOrCreateDTMFSender=function(){if(this._dtmfSender||this._dtmfSenderUnsupported)return this._dtmfSender||null;const t=this,n=this.version.pc;if(!n)return this._log.warn("No RTCPeerConnection available to call createDTMFSender on"),null;if(typeof n.getSenders=="function"&&(typeof RTCDTMFSender=="function"||typeof RTCDtmfSender=="function")){const i=n.getSenders().find(r=>r.dtmf);if(i)return this._log.info("Using RTCRtpSender#dtmf"),this._dtmfSender=i.dtmf,this._dtmfSender}if(typeof n.createDTMFSender=="function"&&typeof n.getLocalStreams=="function"){const i=n.getLocalStreams().map(r=>{const s=t._getAudioTracks(r);return s&&s[0]})[0];return i?(this._log.info("Creating RTCDTMFSender"),this._dtmfSender=n.createDTMFSender(i),this._dtmfSender):(this._log.warn("No local audio MediaStreamTrack available on the RTCPeerConnection to pass to createDTMFSender"),null)}return this._log.info("RTCPeerConnection does not support RTCDTMFSender"),this._dtmfSenderUnsupported=!0,null};L.prototype.getRTCDtlsTransport=function(){const t=this.version&&this.version.pc&&typeof this.version.pc.getSenders=="function"&&this.version.pc.getSenders()[0];return t&&t.transport||null};L.prototype._canStopMediaStreamTrack=()=>typeof MediaStreamTrack.prototype.stop=="function";L.prototype._getAudioTracks=e=>typeof e.getAudioTracks=="function"?e.getAudioTracks():e.audioTracks;L.prototype._getRTCIceTransport=function(){const t=this.getRTCDtlsTransport();return t&&t.iceTransport||null};L.protocol=ze.test()?new ze:null;L.prototype._handleAudioProcessorEvent=function(e,t){if(!e||!this._remoteStream)return;let n=null;this._masterAudio?(this._log.info("Setting audio source for master audio."),n=this._masterAudio):(this._log.info("No master audio. Setting audio source for default audio output."),n=this.outputs.get("default").audio),cs(n,this._remoteStream,this._audioHelper).then(()=>{const i=t?"Successfully updated audio source with processed stream":"Successfully reverted audio source to original stream";this._log.info(i),n.paused&&(this._log.info("Resuming audio playback"),n.play())}).catch(()=>{const i=t?"Failed to update audio source":"Failed to revert audio source";this._log.error(i)})};function Zm(e,t){typeof e.addTrack=="function"?t.getAudioTracks().forEach(n=>{e.addTrack(n,t)}):e.addStream(t)}function hu(e,t){let n;return t?n=new t:typeof MediaStream<"u"?n=new MediaStream:n=new webkitMediaStream,e.getAudioTracks().forEach(n.addTrack,n),n}function cs(e,t,n){return n._maybeCreateRemoteProcessedStream(t).then(i=>{if(typeof e.srcObject<"u")e.srcObject=i;else if(typeof e.mozSrcObject<"u")e.mozSrcObject=i;else if(typeof e.src<"u"){const r=e.options.window||window;e.src=(r.URL||r.webkitURL).createObjectURL(i)}else return Promise.reject();return Promise.resolve()})}L.enabled=ze.test();function eg(){return ze.test()}function tg(){return typeof RTCIceGatherer<"u"?"ORTC":"WebRTC"}function ng(e,t){return t=t||{},t.util=t.util||Gd,t.navigator=t.navigator||(typeof navigator<"u"?navigator:null),new Promise((n,i)=>{if(!t.navigator)throw new me("getUserMedia is not supported");switch("function"){case typeof(t.navigator.mediaDevices&&t.navigator.mediaDevices.getUserMedia):return n(t.navigator.mediaDevices.getUserMedia(e));case typeof t.navigator.webkitGetUserMedia:return t.navigator.webkitGetUserMedia(e,n,i);case typeof t.navigator.mozGetUserMedia:return t.navigator.mozGetUserMedia(e,n,i);case typeof t.navigator.getUserMedia:return t.navigator.getUserMedia(e,n,i);default:throw new me("getUserMedia is not supported")}}).catch(n=>{throw t.util.isFirefox()&&n.name==="NotReadableError"?new me(`Firefox does not currently support opening multiple audio input trackssimultaneously, even across different tabs.
Related Bugzilla thread: https://bugzilla.mozilla.org/show_bug.cgi?id=1299324`):n})}function ig(){if(typeof window!="object")throw new me("This platform is not supported.");const{crypto:e}=window;if(typeof e!="object")throw new me("The `crypto` module is not available on this platform.");if(typeof e.getRandomValues!="function")throw new me("The function `crypto.getRandomValues` is not available on this platform.");if(typeof window.Uint8Array!="function")throw new me("The `Uint8Array` module is not available on this platform.");return e.getRandomValues(new window.Uint8Array(16)).reduce((t,n)=>`${t}${n.toString(16).padStart(2,"0")}`,"")}function Vo(){return`KX${ig()}`}let rg=class{constructor(){this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n})}get promise(){return this._promise}reject(t){this._reject(t)}resolve(t){this._resolve(t)}};class sg{constructor(){this._operations=[]}enqueue(t){const n=!!this._operations.length,i=new rg;return this._operations.push({deferred:i,callback:t}),n||this._processQueue(),i.promise}_processQueue(){return Te(this,void 0,void 0,function*(){for(;this._operations.length;){const{deferred:t,callback:n}=this._operations[0];let i,r,s;try{i=yield n(),s=!0}catch(o){r=o}this._operations.shift(),s?t.resolve(i):t.reject(r)}})}}class og{get reject(){return this._reject}get resolve(){return this._resolve}constructor(){this.promise=new Promise((t,n)=>{this._resolve=t,this._reject=n})}}class ag{constructor(){this._eventEmitter=new Ye.EventEmitter}addEventListener(t,n){return this._eventEmitter.addListener(t,n)}dispatchEvent(t,...n){return this._eventEmitter.emit(t,...n)}removeEventListener(t,n){return this._eventEmitter.removeListener(t,n)}}class fu extends ag{get destination(){return this._destination}get loop(){return this._loop}set loop(t){const n=this;function i(){n._audioNode.removeEventListener("ended",i),n.pause()}!t&&this.loop&&!this.paused&&this._audioNode.addEventListener("ended",i),this._loop=t}get muted(){return this._gainNode.gain.value===0}set muted(t){this._gainNode.gain.value=t?0:1}get paused(){return this._audioNode===null}get src(){return this._src}set src(t){this._load(t)}get srcObject(){return this._audioElement.srcObject}set srcObject(t){this._audioElement.srcObject=t}get sinkId(){return this._sinkId}constructor(t,n={},i={}){super(),this._audioNode=null,this._loop=!1,this._pendingPlayDeferreds=[],this._sinkId="default",this._src="",typeof n!="string"&&(i=n),this._audioContext=t,this._audioElement=new(i.AudioFactory||Audio),this._bufferPromise=this._createPlayDeferred().promise,this._destination=this._audioContext.destination,this._gainNode=this._audioContext.createGain(),this._gainNode.connect(this._destination),this._XMLHttpRequest=i.XMLHttpRequestFactory||XMLHttpRequest,this.addEventListener("canplaythrough",()=>{this._resolvePlayDeferreds()}),typeof n=="string"&&(this.src=n)}load(){this._load(this._src)}pause(){this.paused||(this._audioElement.pause(),this._audioNode.stop(),this._audioNode.disconnect(this._gainNode),this._audioNode=null,this._rejectPlayDeferreds(new Error("The play() request was interrupted by a call to pause().")))}play(){return Te(this,void 0,void 0,function*(){if(!this.paused){if(yield this._bufferPromise,!this.paused)return;throw new Error("The play() request was interrupted by a call to pause().")}this._audioNode=this._audioContext.createBufferSource(),this._audioNode.loop=this.loop,this._audioNode.addEventListener("ended",()=>{this._audioNode&&this._audioNode.loop||this.dispatchEvent("ended")});const t=yield this._bufferPromise;if(this.paused)throw new Error("The play() request was interrupted by a call to pause().");if(this._audioNode.buffer=t,this._audioNode.connect(this._gainNode),this._audioNode.start(),this._audioElement.srcObject)return this._audioElement.play()})}setSinkId(t){return Te(this,void 0,void 0,function*(){if(typeof this._audioElement.setSinkId!="function")throw new Error("This browser does not support setSinkId.");if(t!==this.sinkId){if(t==="default"){this.paused||this._gainNode.disconnect(this._destination),this._audioElement.srcObject=null,this._destination=this._audioContext.destination,this._gainNode.connect(this._destination),this._sinkId=t;return}yield this._audioElement.setSinkId(t),!this._audioElement.srcObject&&(this._gainNode.disconnect(this._audioContext.destination),this._destination=this._audioContext.createMediaStreamDestination(),this._audioElement.srcObject=this._destination.stream,this._sinkId=t,this._gainNode.connect(this._destination))}})}_createPlayDeferred(){const t=new og;return this._pendingPlayDeferreds.push(t),t}_load(t){this._src&&this._src!==t&&this.pause(),this._src=t,this._bufferPromise=new Promise((n,i)=>Te(this,void 0,void 0,function*(){if(!t)return this._createPlayDeferred().promise;const r=yield lg(this._audioContext,this._XMLHttpRequest,t);this.dispatchEvent("canplaythrough"),n(r)}))}_rejectPlayDeferreds(t){const n=this._pendingPlayDeferreds;n.splice(0,n.length).forEach(({reject:i})=>i(t))}_resolvePlayDeferreds(t){const n=this._pendingPlayDeferreds;n.splice(0,n.length).forEach(({resolve:i})=>i(t))}}function lg(e,t,n){return Te(this,void 0,void 0,function*(){const i=new t;i.open("GET",n,!0),i.responseType="arraybuffer";const r=yield new Promise(s=>{i.addEventListener("load",s),i.send()});try{return e.decodeAudioData(r.target.response)}catch{return new Promise(o=>{e.decodeAudioData(r.target.response,o)})}})}function bt(e,t,n){if(!(this instanceof bt))return new bt(e,t,n);if(!e||!t)throw new W("name and url are required arguments");n=Object.assign({AudioFactory:typeof Audio<"u"?Audio:null,maxDuration:0,shouldLoop:!1},n),n.AudioPlayer=n.audioContext?fu.bind(fu,n.audioContext):n.AudioFactory,Object.defineProperties(this,{_Audio:{value:n.AudioPlayer},_activeEls:{value:new Map},_isSinkSupported:{value:n.AudioFactory!==null&&typeof n.AudioFactory.prototype.setSinkId=="function"},_maxDuration:{value:n.maxDuration},_maxDurationTimeout:{value:null,writable:!0},_operations:{value:new sg},_playPromise:{value:null,writable:!0},_shouldLoop:{value:n.shouldLoop},_sinkIds:{value:["default"]},isPlaying:{enumerable:!0,get(){return!!this._playPromise}},name:{enumerable:!0,value:e},url:{enumerable:!0,value:t}}),this._Audio&&this._play(!0,!1)}function eh(e){e&&(e.pause(),e.src="",e.srcObject=null,e.load())}bt.prototype._playAudioElement=function(t,n,i){const r=this._activeEls.get(t);if(!r)throw new W(`sinkId: "${t}" doesn't have an audio element`);return r.muted=!!n,r.loop=!!i,r.play().then(()=>r).catch(s=>{throw eh(r),this._activeEls.delete(t),s})};bt.prototype._play=function(t,n){this.isPlaying&&this._stop(),this._maxDuration>0&&(this._maxDurationTimeout=setTimeout(this._stop.bind(this),this._maxDuration)),n=typeof n=="boolean"?n:this._shouldLoop;const i=this;return this._playPromise=Promise.all(this._sinkIds.map(function(o){if(!i._Audio)return Promise.resolve();let a=i._activeEls.get(o);return a?i._playAudioElement(o,t,n):(a=new i._Audio(i.url),typeof a.setAttribute=="function"&&a.setAttribute("crossorigin","anonymous"),new Promise(l=>{a.addEventListener("canplaythrough",l)}).then(()=>(i._isSinkSupported?a.setSinkId(o):Promise.resolve()).then(function(){return i._activeEls.set(o,a),i._playPromise?i._playAudioElement(o,t,n):Promise.resolve()})))}))};bt.prototype._stop=function(){this._activeEls.forEach((t,n)=>{this._sinkIds.includes(n)?(t.pause(),t.currentTime=0):(eh(t),this._activeEls.delete(n))}),clearTimeout(this._maxDurationTimeout),this._playPromise=null,this._maxDurationTimeout=null};bt.prototype.setSinkIds=function(t){this._isSinkSupported&&(t=t.forEach?t:[t],[].splice.apply(this._sinkIds,[0,this._sinkIds.length].concat(t)))};bt.prototype.stop=function(){this._operations.enqueue(()=>(this._stop(),Promise.resolve()))};bt.prototype.play=function(){return this._operations.enqueue(()=>this._play())};const ug=3e4,cg=2e3,dg="twilio-js-sdk",hg='Parameter "token" must be of type "string".';class P extends Ye.EventEmitter{static get audioContext(){return P._audioContext}static get extension(){const t=typeof document<"u"?document.createElement("audio"):{canPlayType:!1};let n;try{n=t.canPlayType&&!!t.canPlayType("audio/mpeg").replace(/no/,"")}catch{n=!1}let i;try{i=t.canPlayType&&!!t.canPlayType("audio/ogg;codecs='vorbis'").replace(/no/,"")}catch{i=!1}return i&&!n?"ogg":"mp3"}static get isSupported(){return eg()}static get packageName(){return Vd}static runPreflight(t,n){return new X(t,Object.assign({audioContext:P._getOrCreateAudioContext()},n))}static toString(){return"[Twilio.Device class]"}static get version(){return On}static _getOrCreateAudioContext(){return P._audioContext||(typeof AudioContext<"u"?P._audioContext=new AudioContext:typeof webkitAudioContext<"u"&&(P._audioContext=new webkitAudioContext)),P._audioContext}constructor(t,n={}){if(super(),this._activeCall=null,this._audio=null,this._audioProcessorEventObserver=null,this._callInputStream=null,this._calls=[],this._callSinkIds=["default"],this._chunderURIs=[],this._defaultOptions={allowIncomingWhileBusy:!1,closeProtection:!1,codecPreferences:[T.Codec.PCMU,T.Codec.Opus],dscp:!0,enableImprovedSignalingErrorPrecision:!1,forceAggressiveIceNomination:!1,logLevel:Li.levels.ERROR,maxCallSignalingTimeoutMs:0,preflight:!1,sounds:{},tokenRefreshMs:1e4,voiceEventSidGenerator:Vo},this._edge=null,this._home=null,this._identity=null,this._log=new ce("Device"),this._makeCallPromise=null,this._options={},this._preferredURI=null,this._publisher=null,this._region=null,this._regTimer=null,this._shouldReRegister=!1,this._soundcache=new Map,this._state=P.State.Unregistered,this._stateEventMapping={[P.State.Destroyed]:P.EventName.Destroyed,[P.State.Unregistered]:P.EventName.Unregistered,[P.State.Registering]:P.EventName.Registering,[P.State.Registered]:P.EventName.Registered},this._stream=null,this._streamConnectedPromise=null,this._tokenWillExpireTimeout=null,this._createDefaultPayload=s=>{const o={aggressive_nomination:this._options.forceAggressiveIceNomination,browser_extension:this._isBrowserExtension,dscp:!!this._options.dscp,ice_restart_enabled:!0,platform:tg(),sdk_version:On};function a(l,u){u&&(o[l]=u)}if(s){const l=s.parameters.CallSid;a("call_sid",/^TJ/.test(l)?void 0:l),a("temp_call_sid",s.outboundConnectionId),a("audio_codec",s.codec),o.direction=s.direction}return a("gateway",this._stream&&this._stream.gateway),a("region",this._stream&&this._stream.region),o},this._onSignalingClose=()=>{this._stream=null,this._streamConnectedPromise=null},this._onSignalingConnected=s=>{var o;const a=Om(s.region);if(this._edge=s.edge||Lm[a]||s.region,this._region=a||s.region,this._home=s.home,(o=this._publisher)===null||o===void 0||o.setHost(au(s.home)),s.token&&(this._identity=s.token.identity,typeof s.token.ttl=="number"&&typeof this._options.tokenRefreshMs=="number")){const u=s.token.ttl*1e3,c=Math.max(0,u-this._options.tokenRefreshMs);this._tokenWillExpireTimeout=setTimeout(()=>{this._log.debug("#tokenWillExpire"),this.emit("tokenWillExpire",this),this._tokenWillExpireTimeout&&(clearTimeout(this._tokenWillExpireTimeout),this._tokenWillExpireTimeout=null)},c)}const l=this._getChunderws()||uu(this._edge);if(l.length>0){const[u]=l;this._preferredURI=lu(u)}else this._log.warn("Could not parse a preferred URI from the stream#connected event.");this._shouldReRegister&&this.register()},this._onSignalingError=s=>{if(typeof s!="object"){this._log.warn("Invalid signaling error payload",s);return}const{error:o,callsid:a,voiceeventsid:l}=s;if(typeof o!="object"||l){this._log.warn("Ignoring signaling error payload",{originalError:o,voiceeventsid:l});return}const u=typeof a=="string"&&this._findCall(a)||void 0,{code:c,message:d}=o;let{twilioError:h}=o;if(typeof c=="number")if(c===31201)h=new le.AuthenticationFailed(o);else if(c===31204)h=new le.AccessTokenInvalid(o);else if(c===31205)this._stopRegistrationTimer(),h=new le.AccessTokenExpired(o);else{const v=Mo(!!this._options.enableImprovedSignalingErrorPrecision,c);typeof v<"u"&&(h=new v(o))}h||(this._log.error("Unknown signaling error: ",o),h=new xe.UnknownError(d,o)),this._log.error("Received error: ",h),this._log.debug("#error",o),this.emit(P.EventName.Error,h,u)},this._onSignalingInvite=s=>Te(this,void 0,void 0,function*(){var o;const a=!!this._activeCall;if(a&&!this._options.allowIncomingWhileBusy){this._log.info("Device busy; ignoring incoming invite");return}if(!s.callsid||!s.sdp){this._log.debug("#error",s),this.emit(P.EventName.Error,new rn.BadRequest("Malformed invite from gateway"));return}const l=s.parameters||{};l.CallSid=l.CallSid||s.callsid;const u=Object.assign({},Hd(l.Params));this._makeCallPromise=this._makeCall(u,{callParameters:l,enableImprovedSignalingErrorPrecision:!!this._options.enableImprovedSignalingErrorPrecision,offerSdp:s.sdp,reconnectToken:s.reconnect,voiceEventSidGenerator:this._options.voiceEventSidGenerator});let c;try{c=yield this._makeCallPromise}finally{this._makeCallPromise=null}this._calls.push(c),c.once("accept",()=>{this._soundcache.get(P.SoundName.Incoming).stop(),this._publishNetworkChange()});const d=!((o=this._audio)===null||o===void 0)&&o.incoming()&&!a?()=>this._soundcache.get(P.SoundName.Incoming).play():()=>Promise.resolve();this._showIncomingCall(c,d)}),this._onSignalingOffline=()=>{this._log.info("Stream is offline"),this._edge=null,this._region=null,this._shouldReRegister=this.state!==P.State.Unregistered,this._setState(P.State.Unregistered)},this._onSignalingReady=()=>{this._log.info("Stream is ready"),this._setState(P.State.Registered)},this._publishNetworkChange=()=>{this._activeCall&&this._networkInformation&&this._publisher.info("network-information","network-change",{connection_type:this._networkInformation.type,downlink:this._networkInformation.downlink,downlinkMax:this._networkInformation.downlinkMax,effective_type:this._networkInformation.effectiveType,rtt:this._networkInformation.rtt},this._activeCall)},this._updateInputStream=s=>{const o=this._activeCall;return o&&!s?Promise.reject(new tt("Cannot unset input device while a call is in progress.")):(this._callInputStream=s,o?o._setInputTracksFromStream(s):Promise.resolve())},this._updateSinkIds=(s,o)=>(s==="ringtone"?this._updateRingtoneSinkIds(o):this._updateSpeakerSinkIds(o)).then(()=>{this._publisher.info("audio",`${s}-devices-set`,{audio_device_ids:o},this._activeCall)},l=>{throw this._publisher.error("audio",`${s}-devices-set-failed`,{audio_device_ids:o,message:l.message},this._activeCall),l}),this._setupLoglevel(n.logLevel),this._logOptions("constructor",n),this.updateToken(t),as())throw new me("Microsoft Edge Legacy (https://support.microsoft.com/en-us/help/4533505/what-is-microsoft-edge-legacy) is deprecated and will not be able to connect to Twilio to make or receive calls after September 1st, 2020. Please see this documentation for a list of supported browsers https://www.twilio.com/docs/voice/client/javascript#supported-browsers");if(!P.isSupported&&n.ignoreBrowserSupport)throw window&&window.location&&window.location.protocol==="http:"?new me("twilio.js wasn't able to find WebRTC browser support.           This is most likely because this page is served over http rather than https,           which does not support WebRTC in many browsers. Please load this page over https and           try again."):new me("twilio.js 1.3+ SDKs require WebRTC browser support.         For more information, see <https://www.twilio.com/docs/api/client/twilio-js>.         If you have any questions about this announcement, please contact         Twilio Support at <help@twilio.com>.");const i=globalThis,r=i.msBrowser||i.browser||i.chrome;if(this._isBrowserExtension=!!r&&!!r.runtime&&!!r.runtime.id||!!i.safari&&!!i.safari.extension,this._isBrowserExtension&&this._log.info("Running as browser extension."),navigator){const s=navigator;this._networkInformation=s.connection||s.mozConnection||s.webkitConnection}this._networkInformation&&typeof this._networkInformation.addEventListener=="function"&&this._networkInformation.addEventListener("change",this._publishNetworkChange),P._getOrCreateAudioContext(),P._audioContext&&(P._dialtonePlayer||(P._dialtonePlayer=new sm(P._audioContext))),this._boundDestroy=this.destroy.bind(this),this._boundConfirmClose=this._confirmClose.bind(this),typeof window<"u"&&window.addEventListener&&(window.addEventListener("unload",this._boundDestroy),window.addEventListener("pagehide",this._boundDestroy)),this.updateOptions(n)}get audio(){return this._audio}connect(){return Te(this,arguments,void 0,function*(t={}){if(this._log.debug(".connect",JSON.stringify(t)),this._throwIfDestroyed(),this._activeCall)throw new tt("A Call is already active");let n,i,r;if(t.connectToken){try{const u=JSON.parse(decodeURIComponent(atob(t.connectToken)));n=u.customParameters,i=u.parameters,r=u.signalingReconnectToken}catch{throw new W("Cannot parse connectToken")}if(!i||!i.CallSid||!r)throw new W("Invalid connectToken")}let s=!1,o={};const a={enableImprovedSignalingErrorPrecision:!!this._options.enableImprovedSignalingErrorPrecision,rtcConfiguration:t.rtcConfiguration,voiceEventSidGenerator:this._options.voiceEventSidGenerator};r&&i?(s=!0,a.callParameters=i,a.reconnectCallSid=i.CallSid,a.reconnectToken=r,o=n||o):o=t.params||o;let l;this._makeCallPromise=this._makeCall(o,a,s);try{l=this._activeCall=yield this._makeCallPromise}finally{this._makeCallPromise=null}return this._calls.splice(0).forEach(u=>u.ignore()),this._soundcache.get(P.SoundName.Incoming).stop(),l.accept({rtcConstraints:t.rtcConstraints}),this._publishNetworkChange(),l})}get calls(){return this._calls}destroy(){var t;this._log.debug(".destroy"),this._log.debug("Rejecting any incoming calls"),this._calls.slice(0).forEach(i=>i.reject()),this.disconnectAll(),this._stopRegistrationTimer(),this._destroyStream(),this._destroyAudioHelper(),(t=this._audioProcessorEventObserver)===null||t===void 0||t.destroy(),this._destroyPublisher(),this._networkInformation&&typeof this._networkInformation.removeEventListener=="function"&&this._networkInformation.removeEventListener("change",this._publishNetworkChange),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.removeEventListener("unload",this._boundDestroy),window.removeEventListener("pagehide",this._boundDestroy)),this._setState(P.State.Destroyed),Ye.EventEmitter.prototype.removeAllListeners.call(this)}disconnectAll(){this._log.debug(".disconnectAll"),this._calls.splice(0).forEach(n=>n.disconnect()),this._activeCall&&this._activeCall.disconnect()}get edge(){return this._edge}get home(){return this._home}get identity(){return this._identity}get isBusy(){return!!this._activeCall}register(){return Te(this,void 0,void 0,function*(){if(this._log.debug(".register"),this.state!==P.State.Unregistered)throw new tt(`Attempt to register when device is in state "${this.state}". Must be "${P.State.Unregistered}".`);this._shouldReRegister=!1,this._setState(P.State.Registering),yield this._streamConnectedPromise||this._setupStream(),yield this._sendPresence(!0),yield Uo(this,P.State.Registered,P.State.Unregistered)})}get state(){return this._state}get token(){return this._token}toString(){return"[Twilio.Device instance]"}unregister(){return Te(this,void 0,void 0,function*(){if(this._log.debug(".unregister"),this.state!==P.State.Registered)throw new tt(`Attempt to unregister when device is in state "${this.state}". Must be "${P.State.Registered}".`);this._shouldReRegister=!1;const t=yield this._streamConnectedPromise,n=new Promise(i=>{t.on("offline",i)});yield this._sendPresence(!1),yield n})}updateOptions(t={}){if(this._logOptions("updateOptions",t),this.state===P.State.Destroyed)throw new tt(`Attempt to "updateOptions" when device is in state "${this.state}".`);this._options=Object.assign(Object.assign(Object.assign({},this._defaultOptions),this._options),t);const n=new Set(this._chunderURIs),i=this._chunderURIs=(this._getChunderws()||uu(this._options.edge)).map(lu);let r=n.size!==i.length;if(!r){for(const s of i)if(!n.has(s)){r=!0;break}}if(this.isBusy&&r)throw new tt("Cannot change Edge while on an active Call");this._setupLoglevel(this._options.logLevel);for(const s of Object.keys(P._defaultSounds)){const o=P._defaultSounds[s],a=`${Fa}/${o.filename}.${P.extension}?cache=${On}`,l=this._options.sounds&&this._options.sounds[s]||a,u=new(this._options.Sound||bt)(s,l,{audioContext:this._options.disableAudioContextSounds?null:P.audioContext,maxDuration:o.maxDuration,shouldLoop:o.shouldLoop});this._soundcache.set(s,u)}this._setupAudioHelper(),this._setupPublisher(),r&&this._streamConnectedPromise&&this._setupStream(),typeof window<"u"&&typeof window.addEventListener=="function"&&this._options.closeProtection&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.addEventListener("beforeunload",this._boundConfirmClose))}updateToken(t){if(this._log.debug(".updateToken"),this.state===P.State.Destroyed)throw new tt(`Attempt to "updateToken" when device is in state "${this.state}".`);if(typeof t!="string")throw new W(hg);this._token=t,this._stream&&this._stream.setToken(this._token),this._publisher&&this._publisher.setToken(this._token)}_confirmClose(t){if(!this._activeCall)return"";const n=this._options.closeProtection||!1,i=typeof n!="string"?"A call is currently in-progress. Leaving or reloading this page will end the call.":n;return(t||window.event).returnValue=i,i}_destroyAudioHelper(){this._audio&&(this._audio._destroy(),this._audio=null)}_destroyPublisher(){this._publisher&&(this._publisher=null)}_destroyStream(){this._stream&&(this._stream.removeListener("close",this._onSignalingClose),this._stream.removeListener("connected",this._onSignalingConnected),this._stream.removeListener("error",this._onSignalingError),this._stream.removeListener("invite",this._onSignalingInvite),this._stream.removeListener("offline",this._onSignalingOffline),this._stream.removeListener("ready",this._onSignalingReady),this._stream.destroy(),this._stream=null),this._onSignalingOffline(),this._streamConnectedPromise=null}_findCall(t){return this._calls.find(n=>n.parameters.CallSid===t||n.outboundConnectionId===t)||null}_getChunderws(){return typeof this._options.chunderw=="string"?[this._options.chunderw]:Array.isArray(this._options.chunderw)?this._options.chunderw:null}_logOptions(t,n={}){const i=["allowIncomingWhileBusy","appName","appVersion","closeProtection","codecPreferences","disableAudioContextSounds","dscp","edge","enableImprovedSignalingErrorPrecision","forceAggressiveIceNomination","logLevel","maxAverageBitrate","maxCallSignalingTimeoutMs","sounds","tokenRefreshMs"],r=["RTCPeerConnection","enumerateDevices","getUserMedia","MediaStream"];if(typeof n=="object"){const s=Object.assign({},n);Object.keys(s).forEach(o=>{!i.includes(o)&&!r.includes(o)&&delete s[o],r.includes(o)&&(s[o]=!0)}),this._log.debug(`.${t}`,JSON.stringify(s))}}_makeCall(t,n){return Te(this,arguments,void 0,function*(i,r,s=!1){var o;const a=(o=this._audio)===null||o===void 0?void 0:o._getInputDevicePromise();a&&(this._log.debug("inputDevicePromise detected, waiting..."),yield a,this._log.debug("inputDevicePromise resolved"));const l={audioHelper:this._audio,onIgnore:()=>{this._soundcache.get(P.SoundName.Incoming).stop()},pstream:yield this._streamConnectedPromise||this._setupStream(),publisher:this._publisher,soundcache:this._soundcache};r=Object.assign({MediaStream:this._options.MediaStream,RTCPeerConnection:this._options.RTCPeerConnection,beforeAccept:d=>{!this._activeCall||this._activeCall===d||(this._activeCall.disconnect(),this._removeCall(this._activeCall))},codecPreferences:this._options.codecPreferences,customSounds:this._options.sounds,dialtonePlayer:P._dialtonePlayer,dscp:this._options.dscp,forceAggressiveIceNomination:this._options.forceAggressiveIceNomination,getInputStream:()=>this._options.fileInputStream||this._callInputStream,getSinkIds:()=>this._callSinkIds,maxAverageBitrate:this._options.maxAverageBitrate,preflight:this._options.preflight,rtcConstraints:this._options.rtcConstraints,shouldPlayDisconnect:()=>{var d;return(d=this._audio)===null||d===void 0?void 0:d.disconnect()},twimlParams:i,voiceEventSidGenerator:this._options.voiceEventSidGenerator},r);const u=()=>{if(!this._stream){this._log.warn("UnsetPreferredUri called without a stream");return}this._activeCall===null&&this._calls.length===0&&this._stream.updatePreferredURI(null)},c=new(this._options.Call||T)(l,r);return this._publisher.info("settings","init",{MediaStream:!!this._options.MediaStream,RTCPeerConnection:!!this._options.RTCPeerConnection,enumerateDevices:!!this._options.enumerateDevices,getUserMedia:!!this._options.getUserMedia},c),c.once("accept",()=>{var d,h,v,y,_;this._stream.updatePreferredURI(this._preferredURI),this._removeCall(c),this._activeCall=c,this._audio&&this._audio._maybeStartPollingVolume(),c.direction===T.CallDirection.Outgoing&&(!((d=this._audio)===null||d===void 0)&&d.outgoing())&&!s&&this._soundcache.get(P.SoundName.Outgoing).play();const I={edge:this._edge||this._region};this._options.edge&&(I.selected_edge=Array.isArray(this._options.edge)?this._options.edge:[this._options.edge]),this._publisher.info("settings","edge",I,c),!((h=this._audio)===null||h===void 0)&&h.localProcessedStream&&((v=this._audioProcessorEventObserver)===null||v===void 0||v.emit("enabled",!1)),!((y=this._audio)===null||y===void 0)&&y.remoteProcessedStream&&((_=this._audioProcessorEventObserver)===null||_===void 0||_.emit("enabled",!0))}),c.addListener("error",d=>{c.status()==="closed"&&(this._removeCall(c),u()),this._audio&&this._audio._maybeStopPollingVolume(),this._maybeStopIncomingSound()}),c.once("cancel",()=>{this._log.info(`Canceled: ${c.parameters.CallSid}`),this._removeCall(c),u(),this._audio&&this._audio._maybeStopPollingVolume(),this._maybeStopIncomingSound()}),c.once("disconnect",()=>{this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(c),u(),this._maybeStopIncomingSound()}),c.once("reject",()=>{this._log.info(`Rejected: ${c.parameters.CallSid}`),this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(c),u(),this._maybeStopIncomingSound()}),c.on("transportClose",()=>{c.status()===T.State.Pending&&(this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(c),this._maybeStopIncomingSound())}),c})}_maybeStopIncomingSound(){this._calls.length||this._soundcache.get(P.SoundName.Incoming).stop()}_removeCall(t){this._activeCall===t&&(this._activeCall=null,this._makeCallPromise=null);for(let n=this._calls.length-1;n>=0;n--)t===this._calls[n]&&this._calls.splice(n,1)}_sendPresence(t){return Te(this,void 0,void 0,function*(){const n=yield this._streamConnectedPromise;n&&(n.register({audio:t}),t?this._startRegistrationTimer():this._stopRegistrationTimer())})}_setState(t){if(t===this.state)return;this._state=t;const n=this._stateEventMapping[t];this._log.debug(`#${n}`),this.emit(n)}_setupAudioHelper(){this._audioProcessorEventObserver||(this._audioProcessorEventObserver=new im,this._audioProcessorEventObserver.on("event",({name:n,group:i,isRemote:r})=>{this._publisher.info(i,n,{is_remote:r},this._activeCall)}));const t={audioContext:P.audioContext,audioProcessorEventObserver:this._audioProcessorEventObserver,beforeSetInputDevice:()=>this._makeCallPromise?(this._log.debug("beforeSetInputDevice pause detected"),this._makeCallPromise):(this._log.debug("beforeSetInputDevice pause not detected, setting default"),Promise.resolve()),enumerateDevices:this._options.enumerateDevices,getUserMedia:this._options.getUserMedia||ng};if(this._audio){this._log.info("Found existing audio helper; updating options..."),this._audio._updateUserOptions(t);return}this._audio=new(this._options.AudioHelper||nm)(this._updateSinkIds,this._updateInputStream,t),this._audio.on("deviceChange",n=>{const i=this._activeCall,r=n.map(s=>s.deviceId);this._publisher.info("audio","device-change",{lost_active_device_ids:r},i),i&&i._mediaHandler._onInputDevicesChanged()})}_setupLoglevel(t){const n=typeof t=="number"||typeof t=="string"?t:Li.levels.ERROR;this._log.setDefaultLevel(n),this._log.info("Set logger default level to",n)}_setupPublisher(){this._publisher&&(this._log.info("Found existing publisher; destroying..."),this._destroyPublisher());const t={defaultPayload:this._createDefaultPayload,metadata:{app_name:this._options.appName,app_version:this._options.appVersion}};return this._options.eventgw&&(t.host=this._options.eventgw),this._home&&(t.host=au(this._home)),this._publisher=new(this._options.Publisher||be)(dg,this.token,t),this._options.publishEvents===!1?this._publisher.disable():this._publisher.on("error",n=>{this._log.warn("Cannot connect to insights.",n)}),this._publisher}_setupStream(){return this._stream&&(this._log.info("Found existing stream; destroying..."),this._destroyStream()),this._log.info("Setting up VSP"),this._stream=new(this._options.PStream||K)(this.token,this._chunderURIs,{backoffMaxMs:this._options.backoffMaxMs,maxPreferredDurationMs:this._options.maxCallSignalingTimeoutMs}),this._stream.addListener("close",this._onSignalingClose),this._stream.addListener("connected",this._onSignalingConnected),this._stream.addListener("error",this._onSignalingError),this._stream.addListener("invite",this._onSignalingInvite),this._stream.addListener("offline",this._onSignalingOffline),this._stream.addListener("ready",this._onSignalingReady),this._streamConnectedPromise=Uo(this._stream,"connected","close").then(()=>this._stream)}_showIncomingCall(t,n){let i;return Promise.race([n(),new Promise((r,s)=>{i=setTimeout(()=>{const o="Playing incoming ringtone took too long; it might not play. Continuing execution...";s(new Error(o))},cg)})]).catch(r=>{this._log.warn(r.message)}).then(()=>{clearTimeout(i),this._log.debug("#incoming",JSON.stringify({customParameters:t.customParameters,parameters:t.parameters})),this.emit(P.EventName.Incoming,t)})}_startRegistrationTimer(){this._stopRegistrationTimer(),this._regTimer=setTimeout(()=>{this._sendPresence(!0)},ug)}_stopRegistrationTimer(){this._regTimer&&clearTimeout(this._regTimer)}_throwIfDestroyed(){if(this.state===P.State.Destroyed)throw new tt("Device has been destroyed.")}_updateRingtoneSinkIds(t){return Promise.resolve(this._soundcache.get(P.SoundName.Incoming).setSinkIds(t))}_updateSpeakerSinkIds(t){Array.from(this._soundcache.entries()).filter(i=>i[0]!==P.SoundName.Incoming).forEach(i=>i[1].setSinkIds(t)),this._callSinkIds=t;const n=this._activeCall;return n?n._setSinkIds(t):Promise.resolve()}}P._defaultSounds={disconnect:{filename:"disconnect",maxDuration:3e3},dtmf0:{filename:"dtmf-0",maxDuration:1e3},dtmf1:{filename:"dtmf-1",maxDuration:1e3},dtmf2:{filename:"dtmf-2",maxDuration:1e3},dtmf3:{filename:"dtmf-3",maxDuration:1e3},dtmf4:{filename:"dtmf-4",maxDuration:1e3},dtmf5:{filename:"dtmf-5",maxDuration:1e3},dtmf6:{filename:"dtmf-6",maxDuration:1e3},dtmf7:{filename:"dtmf-7",maxDuration:1e3},dtmf8:{filename:"dtmf-8",maxDuration:1e3},dtmf9:{filename:"dtmf-9",maxDuration:1e3},dtmfh:{filename:"dtmf-hash",maxDuration:1e3},dtmfs:{filename:"dtmf-star",maxDuration:1e3},incoming:{filename:"incoming",shouldLoop:!0},outgoing:{filename:"outgoing",maxDuration:3e3}};(function(e){(function(t){t.Error="error",t.Incoming="incoming",t.Destroyed="destroyed",t.Unregistered="unregistered",t.Registering="registering",t.Registered="registered",t.TokenWillExpire="tokenWillExpire"})(e.EventName||(e.EventName={})),function(t){t.Destroyed="destroyed",t.Unregistered="unregistered",t.Registering="registering",t.Registered="registered"}(e.State||(e.State={})),function(t){t.Incoming="incoming",t.Outgoing="outgoing",t.Disconnect="disconnect",t.Dtmf0="dtmf0",t.Dtmf1="dtmf1",t.Dtmf2="dtmf2",t.Dtmf3="dtmf3",t.Dtmf4="dtmf4",t.Dtmf5="dtmf5",t.Dtmf6="dtmf6",t.Dtmf7="dtmf7",t.Dtmf8="dtmf8",t.Dtmf9="dtmf9",t.DtmfS="dtmfs",t.DtmfH="dtmfh"}(e.SoundName||(e.SoundName={}))})(P||(P={}));class Us{constructor(t,n=!1){this.deleted=!1;let i;const r=t.candidate.split("network-cost ");r[1]&&(i=parseInt(r[1],10)),this.candidateType=t.type,this.ip=t.ip||t.address,this.isRemote=n,this.networkCost=i,this.port=t.port,this.priority=t.priority,this.protocol=t.protocol,this.relatedAddress=t.relatedAddress,this.relatedPort=t.relatedPort,this.tcpType=t.tcpType,this.transportId=t.sdpMid}toPayload(){return{candidate_type:this.candidateType,deleted:this.deleted,ip:this.ip,is_remote:this.isRemote,"network-cost":this.networkCost,port:this.port,priority:this.priority,protocol:this.protocol,related_address:this.relatedAddress,related_port:this.relatedPort,tcp_type:this.tcpType,transport_id:this.transportId}}}const pu=94.768;function fg(e,t,n){if(typeof e!="number"||typeof t!="number"||typeof n!="number"||!_r(e)||!_r(t)||!_r(n))return null;const i=e+t*2+10;let r=0;switch(!0){case i<160:r=pu-i/40;break;case i<1e3:r=pu-(i-120)/10;break}switch(!0){case n<=r/2.5:r=Math.max(r-n*2.5,6.52);break;default:r=0;break}return 1+.035*r+7e-6*r*(r-60)*(100-r)}function _r(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)&&e>=0}var pg={calculate:fg,isNonNegativeNumber:_r};const mg=5,gg=0,vg=3,_g=1e3,yg=5*1e3,Sg={audioInputLevel:{minStandardDeviation:327.67,sampleCount:10},audioOutputLevel:{minStandardDeviation:327.67,sampleCount:10},bytesReceived:{clearCount:2,min:1,raiseCount:3,sampleCount:3},bytesSent:{clearCount:2,min:1,raiseCount:3,sampleCount:3},jitter:{max:30},mos:{min:3},packetsLostFraction:[{max:1},{clearValue:1,maxAverage:3,sampleCount:7}],rtt:{max:400}};function wg(e,t){return t.reduce((n,i)=>n+=i>e?1:0,0)}function xg(e,t){return t.reduce((n,i)=>n+=i<e?1:0,0)}function Cg(e){if(e.length<=0)return null;const t=e.reduce((r,s)=>r+s,0)/e.length,n=e.map(r=>Math.pow(r-t,2));return Math.sqrt(n.reduce((r,s)=>r+s,0)/n.length)}function kg(e){return e.reduce((t,n)=>[...t,...n],[])}class Eg extends Ye.EventEmitter{constructor(t){super(),this._activeWarnings=new Map,this._currentStreaks=new Map,this._inputVolumes=[],this._outputVolumes=[],this._sampleBuffer=[],this._supplementalSampleBuffers={audioInputLevel:[],audioOutputLevel:[]},this._warningsEnabled=!0,t=t||{},this._getRTCStats=t.getRTCStats||_m,this._mos=t.Mos||pg,this._peerConnection=t.peerConnection,this._thresholds=Object.assign(Object.assign({},Sg),t.thresholds);const n=Object.values(this._thresholds).map(i=>i.sampleCount).filter(i=>!!i);this._maxSampleCount=Math.max(mg,...n),this._peerConnection&&this.enable(this._peerConnection)}addVolumes(t,n){this._inputVolumes.push(t),this._outputVolumes.push(n)}disable(){return this._sampleInterval&&(clearInterval(this._sampleInterval),delete this._sampleInterval),this}disableWarnings(){return this._warningsEnabled&&this._activeWarnings.clear(),this._warningsEnabled=!1,this}enable(t){if(t){if(this._peerConnection&&t!==this._peerConnection)throw new W("Attempted to replace an existing PeerConnection in StatsMonitor.enable");this._peerConnection=t}if(!this._peerConnection)throw new W("Can not enable StatsMonitor without a PeerConnection");return this._sampleInterval=this._sampleInterval||setInterval(this._fetchSample.bind(this),_g),this}enableWarnings(){return this._warningsEnabled=!0,this}hasActiveWarning(t,n){const i=`${t}:${n}`;return!!this._activeWarnings.get(i)}_addSample(t){const n=this._sampleBuffer;n.push(t),n.length>this._maxSampleCount&&n.splice(0,n.length-this._maxSampleCount)}_clearWarning(t,n,i){const r=`${t}:${n}`,s=this._activeWarnings.get(r);!s||Date.now()-s.timeRaised<yg||(this._activeWarnings.delete(r),this.emit("warning-cleared",Object.assign(Object.assign({},i),{name:t,threshold:{name:n,value:this._thresholds[t][n]}})))}_createSample(t,n){const i=n&&n.totals.bytesSent||0,r=n&&n.totals.bytesReceived||0,s=n&&n.totals.packetsSent||0,o=n&&n.totals.packetsReceived||0,a=n&&n.totals.packetsLost||0,l=t.bytesSent-i,u=t.bytesReceived-r,c=t.packetsSent-s,d=t.packetsReceived-o,h=t.packetsLost-a,v=d+h,y=v>0?h/v*100:0,_=t.packetsReceived+t.packetsLost,I=_>0?t.packetsLost/_*100:100,f=typeof t.rtt=="number"||!n?t.rtt:n.rtt,m=this._inputVolumes.splice(0);this._supplementalSampleBuffers.audioInputLevel.push(m);const g=this._outputVolumes.splice(0);return this._supplementalSampleBuffers.audioOutputLevel.push(g),{audioInputLevel:Math.round(gi(m)),audioOutputLevel:Math.round(gi(g)),bytesReceived:u,bytesSent:l,codecName:t.codecName,jitter:t.jitter,mos:this._mos.calculate(f,t.jitter,n&&y),packetsLost:h,packetsLostFraction:y,packetsReceived:d,packetsSent:c,rtt:f,timestamp:t.timestamp,totals:{bytesReceived:t.bytesReceived,bytesSent:t.bytesSent,packetsLost:t.packetsLost,packetsLostFraction:I,packetsReceived:t.packetsReceived,packetsSent:t.packetsSent}}}_fetchSample(){this._getSample().then(t=>{this._addSample(t),this._raiseWarnings(),this.emit("sample",t)}).catch(t=>{this.disable(),this.emit("error",t)})}_getSample(){return this._getRTCStats(this._peerConnection).then(t=>{let n=null;return this._sampleBuffer.length&&(n=this._sampleBuffer[this._sampleBuffer.length-1]),this._createSample(t,n)})}_raiseWarning(t,n,i){const r=`${t}:${n}`;if(this._activeWarnings.has(r))return;this._activeWarnings.set(r,{timeRaised:Date.now()});const s=this._thresholds[t];let o;if(Array.isArray(s)){const a=s.find(l=>n in l);a&&(o=a[n])}else o=this._thresholds[t][n];this.emit("warning",Object.assign(Object.assign({},i),{name:t,threshold:{name:n,value:o}}))}_raiseWarnings(){this._warningsEnabled&&Object.keys(this._thresholds).forEach(t=>this._raiseWarningsForStat(t))}_raiseWarningsForStat(t){(Array.isArray(this._thresholds[t])?this._thresholds[t]:[this._thresholds[t]]).forEach(i=>{const r=this._sampleBuffer,s=i.clearCount||gg,o=i.raiseCount||vg,a=i.sampleCount||this._maxSampleCount;let l=r.slice(-a);const u=l.map(h=>h[t]);if(u.some(h=>typeof h>"u"||h===null))return;let d;if(typeof i.max=="number"&&(d=wg(i.max,u),d>=o?this._raiseWarning(t,"max",{values:u,samples:l}):d<=s&&this._clearWarning(t,"max",{values:u,samples:l})),typeof i.min=="number"&&(d=xg(i.min,u),d>=o?this._raiseWarning(t,"min",{values:u,samples:l}):d<=s&&this._clearWarning(t,"min",{values:u,samples:l})),typeof i.maxDuration=="number"&&r.length>1){l=r.slice(-2);const h=l[0][t],v=l[1][t],y=this._currentStreaks.get(t)||0,_=h===v?y+1:0;this._currentStreaks.set(t,_),_>=i.maxDuration?this._raiseWarning(t,"maxDuration",{value:_}):_===0&&this._clearWarning(t,"maxDuration",{value:y})}if(typeof i.minStandardDeviation=="number"){const h=this._supplementalSampleBuffers[t];if(!h||h.length<i.sampleCount)return;h.length>i.sampleCount&&h.splice(0,h.length-i.sampleCount);const v=kg(h.slice(-a)),y=Cg(v);if(typeof y!="number")return;y<i.minStandardDeviation?this._raiseWarning(t,"minStandardDeviation",{value:y}):this._clearWarning(t,"minStandardDeviation",{value:y})}[["maxAverage",(h,v)=>h>v],["minAverage",(h,v)=>h<v]].forEach(([h,v])=>{if(typeof i[h]=="number"&&u.length>=a){const y=gi(u);v(y,i[h])?this._raiseWarning(t,h,{values:u,samples:l}):v(y,i.clearValue||i[h])||this._clearWarning(t,h,{values:u,samples:l})}})})}}const mu={factor:1.1,jitter:.5,max:3e4,min:1},Tg=70,Pg=500,bg=160,Ig=10,Rg=5e3,gu={disconnect:!0,info:{code:31003,message:"Connection with Twilio was interrupted.",twilioError:new mt.ConnectionError}},vu={packetsLostFraction:{max:"packet-loss",maxAverage:"packets-lost-fraction"}},_u={audioInputLevel:"audio-input-level",audioOutputLevel:"audio-output-level",bytesReceived:"bytes-received",bytesSent:"bytes-sent",jitter:"jitter",mos:"mos",rtt:"rtt"},Ag={max:"high-",maxAverage:"high-",maxDuration:"constant-",min:"low-",minStandardDeviation:"constant-"};class T extends Ye.EventEmitter{get direction(){return this._direction}get codec(){return this._codec}get connectToken(){const t=this._signalingReconnectToken,n=this.parameters&&this.parameters.CallSid?this.parameters.CallSid:void 0;if(!t||!n)return;const i=this.customParameters&&typeof this.customParameters.keys=="function"?Array.from(this.customParameters.keys()).reduce((s,o)=>(s[o]=this.customParameters.get(o),s),{}):{},r=this.parameters||{};return btoa(encodeURIComponent(JSON.stringify({customParameters:i,parameters:r,signalingReconnectToken:t})))}constructor(t,n){super(),this.parameters={},this._inputVolumeStreak=0,this._isAnswered=!1,this._isCancelled=!1,this._isRejected=!1,this._latestInputVolume=0,this._latestOutputVolume=0,this._log=new ce("Call"),this._mediaStatus=T.State.Pending,this._messages=new Map,this._metricsSamples=[],this._options={MediaHandler:L,MediaStream:null,enableImprovedSignalingErrorPrecision:!1,offerSdp:null,shouldPlayDisconnect:()=>!0,voiceEventSidGenerator:Vo},this._outputVolumeStreak=0,this._shouldSendHangup=!0,this._signalingStatus=T.State.Pending,this._soundcache=new Map,this._status=T.State.Pending,this._wasConnected=!1,this.toString=()=>"[Twilio.Call instance]",this._emitWarning=(o,a,l,u,c,d)=>{const v=`${o}warning${c?"-cleared":"-raised"}`;if(a==="constant-audio-input-level"&&this.isMuted())return;let y=c?"info":"warning";a==="constant-audio-output-level"&&(y="info");const _={threshold:l};if(u&&(u instanceof Array?_.values=u.map(I=>typeof I=="number"?Math.round(I*100)/100:u):_.value=u),this._publisher.post(y,v,a,{data:_},this),a!=="constant-audio-output-level"){const I=c?"warning-cleared":"warning";this._log.debug(`#${I}`,a),this.emit(I,a,d&&!c?d:null)}},this._onAck=o=>{const{acktype:a,callsid:l,voiceeventsid:u}=o;if(this.parameters.CallSid!==l){this._log.warn(`Received ack from a different callsid: ${l}`);return}a==="message"&&this._onMessageSent(u)},this._onAnswer=o=>{typeof o.reconnect=="string"&&(this._signalingReconnectToken=o.reconnect),!(this._isAnswered&&this._status!==T.State.Reconnecting)&&(this._setCallSid(o),this._isAnswered=!0,this._maybeTransitionToOpen())},this._onCancel=o=>{const a=o.callsid;this.parameters.CallSid===a&&(this._isCancelled=!0,this._publisher.info("connection","cancel",null,this),this._cleanupEventListeners(),this._mediaHandler.close(),this._status=T.State.Closed,this._log.debug("#cancel"),this.emit("cancel"),this._pstream.removeListener("cancel",this._onCancel))},this._onConnected=()=>{this._log.info("Received connected from pstream"),this._signalingReconnectToken&&this._mediaHandler.version&&this._pstream.reconnect(this._mediaHandler.version.getSDP(),this.parameters.CallSid,this._signalingReconnectToken)},this._onHangup=o=>{if(this.status()!==T.State.Closed){if(o.callsid&&(this.parameters.CallSid||this.outboundConnectionId)){if(o.callsid!==this.parameters.CallSid&&o.callsid!==this.outboundConnectionId)return}else if(o.callsid)return;if(this._log.info("Received HANGUP from gateway"),o.error){const a=o.error.code,l=Mo(this._options.enableImprovedSignalingErrorPrecision,a),u=typeof l<"u"?new l(o.error.message):new xe.ConnectionError("Error sent from gateway in HANGUP",o.error);this._log.error("Received an error from the gateway:",u),this._log.debug("#error",u),this.emit("error",u)}this._shouldSendHangup=!1,this._publisher.info("connection","disconnected-by-remote",null,this),this._disconnect(null,!0),this._cleanupEventListeners()}},this._onMediaFailure=o=>{const{ConnectionDisconnected:a,ConnectionFailed:l,IceGatheringFailed:u,LowBytes:c}=T.MediaFailure,d=o===l||o===u;if(!za(window,window.navigator)&&o===l)return this._mediaHandler.onerror(gu);if(this._mediaStatus===T.State.Reconnecting){if(d){if(Date.now()-this._mediaReconnectStartTime>mu.max)return this._log.warn("Exceeded max ICE retries"),this._mediaHandler.onerror(gu);try{this._mediaReconnectBackoff.backoff()}catch(_){if(!(_.message&&_.message==="Backoff in progress."))throw _}}return}const h=this._mediaHandler.version.pc,v=h&&h.iceConnectionState==="disconnected",y=this._monitor.hasActiveWarning("bytesSent","min")||this._monitor.hasActiveWarning("bytesReceived","min");if(o===c&&v||o===a&&y||d){const _=new mt.ConnectionError("Media connection failed.");this._log.warn("ICE Connection disconnected."),this._publisher.warn("connection","error",_,this),this._publisher.info("connection","reconnecting",null,this),this._mediaReconnectStartTime=Date.now(),this._status=T.State.Reconnecting,this._mediaStatus=T.State.Reconnecting,this._mediaReconnectBackoff.reset(),this._mediaReconnectBackoff.backoff(),this._log.debug("#reconnecting"),this.emit("reconnecting",_)}},this._onMediaReconnected=()=>{this._mediaStatus===T.State.Reconnecting&&(this._log.info("ICE Connection reestablished."),this._mediaStatus=T.State.Open,this._signalingStatus===T.State.Open&&(this._publisher.info("connection","reconnected",null,this),this._log.debug("#reconnected"),this.emit("reconnected"),this._status=T.State.Open))},this._onMessageReceived=o=>{const{callsid:a,content:l,contenttype:u,messagetype:c,voiceeventsid:d}=o;if(this.parameters.CallSid!==a){this._log.warn(`Received a message from a different callsid: ${a}`);return}const h={content:l,contentType:u,messageType:c,voiceEventSid:d};this._publisher.info("call-message",c,{content_type:u,event_type:"received",voice_event_sid:d},this),this._log.debug("#messageReceived",JSON.stringify(h)),this.emit("messageReceived",h)},this._onMessageSent=o=>{if(!this._messages.has(o)){this._log.warn(`Received a messageSent with a voiceEventSid that doesn't exists: ${o}`);return}const a=this._messages.get(o);this._messages.delete(o),this._publisher.info("call-message",a==null?void 0:a.messageType,{content_type:a==null?void 0:a.contentType,event_type:"sent",voice_event_sid:o},this),this._log.debug("#messageSent",JSON.stringify(a)),this.emit("messageSent",a)},this._onRinging=o=>{if(this._setCallSid(o),this._status!==T.State.Connecting&&this._status!==T.State.Ringing)return;const a=!!o.sdp;this._status=T.State.Ringing,this._publisher.info("connection","outgoing-ringing",{hasEarlyMedia:a},this),this._log.debug("#ringing"),this.emit("ringing",a)},this._onRTCSample=o=>{const a=Object.assign(Object.assign({},o),{inputVolume:this._latestInputVolume,outputVolume:this._latestOutputVolume});this._codec=a.codecName,this._metricsSamples.push(a),this._metricsSamples.length>=Ig&&this._publishMetrics(),this.emit("sample",o)},this._onSignalingError=o=>{const{callsid:a,voiceeventsid:l,error:u}=o;if(this.parameters.CallSid!==a){this._log.warn(`Received an error from a different callsid: ${a}`);return}if(l&&this._messages.has(l)){this._messages.delete(l),this._log.warn("Received an error while sending a message.",o),this._publisher.error("call-message","error",{code:u.code,message:u.message,voice_event_sid:l},this);let c;const d=Mo(!!this._options.enableImprovedSignalingErrorPrecision,u.code);typeof d<"u"&&(c=new d(u)),c||(this._log.error("Unknown Call Message Error: ",u),c=new xe.UnknownError(u.message,u)),this._log.debug("#error",u,c),this.emit("error",c)}},this._onSignalingReconnected=()=>{this._signalingStatus===T.State.Reconnecting&&(this._log.info("Signaling Connection reestablished."),this._signalingStatus=T.State.Open,this._mediaStatus===T.State.Open&&(this._publisher.info("connection","reconnected",null,this),this._log.debug("#reconnected"),this.emit("reconnected"),this._status=T.State.Open))},this._onTransportClose=()=>{this._log.error("Received transportClose from pstream"),this._log.debug("#transportClose"),this.emit("transportClose"),this._signalingReconnectToken?(this._status=T.State.Reconnecting,this._signalingStatus=T.State.Reconnecting,this._publisher.info("connection","reconnecting",null,this),this._log.debug("#reconnecting"),this.emit("reconnecting",new Je.ConnectionDisconnected)):(this._status=T.State.Closed,this._signalingStatus=T.State.Closed)},this._reemitWarning=(o,a)=>{const l=/^audio/.test(o.name)?"audio-level-":"network-quality-",u=Ag[o.threshold.name];let c;o.name in vu?c=vu[o.name][o.threshold.name]:o.name in _u&&(c=_u[o.name]);const d=u+c;this._emitWarning(l,d,o.threshold.value,o.values||o.value,a,o)},this._reemitWarningCleared=o=>{this._reemitWarning(o,!0)},this._soundcache=t.soundcache,typeof t.onIgnore=="function"&&(this._onIgnore=t.onIgnore);const i=n&&n.twimlParams||{};this.customParameters=new Map(Object.entries(i).map(([o,a])=>[o,String(a)])),Object.assign(this._options,n),this._options.callParameters&&(this.parameters=this._options.callParameters),this._options.reconnectToken&&(this._signalingReconnectToken=this._options.reconnectToken),this._voiceEventSidGenerator=this._options.voiceEventSidGenerator||Vo,this._direction=this.parameters.CallSid&&!this._options.reconnectCallSid?T.CallDirection.Incoming:T.CallDirection.Outgoing,this.parameters?this.callerInfo=this.parameters.StirStatus?{isVerified:this.parameters.StirStatus==="TN-Validation-Passed-A"}:null:this.callerInfo=null,this._mediaReconnectBackoff=new Do(mu),this._mediaReconnectBackoff.on("ready",()=>this._mediaHandler.iceRestart()),this.outboundConnectionId=Ng();const r=this._publisher=t.publisher;this._direction===T.CallDirection.Incoming?r.info("connection","incoming",null,this):r.info("connection","outgoing",{preflight:this._options.preflight,reconnect:!!this._options.reconnectCallSid},this);const s=this._monitor=new(this._options.StatsMonitor||Eg);s.on("sample",this._onRTCSample),s.disableWarnings(),setTimeout(()=>s.enableWarnings(),Rg),s.on("warning",(o,a)=>{(o.name==="bytesSent"||o.name==="bytesReceived")&&this._onMediaFailure(T.MediaFailure.LowBytes),this._reemitWarning(o,a)}),s.on("warning-cleared",o=>{this._reemitWarningCleared(o)}),this._mediaHandler=new this._options.MediaHandler(t.audioHelper,t.pstream,{MediaStream:this._options.MediaStream,RTCPeerConnection:this._options.RTCPeerConnection,codecPreferences:this._options.codecPreferences,dscp:this._options.dscp,forceAggressiveIceNomination:this._options.forceAggressiveIceNomination,maxAverageBitrate:this._options.maxAverageBitrate}),this.on("volume",(o,a)=>{this._inputVolumeStreak=this._checkVolume(o,this._inputVolumeStreak,this._latestInputVolume,"input"),this._outputVolumeStreak=this._checkVolume(a,this._outputVolumeStreak,this._latestOutputVolume,"output"),this._latestInputVolume=o,this._latestOutputVolume=a}),this._mediaHandler.onaudio=o=>{this._log.debug("#audio"),this.emit("audio",o)},this._mediaHandler.onvolume=(o,a,l,u)=>{s.addVolumes(l/255*32767,u/255*32767),this.emit("volume",o,a)},this._mediaHandler.ondtlstransportstatechange=o=>{const a=o==="failed"?"error":"debug";this._publisher.post(a,"dtls-transport-state",o,null,this)},this._mediaHandler.onpcconnectionstatechange=o=>{let a="debug";const l=this._mediaHandler.getRTCDtlsTransport();o==="failed"&&(a=l&&l.state==="failed"?"error":"warning"),this._publisher.post(a,"pc-connection-state",o,null,this)},this._mediaHandler.onicecandidate=o=>{const a=new Us(o).toPayload();this._publisher.debug("ice-candidate","ice-candidate",a,this)},this._mediaHandler.onselectedcandidatepairchange=o=>{const a=new Us(o.local).toPayload(),l=new Us(o.remote,!0).toPayload();this._publisher.debug("ice-candidate","selected-ice-candidate-pair",{local_candidate:a,remote_candidate:l},this)},this._mediaHandler.oniceconnectionstatechange=o=>{const a=o==="failed"?"error":"debug";this._publisher.post(a,"ice-connection-state",o,null,this)},this._mediaHandler.onicegatheringfailure=o=>{this._publisher.warn("ice-gathering-state",o,null,this),this._onMediaFailure(T.MediaFailure.IceGatheringFailed)},this._mediaHandler.onicegatheringstatechange=o=>{this._publisher.debug("ice-gathering-state",o,null,this)},this._mediaHandler.onsignalingstatechange=o=>{this._publisher.debug("signaling-state",o,null,this)},this._mediaHandler.ondisconnected=o=>{this._log.warn(o),this._publisher.warn("network-quality-warning-raised","ice-connectivity-lost",{message:o},this),this._log.debug("#warning","ice-connectivity-lost"),this.emit("warning","ice-connectivity-lost"),this._onMediaFailure(T.MediaFailure.ConnectionDisconnected)},this._mediaHandler.onfailed=o=>{this._onMediaFailure(T.MediaFailure.ConnectionFailed)},this._mediaHandler.onconnected=()=>{this._status===T.State.Reconnecting&&this._onMediaReconnected()},this._mediaHandler.onreconnected=o=>{this._log.info(o),this._publisher.info("network-quality-warning-cleared","ice-connectivity-lost",{message:o},this),this._log.debug("#warning-cleared","ice-connectivity-lost"),this.emit("warning-cleared","ice-connectivity-lost"),this._onMediaReconnected()},this._mediaHandler.onerror=o=>{o.disconnect===!0&&this._disconnect(o.info&&o.info.message);const a=o.info.twilioError||new xe.UnknownError(o.info.message);this._log.error("Received an error from MediaStream:",o),this._log.debug("#error",a),this.emit("error",a)},this._mediaHandler.onopen=()=>{this._status===T.State.Open||this._status===T.State.Reconnecting||(this._status===T.State.Ringing||this._status===T.State.Connecting?(this.mute(this._mediaHandler.isMuted),this._mediaStatus=T.State.Open,this._maybeTransitionToOpen()):this._mediaHandler.close())},this._mediaHandler.onclose=()=>{this._status=T.State.Closed,this._options.shouldPlayDisconnect&&this._options.shouldPlayDisconnect()&&!this._isCancelled&&!this._isRejected&&this._soundcache.get(P.SoundName.Disconnect).play(),s.disable(),this._publishMetrics(),!this._isCancelled&&!this._isRejected&&(this._log.debug("#disconnect"),this.emit("disconnect",this))},this._pstream=t.pstream,this._pstream.on("ack",this._onAck),this._pstream.on("cancel",this._onCancel),this._pstream.on("error",this._onSignalingError),this._pstream.on("ringing",this._onRinging),this._pstream.on("transportClose",this._onTransportClose),this._pstream.on("connected",this._onConnected),this._pstream.on("message",this._onMessageReceived),this.on("error",o=>{this._publisher.error("connection","error",{code:o.code,message:o.message},this),this._pstream&&this._pstream.status==="disconnected"&&this._cleanupEventListeners()}),this.on("disconnect",()=>{this._cleanupEventListeners()})}_setInputTracksFromStream(t){return this._mediaHandler.setInputTracksFromStream(t)}_setSinkIds(t){return this._mediaHandler._setSinkIds(t)}accept(t){if(this._log.debug(".accept",t),this._status!==T.State.Pending){this._log.debug(`.accept noop. status is '${this._status}'`);return}t=t||{};const n=t.rtcConfiguration||this._options.rtcConfiguration,i=t.rtcConstraints||this._options.rtcConstraints||{},r={audio:typeof i.audio<"u"?i.audio:!0};this._status=T.State.Connecting;const s=()=>{if(this._status!==T.State.Connecting){this._cleanupEventListeners(),this._mediaHandler.close();return}const l=c=>{const d=this._direction===T.CallDirection.Incoming?"accepted-by-local":"accepted-by-remote";this._publisher.info("connection",d,null,this);const{codecName:h,codecParams:v}=zm(this._mediaHandler.version.getSDP());this._publisher.info("settings","codec",{codec_params:v,selected_codec:h},this),this._monitor.enable(c)},u=typeof this._options.getSinkIds=="function"&&this._options.getSinkIds();if(Array.isArray(u)&&this._mediaHandler._setSinkIds(u).catch(()=>{}),this._pstream.addListener("hangup",this._onHangup),this._direction===T.CallDirection.Incoming)this._isAnswered=!0,this._pstream.on("answer",this._onAnswer),this._mediaHandler.answerIncomingCall(this.parameters.CallSid,this._options.offerSdp,n,l);else{const c=Array.from(this.customParameters.entries()).map(d=>`${encodeURIComponent(d[0])}=${encodeURIComponent(d[1])}`).join("&");this._pstream.on("answer",this._onAnswer),this._mediaHandler.makeOutgoingCall(c,this._signalingReconnectToken,this._options.reconnectCallSid||this.outboundConnectionId,n,l)}};this._options.beforeAccept&&this._options.beforeAccept(this);const o=typeof this._options.getInputStream=="function"&&this._options.getInputStream();(o?this._mediaHandler.setInputTracksFromStream(o):this._mediaHandler.openDefaultDeviceWithConstraints(r)).then(()=>{this._publisher.info("get-user-media","succeeded",{data:{audioConstraints:r}},this),s()},l=>{let u;l.code===31208||["PermissionDeniedError","NotAllowedError"].indexOf(l.name)!==-1?(u=new Bn.PermissionDeniedError,this._publisher.error("get-user-media","denied",{data:{audioConstraints:r,error:l}},this)):(u=new Bn.AcquisitionFailedError,this._publisher.error("get-user-media","failed",{data:{audioConstraints:r,error:l}},this)),this._disconnect(),this._log.debug("#error",l),this.emit("error",u)})}disconnect(){this._log.debug(".disconnect"),this._disconnect()}getLocalStream(){return this._mediaHandler&&this._mediaHandler.stream}getRemoteStream(){return this._mediaHandler&&this._mediaHandler._remoteStream}ignore(){if(this._log.debug(".ignore"),this._status!==T.State.Pending){this._log.debug(`.ignore noop. status is '${this._status}'`);return}this._status=T.State.Closed,this._mediaHandler.ignore(this.parameters.CallSid),this._publisher.info("connection","ignored-by-local",null,this),this._onIgnore&&this._onIgnore()}isMuted(){return this._mediaHandler.isMuted}mute(t=!0){this._log.debug(".mute",t);const n=this._mediaHandler.isMuted;this._mediaHandler.mute(t);const i=this._mediaHandler.isMuted;n!==i&&(this._publisher.info("connection",i?"muted":"unmuted",null,this),this._log.debug("#mute",i),this.emit("mute",i,this))}postFeedback(t,n){if(typeof t>"u"||t===null)return this._postFeedbackDeclined();if(!Object.values(T.FeedbackScore).includes(t))throw new W(`Feedback score must be one of: ${Object.values(T.FeedbackScore)}`);if(typeof n<"u"&&n!==null&&!Object.values(T.FeedbackIssue).includes(n))throw new W(`Feedback issue must be one of: ${Object.values(T.FeedbackIssue)}`);return this._publisher.info("feedback","received",{issue_name:n,quality_score:t},this,!0)}reject(){if(this._log.debug(".reject"),this._status!==T.State.Pending){this._log.debug(`.reject noop. status is '${this._status}'`);return}this._isRejected=!0,this._pstream.reject(this.parameters.CallSid),this._mediaHandler.reject(this.parameters.CallSid),this._publisher.info("connection","rejected-by-local",null,this),this._cleanupEventListeners(),this._mediaHandler.close(),this._status=T.State.Closed,this._log.debug("#reject"),this.emit("reject")}sendDigits(t){if(this._log.debug(".sendDigits",t),t.match(/[^0-9*#w]/))throw new W("Illegal character passed into sendDigits");const n=this._options.customSounds||{},i=[];t.split("").forEach(a=>{let l=a!=="w"?`dtmf${a}`:"";l==="dtmf*"&&(l="dtmfs"),l==="dtmf#"&&(l="dtmfh"),i.push(l)});const r=()=>{const a=i.shift();a&&(this._options.dialtonePlayer&&!n[a]?this._options.dialtonePlayer.play(a):this._soundcache.get(a).play()),i.length&&setTimeout(()=>r(),200)};r();const s=this._mediaHandler.getOrCreateDTMFSender();function o(a){if(!a.length)return;const l=a.shift();l&&l.length&&s.insertDTMF(l,bg,Tg),setTimeout(o.bind(null,a),Pg)}if(s){if(!("canInsertDTMF"in s)||s.canInsertDTMF){this._log.info("Sending digits using RTCDTMFSender"),o(t.split("w"));return}this._log.info("RTCDTMFSender cannot insert DTMF")}if(this._log.info("Sending digits over PStream"),this._pstream!==null&&this._pstream.status!=="disconnected")this._pstream.dtmf(this.parameters.CallSid,t);else{const a=new xe.ConnectionError("Could not send DTMF: Signaling channel is disconnected");this._log.debug("#error",a),this.emit("error",a)}}sendMessage(t){this._log.debug(".sendMessage",JSON.stringify(t));const{content:n,contentType:i,messageType:r}=t;if(typeof n>"u"||n===null)throw new W("`content` is empty");if(typeof r!="string")throw new W("`messageType` must be a string.");if(r.length===0)throw new W("`messageType` must be a non-empty string.");if(this._pstream===null)throw new tt("Could not send CallMessage; Signaling channel is disconnected");const s=this.parameters.CallSid;if(typeof this.parameters.CallSid>"u")throw new tt("Could not send CallMessage; Call has no CallSid");const o=this._voiceEventSidGenerator();return this._messages.set(o,{content:n,contentType:i,messageType:r,voiceEventSid:o}),this._pstream.sendMessage(s,n,i,r,o),o}status(){return this._status}_checkVolume(t,n,i,r){const s=n>=10;let o=0;return i===t&&(o=n),o>=10?this._emitWarning("audio-level-",`constant-audio-${r}-level`,10,o,!1):s&&this._emitWarning("audio-level-",`constant-audio-${r}-level`,10,o,!0),o}_cleanupEventListeners(){const t=()=>{this._pstream&&(this._pstream.removeListener("ack",this._onAck),this._pstream.removeListener("answer",this._onAnswer),this._pstream.removeListener("cancel",this._onCancel),this._pstream.removeListener("error",this._onSignalingError),this._pstream.removeListener("hangup",this._onHangup),this._pstream.removeListener("ringing",this._onRinging),this._pstream.removeListener("transportClose",this._onTransportClose),this._pstream.removeListener("connected",this._onConnected),this._pstream.removeListener("message",this._onMessageReceived))};t(),setTimeout(t,0)}_createMetricPayload(){const t={call_sid:this.parameters.CallSid,dscp:!!this._options.dscp,sdk_version:On};return this._options.gateway&&(t.gateway=this._options.gateway),t.direction=this._direction,t}_disconnect(t,n){if(t=typeof t=="string"?t:null,!(this._status!==T.State.Open&&this._status!==T.State.Connecting&&this._status!==T.State.Reconnecting&&this._status!==T.State.Ringing)){if(this._log.info("Disconnecting..."),this._pstream!==null&&this._pstream.status!=="disconnected"&&this._shouldSendHangup){const i=this.parameters.CallSid||this.outboundConnectionId;i&&this._pstream.hangup(i,t)}this._cleanupEventListeners(),this._mediaHandler.close(),n||this._publisher.info("connection","disconnected-by-local",null,this)}}_maybeTransitionToOpen(){this._wasConnected,this._isAnswered&&(this._onSignalingReconnected(),this._signalingStatus=T.State.Open,this._mediaHandler&&this._mediaHandler.status==="open"&&(this._status=T.State.Open,this._wasConnected||(this._wasConnected=!0,this._log.debug("#accept"),this.emit("accept",this))))}_postFeedbackDeclined(){return this._publisher.info("feedback","received-none",null,this,!0)}_publishMetrics(){this._metricsSamples.length!==0&&this._publisher.postMetrics("quality-metrics-samples","metrics-sample",this._metricsSamples.splice(0),this._createMetricPayload(),this).catch(t=>{this._log.warn("Unable to post metrics to Insights. Received error:",t)})}_setCallSid(t){const n=t.callsid;n&&(this.parameters.CallSid=n,this._mediaHandler.callSid=n)}}T.toString=()=>"[Twilio.Call class]";(function(e){(function(t){t.Closed="closed",t.Connecting="connecting",t.Open="open",t.Pending="pending",t.Reconnecting="reconnecting",t.Ringing="ringing"})(e.State||(e.State={})),function(t){t.AudioLatency="audio-latency",t.ChoppyAudio="choppy-audio",t.DroppedCall="dropped-call",t.Echo="echo",t.NoisyCall="noisy-call",t.OneWayAudio="one-way-audio"}(e.FeedbackIssue||(e.FeedbackIssue={})),function(t){t[t.One=1]="One",t[t.Two=2]="Two",t[t.Three=3]="Three",t[t.Four=4]="Four",t[t.Five=5]="Five"}(e.FeedbackScore||(e.FeedbackScore={})),function(t){t.Incoming="INCOMING",t.Outgoing="OUTGOING"}(e.CallDirection||(e.CallDirection={})),function(t){t.Opus="opus",t.PCMU="pcmu"}(e.Codec||(e.Codec={})),function(t){t.None="none",t.Timeout="timeout"}(e.IceGatheringFailureReason||(e.IceGatheringFailureReason={})),function(t){t.ConnectionDisconnected="ConnectionDisconnected",t.ConnectionFailed="ConnectionFailed",t.IceGatheringFailed="IceGatheringFailed",t.LowBytes="LowBytes"}(e.MediaFailure||(e.MediaFailure={}))})(T||(T={}));function Ng(){return"TJSxxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}const Dg=({phoneNumber:e,micState:t,onEnd:n})=>{const[i,r]=j.useState("Initiating VOIP...");return j.useEffect(()=>{e&&(r(t==="granted"?"Initiating VOIP...":"Awaiting Mic Access..."),t==="granted"&&(setTimeout(()=>r("Connecting Direct..."),1e3),setTimeout(()=>r("LIVE: Secure AI Recording On"),3e3)))},[e,t]),e?p.jsxs("div",{className:"fixed bottom-6 right-6 w-80 bg-slate-900 text-white rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] p-6 border border-white/10 animate-slide-up z-50 backdrop-blur-md",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:`w-2 h-2 rounded-full ${i.includes("LIVE")?"bg-red-500 animate-pulse":"bg-blue-400 animate-pulse"}`}),p.jsx("span",{className:"text-[10px] font-bold tracking-widest text-slate-400 uppercase",children:i})]}),p.jsx("button",{onClick:n,className:"text-slate-500 hover:text-white transition-colors",children:""})]}),p.jsxs("div",{className:"text-center py-4",children:[p.jsxs("div",{className:"relative inline-block mb-4",children:[p.jsx("div",{className:"absolute inset-0 bg-blue-500/20 rounded-full blur-xl animate-pulse"}),p.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-lg",children:p.jsx("span",{className:"text-3xl",children:""})})]}),p.jsxs("h4",{className:"text-xl font-bold text-white mb-1",children:["+",e]}),p.jsx("p",{className:"text-xs text-blue-400 font-semibold mb-6",children:"Direct Browser Call (No SIM Required)"})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[p.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 text-center",children:[p.jsx("span",{className:"block text-xl mb-1",children:t==="granted"?"":""}),p.jsx("span",{className:"text-[10px] text-slate-500 uppercase",children:"Microphone"})]}),p.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 text-center",children:[p.jsx("span",{className:"block text-xl mb-1",children:""}),p.jsx("span",{className:"text-[10px] text-slate-500 uppercase",children:"Headset"})]})]}),p.jsx("button",{onClick:n,className:"w-full bg-red-500 hover:bg-red-600 text-white py-3 rounded-2xl font-bold shadow-lg shadow-red-500/20 transition-all transform active:scale-95",children:"End Direct Call"}),p.jsx("p",{className:"text-[9px] text-slate-500 text-center mt-4",children:"Powered by RecoverAI WebRTC Gateway"})]}):null};function Lg(){const[e,t]=j.useState([]),[n,i]=j.useState(null),[r,s]=j.useState("prompt"),[o,a]=j.useState(!1),[l,u]=j.useState(null),[c,d]=j.useState(!1),[h,v]=j.useState(!1),[y,_]=j.useState({callerId:localStorage.getItem("agentCallerId")||""}),[I,f]=j.useState({show:!1,link:"",caseId:"",company:""});j.useEffect(()=>{const w=localStorage.getItem("token");w&&(u(w),m(w))},[]),j.useEffect(()=>{if(!l)return;const w=setInterval(()=>{m(l)},1e4);return()=>clearInterval(w)},[l]);const m=async w=>{try{a(!0);const N=await fetch(rt.CASES,{headers:{Authorization:`Bearer ${w}`}});if(N.status===401){g();return}const b=await N.json();t(b)}catch(N){console.error("Failed to load cases:",N)}finally{a(!1)}},g=()=>{localStorage.removeItem("token"),u(null)},S=async()=>{a(!0);const w=rt.ANALYZE;try{await m(l);const N=e.filter(b=>!b.pScore).map(b=>{const D={case_id:b.case_id.replace("C-",""),company_name:b.companyName,amount:b.amount,initial_score:b.initial_score,age_days:b.age_days,history_logs:(b.history||[]).map($=>$.id||$)};return fetch(w,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(D)})});await Promise.all(N),await m(l)}catch(N){console.error("Batch Analysis Error:",N)}finally{a(!1)}},C=async w=>{const N=w.target.files[0];if(!N)return;a(!0);const b=new FormData;b.append("file",N);const D=rt.INGEST;try{const $=await fetch(D,{method:"POST",headers:{Authorization:`Bearer ${l}`},body:b});if(!$.ok)throw new Error("Upload Failed");const he=await $.json();alert(`Ingestion Complete! Inserted: ${he.inserted}, Errors: ${he.errors.length}`)}catch($){console.error($),alert("Upload failed: "+$.message)}finally{a(!1)}},k=async w=>{const N=rt.PAYMENT;try{const b=await fetch(N,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({case_id:w.case_id,amount:w.amount})});if(!b.ok)throw new Error("Payment Link Creation Failed");const D=await b.json();D.payment_url?f({show:!0,link:D.payment_url,caseId:w.case_id,company:w.companyName}):alert("Error: "+JSON.stringify(D))}catch(b){console.error(b),alert("Payment Error: "+b.message)}},E=async w=>{const N=e.find(D=>D.phone===w),b=N?N.case_id:"UNKNOWN";i(w);try{const D=await fetch(`${rt.BASE_URL}/api/v1/telephony/token`,{headers:{Authorization:`Bearer ${l}`}});if(!D.ok)throw new Error("Could not fetch VOIP token");const{token:$}=await D.json(),he=new P($,{codecPreferences:["opus","pcmu"],logLevel:0});try{await navigator.mediaDevices.getUserMedia({audio:!0}),s("granted")}catch{s("denied"),alert("Microphone access is required for Browser Dialing."),i(null);return}await he.register();const ut=await he.connect({params:{To:w,case_id:b,caller_id:y.callerId}});ut.on("disconnect",()=>{console.log("Call disconnected"),i(null),setTimeout(()=>m(l),5e3),alert("Call Ended. AI Analysis in progress...")}),ut.on("error",gt=>{console.error("Twilio Call Error:",gt),i(null),alert("Call failed: "+gt.message)})}catch(D){console.error("Twilio Device/Call Error:",D),alert("Failed to connect call. Ensure backend is running and Twilio credentials are valid."),i(null)}};return l?p.jsxs("div",{className:"min-h-screen bg-gray-50 p-8",children:[p.jsx(jp,{}),p.jsxs("header",{className:"mb-8 flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:["RecoverAI ",p.jsx("span",{className:"text-blue-600",children:"SuRaksha Portal"})]}),p.jsx("p",{className:"text-gray-500",children:"Agentic Debt Recovery System"})]}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("button",{onClick:()=>v(!0),className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Agent Settings",children:""}),p.jsx("button",{onClick:g,className:"text-sm text-red-500 hover:text-red-700 border border-red-200 px-3 py-1 rounded",children:"Logout"})]})]}),p.jsxs("div",{className:"mb-6 flex gap-4",children:[p.jsx("button",{onClick:S,disabled:o,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg shadow hover:bg-indigo-700 transition",children:o?"Processing ODE Models...":"Run Daily Allocation Batch"}),p.jsxs("label",{className:"bg-emerald-600 text-white px-6 py-2 rounded-lg shadow hover:bg-emerald-700 transition cursor-pointer",children:[o?"Uploading...":"Upload FedEx CSV",p.jsx("input",{type:"file",onChange:C,accept:".csv",className:"hidden",disabled:o})]}),p.jsx("button",{onClick:()=>d(!0),className:"bg-purple-600 text-white px-6 py-2 rounded-lg shadow hover:bg-purple-700 transition",children:"+ Add Case Manually"})]}),c&&p.jsx(Mp,{onClose:()=>d(!1),onSuccess:()=>{m(l),alert("Case added successfully!")}}),p.jsxs("div",{className:"grid gap-6",children:[e.length===0&&!o&&p.jsx("div",{className:"text-center py-20 bg-white rounded border border-dashed border-gray-300",children:p.jsx("p",{className:"text-gray-400",children:'No cases allocated. Click "Run Batch" to ingest from ERP.'})}),e.map(w=>p.jsx(Dp,{caseData:w,onPay:k,onLogCall:()=>m(l),onCall:E},w.case_id))]}),I&&I.show&&p.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm",children:p.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl w-[32rem] border border-gray-100",children:[p.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Payment Link Generated"}),p.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Share this secure link with ",p.jsx("span",{className:"font-semibold text-gray-700",children:I.company}),". When they pay, this case will automatically mark as PAID."]}),p.jsxs("div",{className:"flex gap-2 mb-6",children:[p.jsx("input",{type:"text",readOnly:!0,value:I.link,className:"w-full bg-gray-50 border border-gray-200 text-gray-600 text-sm rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none"}),p.jsx("button",{onClick:()=>{navigator.clipboard.writeText(I.link),alert("Link copied to clipboard!")},className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded font-medium text-sm transition",children:"Copy"})]}),p.jsx("div",{className:"flex justify-end",children:p.jsx("button",{onClick:()=>f({...I,show:!1}),className:"text-gray-500 hover:text-gray-700 text-sm font-medium px-4 py-2",children:"Close"})})]})}),h&&p.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm",children:p.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl w-96 border border-gray-100",children:[p.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Agent Settings"}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Real Number (Caller ID)"}),p.jsx("input",{type:"tel",className:"w-full border border-gray-300 rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"+91 98765 43210",value:y.callerId,onChange:w=>{const N=w.target.value;_({...y,callerId:N}),localStorage.setItem("agentCallerId",N)}}),p.jsx("p",{className:"text-[10px] text-gray-400 mt-2",children:"This number will be displayed to debtors when you use the Recovery Bridge."})]}),p.jsx("div",{className:"flex justify-end",children:p.jsx("button",{onClick:()=>v(!1),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700 transition",children:"Save & Close"})})]})}),p.jsx(Dg,{phoneNumber:n,micState:r,onEnd:()=>i(null)})]}):p.jsx(Lp,{onLogin:w=>{localStorage.setItem("token",w),u(w),m(w)}})}Fs.createRoot(document.getElementById("root")).render(p.jsx(Ru.StrictMode,{children:p.jsx(Lg,{})}));
